!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("reflect-metadata")):"function"==typeof define&&define.amd?define(["reflect-metadata"],t):(e.core=e.core||{},e.core.umd=e.core.umd||{},e.core.umd.js=t(e.Reflect))}(this,function(e){"use strict";function n(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}e=e&&e.hasOwnProperty("default")?e.default:e;var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};var a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function i(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function l(e){return this instanceof l?(this.v=e,this):new l(e)}var f=Object.freeze({__extends:function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__assign:a,__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r},__decorate:function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(i=(a<3?o(i):3<a?o(t,r,i):o(t,r))||i);return 3<a&&i&&Object.defineProperty(t,r,i),i},__param:function(r,n){return function(e,t){n(e,t,r)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(a,i,s,c){return new(s||(s=Promise))(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(a,i||[])).next())})},__generator:function(r,n){var o,a,i,e,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[0,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){s.label=t[1];break}if(6===t[0]&&s.label<i[1]){s.label=i[1],i=t;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(t);break}i[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__exportStar:function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values:i,__read:s,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e},__await:l,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,a=r.apply(e,t||[]),i=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(n){a[n]&&(o[n]=function(r){return new Promise(function(e,t){1<i.push([n,r,e,t])||s(n,r)})})}function s(e,t){try{(r=a[e](t)).value instanceof l?Promise.resolve(r.value.v).then(c,u):p(i[0][2],r)}catch(e){p(i[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function p(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}},__asyncDelegator:function(n){var e,o;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){n[t]&&(e[t]=function(e){return(o=!o)?{value:l(n[t](e)),done:"return"===t}:r?r(e):e})}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):i(e)},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),c=Object.prototype.toString,d=function(e){var t=c.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===c.call(e.callee)),r},h=Object.prototype.hasOwnProperty,y=Object.prototype.toString,u=Array.prototype.slice,p=Object.prototype.propertyIsEnumerable,g=!p.call({toString:null},"toString"),v=p.call(function(){},"prototype"),m=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=function(e){var t=e.constructor;return t&&t.prototype===e},b={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},M=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!b["$"+e]&&h.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{_(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),P=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===y.call(e),n=d(e),o=t&&"[object String]"===y.call(e),a=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var i=v&&r;if(o&&0<e.length&&!h.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(n&&0<e.length)for(var c=0;c<e.length;++c)a.push(String(c));else for(var u in e)i&&"prototype"===u||!h.call(e,u)||a.push(String(u));if(g)for(var p=function(e){if("undefined"==typeof window||!M)return _(e);try{return _(e)}catch(e){return!1}}(e),l=0;l<m.length;++l)p&&"constructor"===m[l]||!h.call(e,m[l])||a.push(m[l]);return a};P.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var t=Object.keys;Object.keys=function(e){return d(e)?t(u.call(e)):t(e)}}}else Object.keys=P;return Object.keys||P};var A=P,C=Object.prototype.hasOwnProperty,T=Object.prototype.toString,O="function"==typeof Symbol&&"symbol"==typeof Symbol(),k=Object.prototype.toString,w=Object.defineProperty&&function(){var e={};try{for(var t in Object.defineProperty(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),S=function(e,t,r,n){var o;t in e&&("function"!=typeof(o=n)||"[object Function]"!==k.call(o)||!n())||(w?Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},x=function(t,r){var n=2<arguments.length?arguments[2]:{},e=A(r);O&&(e=e.concat(Object.getOwnPropertySymbols(r))),function(e,t,r){if("[object Function]"!==T.call(t))throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var o=0;o<n;o++)t.call(r,e[o],o,e);else for(var a in e)C.call(e,a)&&t.call(r,e[a],a,e)}(e,function(e){S(t,e,r[e],n[e])})};x.supportsDescriptors=!!w;var j=x,D=Object.prototype.toString,I=function(e){var t=D.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===D.call(e.callee)),r},E=Object.prototype.hasOwnProperty,R=Object.prototype.toString,F=Array.prototype.slice,N=Object.prototype.propertyIsEnumerable,B=!N.call({toString:null},"toString"),L=N.call(function(){},"prototype"),K=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$=function(e){var t=e.constructor;return t&&t.prototype===e},U={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},q=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!U["$"+e]&&E.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{$(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),V=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===R.call(e),n=I(e),o=t&&"[object String]"===R.call(e),a=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var i=L&&r;if(o&&0<e.length&&!E.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(n&&0<e.length)for(var c=0;c<e.length;++c)a.push(String(c));else for(var u in e)i&&"prototype"===u||!E.call(e,u)||a.push(String(u));if(B)for(var p=function(e){if("undefined"==typeof window||!q)return $(e);try{return $(e)}catch(e){return!1}}(e),l=0;l<K.length;++l)p&&"constructor"===K[l]||!E.call(e,K[l])||a.push(K[l]);return a};V.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var t=Object.keys;Object.keys=function(e){return I(e)?t(F.call(e)):t(e)}}}else Object.keys=V;return Object.keys||V};var z=V,W=Array.prototype.slice,G=Object.prototype.toString,H=Function.prototype.bind||function(t){var r=this;if("function"!=typeof r||"[object Function]"!==G.call(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var n,o=W.call(arguments,1),e=Math.max(0,r.length-o.length),a=[],i=0;i<e;i++)a.push("$"+i);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof n){var e=r.apply(this,o.concat(W.call(arguments)));return Object(e)===e?e:this}return r.apply(t,o.concat(W.call(arguments)))}),r.prototype){var s=function(){};s.prototype=r.prototype,n.prototype=new s,s.prototype=null}return n},X=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}(),Y=Object,Z=H.call(Function.call,Array.prototype.push),J=H.call(Function.call,Object.prototype.propertyIsEnumerable),Q=X?Object.getOwnPropertySymbols:null,ee=function(e,t){if(null==e)throw new TypeError("target must be an object");var r,n,o,a,i,s,c,u=Y(e);for(r=1;r<arguments.length;++r){n=Y(arguments[r]),a=z(n);var p=X&&(Object.getOwnPropertySymbols||Q);if(p)for(i=p(n),o=0;o<i.length;++o)c=i[o],J(n,c)&&Z(a,c);for(o=0;o<a.length;++o)s=n[c=a[o]],J(n,c)&&(u[c]=s)}return u},te=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},n=0;n<t.length;++n)r[t[n]]=t[n];var o=Object.assign({},r),a="";for(var i in o)a+=i;return e!==a}()?ee:function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(e){return"y"===t[1]}return!1}()?ee:Object.assign:ee},re=te();j(re,{getPolyfill:te,implementation:ee,shim:function(){var e=te();return j(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}});var ne=re,oe=r(function(e,t){function o(r,n){ae.isArray(r)?r.forEach(n):ae.isObject(r)&&Object.keys(r).forEach(function(e,t){n(r[e],e)})}Object.defineProperty(t,"__esModule",{value:!0}),ne.shim(),t.keys=function(e){return ae.isObject(e)?Object.keys(e):[]},t.assign=function(e,t,r,n){return n&&n.length?(n.unshift(r||{}),n.unshift(t||{}),Object.assign.apply(Object,[e].concat(n))):r?Object.assign(e,t||{},r):Object.assign(e,t||{})},t.omit=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];if(ae.isObject(t)){var n={};return Object.keys(t).forEach(function(e){r.indexOf(e)<0&&(n[e]=t[e])}),n}return t},t.hasField=function(e){return!!ae.isObject(e)&&0<Object.keys(e).length},t.forIn=o,t.find=function(e,r){var n;o(e,function(e,t){return!(n||r(e,t)&&(n=e,1))})},t.first=function(e){return ae.isArray(e)&&e.length?e[0]:null},t.last=function(e){return ae.isArray(e)&&e.length?e[e.length-1]:null}});t(oe);oe.keys,oe.assign,oe.omit,oe.hasField,oe.forIn,oe.find,oe.first,oe.last;var ae=r(function(e,t){function r(e){return!!e&&"function"==typeof e}function n(e){if(!r(e))return!1;if(e.prototype){if(!e.name||"Object"===e.name)return!1;if(Reflect.hasOwnMetadata("@Abstract",e))return!1;var t=e;if(/^[a-z]$/.test(t.name))return!(!t.classAnnations||!t.classAnnations.name);if(t.classAnnations&&i(t.classAnnations.name))return!0;if(!/^[A-Z@]/.test(e.name))return!1;if(!o()&&/MSIE [6-9]/.test(navigator.userAgent))return!0;try{return e.arguments&&e.caller,!1}catch(e){return!0}}return!1}function o(){return"undefined"!=typeof process&&void 0!==process.versions.node}function a(e,t,r){return!!e&&(!(d(e)||f(e)||e instanceof ue.Registration||e instanceof RegExp||e instanceof Date)&&((!e.constructor||"Object"===e.constructor.name)&&(t=t||[],r&&(t=r.concat(t)),!t.length||oe.keys(e).some(function(e){return 0<t.indexOf(e)}))))}function i(e){return"string"==typeof e}function s(e){return"boolean"==typeof e||!0===e||!1===e}function c(e){return"number"==typeof e}function u(e){return void 0===e||void 0===e}function p(e){return null===e}function l(e){var t=typeof e;return null!=e&&("object"===t||"function"===t)}function f(e){return"symbol"==typeof e||l(e)&&/^Symbol\(/.test(e.toString())}function d(e){return p(e)||u(e)||s(e)||i(e)||c(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=r,t.isAbstractDecoratorClass=function(e){return!!r(e)&&!!Reflect.hasOwnMetadata("@Abstract",e)},t.getClassName=function(e){return r(e)?/^[a-z]$/.test(e.name)&&e.classAnnations?e.classAnnations.name:e.name:""},t.isClass=n,t.isNodejsEnv=o,t.isToken=function(e){return!!e&&!!(i(e)||f(e)||n(e)||l(e)&&e instanceof ue.Registration)},t.isPromise=function(e){return!!e&&!(!r(e.then)||!r(e.catch))},t.isObservable=function(e){return!(!e&&!l(e)||!r(e.subscribe)||!r(e.toPromise))},t.isBaseObject=function(e){return!!e&&!(!e.constructor||"Object"!==e.constructor.name)},t.isMetadataObject=a,t.isClassMetadata=function(e,t){return a(e,["singleton","provide","alias","type"],t)},t.isParamMetadata=function(e,t){return a(e,["type","provider","index"],t)},t.isParamPropMetadata=function(e,t){return a(e,["type","provider","index"],t)},t.isPropertyMetadata=function(e,t){return a(e,["type","provider"],t)},t.isString=i,t.isBoolean=s,t.isNumber=c,t.isUndefined=u,t.isNull=p,t.isArray=function(e){return Array.isArray(e)},t.isObject=l,t.isDate=function(e){return l(e)&&e instanceof Date},t.isSymbol=f,t.isRegExp=function(e){return e&&e instanceof RegExp},t.isBaseType=d});t(ae);ae.isFunction,ae.isAbstractDecoratorClass,ae.getClassName,ae.isClass,ae.isNodejsEnv,ae.isToken,ae.isPromise,ae.isObservable,ae.isBaseObject,ae.isMetadataObject,ae.isClassMetadata,ae.isParamMetadata,ae.isParamPropMetadata,ae.isPropertyMetadata,ae.isString,ae.isBoolean,ae.isNumber,ae.isUndefined,ae.isNull,ae.isArray,ae.isObject,ae.isDate,ae.isSymbol,ae.isRegExp,ae.isBaseType;var ie=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.valueMap={},this.keyMap={}}return e.prototype.clear=function(){this.valueMap={},this.keyMap={}},e.prototype.getTypeKey=function(e){return ae.isString(e)?e:ae.isFunction(e)?e.name:e.toString()},e.prototype.delete=function(e){var t=this.getTypeKey(e).toString();try{return delete this.keyMap[t],delete this.valueMap[t],!0}catch(e){return!1}},e.prototype.forEach=function(r,e){var n=this;oe.forIn(this.keyMap,function(e,t){r(n.valueMap[t],e,n)})},e.prototype.get=function(e){var t=this.getTypeKey(e);return this.valueMap[t]},e.prototype.has=function(e){var t=this.getTypeKey(e);return!ae.isUndefined(this.keyMap[t])},e.prototype.set=function(e,t){var r=this.getTypeKey(e);return this.keyMap[r]=e,this.valueMap[r]=t,this},Object.defineProperty(e.prototype,"size",{get:function(){return oe.keys(this.keyMap).length},enumerable:!0,configurable:!0}),e.classAnnations={name:"ObjectMapSet",params:{constructor:[],clear:[],getTypeKey:["key"],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},e}();t.ObjectMapSet=r;var n=function(){function e(){this.map=ae.isClass(Map)?new Map:new r}return e.prototype.clear=function(){this.map.clear()},e.prototype.delete=function(e){return this.map.delete(e)},e.prototype.forEach=function(e,t){this.map.forEach(e,t)},e.prototype.get=function(e){return this.map.get(e)},e.prototype.has=function(e){return this.map.has(e)},e.prototype.set=function(e,t){return this.map.set(e,t),this},Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),e.classAnnations={name:"MapSet",params:{constructor:[],clear:[],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},e}();t.MapSet=n});t(ie);ie.ObjectMapSet,ie.MapSet;var se=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(){var r=this;this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t})}return r.create=function(e){var t=new r;return e&&(t.promise=t.promise.then(e)),t},r.classAnnations={name:"Defer",params:{create:["then"],constructor:[]}},r}();t.Defer=r});t(se);se.Defer;var ce=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(ae,t),f.__exportStar(ie,t),t.lang=oe,f.__exportStar(se,t)});t(ce);ce.lang;var ue=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(e,t){if(this.type="Registration",e instanceof n){this.classType=e.classType;var r=e.getDesc();this.desc=r&&t&&r!==t?r+"_"+t:t}else this.classType=e,this.desc=t}return n.prototype.getClass=function(){return ce.isClass(this.classType)?this.classType:null},n.prototype.getDesc=function(){return this.desc},n.prototype.toString=function(){var e="";return ce.isFunction(this.classType)?e=ce.getClassName(this.classType):this.classType&&(e=this.classType.toString()),this.type+" "+e+" "+this.desc},n.classAnnations={name:"Registration",params:{constructor:["provideType","desc"],getClass:[],getDesc:[],toString:[]}},n}();t.Registration=r});t(ue);ue.Registration;var pe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(e){return t.call(this,e,"")||this}return f.__extends(e,t),e.classAnnations={name:"InjectToken",params:{constructor:["desc"]}},e}(ue.Registration);t.InjectToken=r});t(pe);pe.InjectToken;var le=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerToken=new pe.InjectToken("__IOC_IContainer")});t(le);le.ContainerToken;var fe=r(function(e,t){var r,n;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.IocState||(t.IocState={})).design="design",r.runtime="runtime",(n=t.Mode||(t.Mode={}))[n.route=1]="route",n[n.children=2]="children",n[n.traverse=3]="traverse",n[n.traverseLast=4]="traverseLast"});t(fe);fe.IocState,fe.Mode;var de=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MethodAccessorToken=new pe.InjectToken("__IOC_IMethodAccessor")});t(de);de.MethodAccessorToken;var he=r(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(){}return e.prototype.isEmpty=function(){return!0},e.prototype.add=function(e){return this},e.prototype.remove=function(e){return this},e.prototype.find=function(e,t){return r.NullNode},e.prototype.filter=function(e,t){return[]},e.prototype.each=function(e,t){},e.prototype.trans=function(e){},e.prototype.transAfter=function(e){},e.prototype.routeUp=function(e){},e.prototype.equals=function(e){return e===r.NullNode},e.prototype.empty=function(){return r.NullNode},e.classAnnations={name:"NullComponent",params:{isEmpty:[],add:["action"],remove:["action"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],trans:["express"],transAfter:["express"],routeUp:["express"],equals:["node"],empty:[]}},e}();r.NullComponent=t,r.NullNode=new t});t(he);he.NullComponent,he.NullNode;var ye=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.name=e,this.children=[]}return e.prototype.add=function(e){return(e.parent=this).children.push(e),this},e.prototype.remove=function(t){var e;return(e=ce.isString(t)?this.find(function(e){return ce.isString(t)?e.name===t:e.equals(t)}):t||this).parent&&(this.equals(e.parent)?(this.children.splice(this.children.indexOf(e),1),e.parent=null):e.parent.remove(e)),this},e.prototype.find=function(t,e){var r;return this.each(function(e){return!r&&(!(ce.isFunction(t)?t(e):t===e)||(r=e,!1))},e),r||this.empty()},e.prototype.filter=function(t,e){var r=[];return this.each(function(e){t(e)&&r.push(e)},e),r},e.prototype.each=function(e,t){var r;switch(t=t||fe.Mode.traverse){case fe.Mode.route:r=this.routeUp(e);break;case fe.Mode.children:r=this.eachChildren(e);break;case fe.Mode.traverse:r=this.trans(e);break;case fe.Mode.traverseLast:r=this.transAfter(e);break;default:r=this.trans(e)}return r},e.prototype.eachChildren=function(t){(this.children||[]).forEach(function(e){return t(e)})},e.prototype.routeUp=function(e){return!1!==e(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(e):void 0)},e.prototype.trans=function(e){if(!1===e(this))return!1;for(var t=this.children||[],r=0;r<t.length;r++){var n=t[r].trans(e);if(!1===n)return n}return!0},e.prototype.transAfter=function(e){for(var t=this.children||[],r=0;r<t.length;r++){if(!1===t[r].transAfter(e))return!1}return!1!==e(this)},e.prototype.equals=function(e){return this===e},e.prototype.empty=function(){return he.NullNode},e.prototype.isEmpty=function(){return this.equals(this.empty())},e.classAnnations={name:"Composite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],eachChildren:["express"],routeUp:["express"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},e}();t.Composite=r});t(ye);ye.Composite;var ge=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.name=e,this.children=[]}return e.prototype.add=function(e){return(e.parent=this).children.push(e),this},e.prototype.remove=function(t){var e;return(e=ce.isString(t)?this.find(function(e){return ce.isString(t)?e.name===t:e.equals(t)}):t||this).parent?this.equals(e.parent)?(this.children.splice(this.children.indexOf(e),1),e.parent=null,this):(e.parent.remove(e),null):this},e.prototype.find=function(t,e){var r;return this.each(function(e){return!r&&(!(ce.isFunction(t)?t(e):t===e)||(r=e,!1))},e),r||this.empty()},e.prototype.filter=function(t,e){var r=[];return this.each(function(e){t(e)&&r.push(e)},e),r},e.prototype.each=function(e,t){var r;switch(t=t||fe.Mode.traverse){case fe.Mode.route:r=this.routeUp(e);break;case fe.Mode.children:r=this.eachChildren(e);break;case fe.Mode.traverse:r=this.trans(e);break;case fe.Mode.traverseLast:r=this.transAfter(e);break;default:r=this.trans(e)}return r},e.prototype.eachChildren=function(t){(this.children||[]).forEach(function(e){return t(e)})},e.prototype.routeUp=function(e){return!1!==e(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(e):void 0)},e.prototype.trans=function(e){if(!1===e(this))return!1;for(var t=this.children||[],r=0;r<t.length;r++){var n=t[r].trans(e);if(!1===n)return n}return!0},e.prototype.transAfter=function(e){for(var t=this.children||[],r=0;r<t.length;r++){if(!1===t[r].transAfter(e))return!1}return!1!==e(this)},e.prototype.equals=function(e){return this===e},e.prototype.empty=function(){return he.NullNode},e.prototype.isEmpty=function(){return this.equals(this.empty())},e.classAnnations={name:"GComposite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["iterate","mode"],eachChildren:["iterate"],routeUp:["iterate"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},e}();t.GComposite=r});t(ge);ge.GComposite;var ve=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(ye,t),f.__exportStar(ge,t),f.__exportStar(he,t)});t(ve);var me=r(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return f.__extends(t,e),t.prototype.insert=function(e,t){return this},t.prototype.execute=function(e,t,r){},t.prototype.empty=function(){return r.NullAction},t.classAnnations={name:"NullActionClass",params:{insert:["action","index"],execute:["container","data","name"],empty:[]}},t}(ve.NullComponent);r.NullAction=new t});t(me);me.NullAction;var _e=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function o(e){var t=r.call(this,e)||this;return t.children=[],t}return f.__extends(o,r),o.prototype.insert=function(e,t){return e.parent=this,t<0?t=0:t>=this.children.length&&(t=this.children.length-1),this.children.splice(t,0,e),this},o.prototype.execute=function(t,r,n){n?this.find(function(e){return e.name===n}).execute(t,r):this.trans(function(e){e instanceof o&&e.working(t,r)})},o.prototype.empty=function(){return me.NullAction},o.prototype.working=function(e,t){},o.classAnnations={name:"ActionComposite",params:{constructor:["name"],insert:["node","index"],execute:["container","data","name"],empty:[],working:["container","data"]}},o}(ve.GComposite);t.ActionComposite=r});t(_e);_e.ActionComposite;var be=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.LifeState||(t.LifeState={})).beforeCreateArgs="beforeCreateArgs",r.beforeConstructor="beforeConstructor",r.afterConstructor="afterConstructor",r.onInit="onInit",r.AfterInit="AfterInit"});t(be);be.LifeState;var Me=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.CoreActions||(t.CoreActions={})).bindParameterType="bindParameterType",r.bindPropertyType="bindPropertyType",r.injectProperty="injectProperty",r.bindProvider="bindProvider",r.bindParameterProviders="bindParameterProviders",r.cache="cache",r.componentBeforeInit="componentBeforeInit",r.componentInit="componentInit",r.componentAfterInit="componentAfterInit",r.singletion="singletion",r.autorun="autorun",r.methodAutorun="methodAutorun"});t(Me);Me.CoreActions;var Pe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.args=e,this.idx=-1,this.metadata=null}return e.prototype.isCompeted=function(){return this.idx>=this.args.length},e.prototype.end=function(){this.idx=this.args.length},e.prototype.next=function(e){if(this.idx++,this.isCompeted())return null;var t=this.args[this.idx];e.isMetadata&&e.isMetadata(t)?(this.metadata=ce.lang.assign(this.metadata||{},t),this.end()):e.match(t)?(this.metadata=this.metadata||{},e.setMetadata(this.metadata,t)):(ce.isMetadataObject(t)&&(this.metadata=ce.lang.assign(this.metadata||{},t)),this.end())},e.prototype.getArgs=function(){return this.args},e.prototype.getMetadata=function(){return this.metadata},e.classAnnations={name:"ArgsIterator",params:{constructor:["args"],isCompeted:[],end:[],next:["express"],getArgs:[],getMetadata:[]}},e}();t.ArgsIterator=r});t(Pe);Pe.ArgsIterator;var Ae=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.DecoratorType||(t.DecoratorType={}))[r.Class=1]="Class",r[r.Parameter=2]="Parameter",r[r.Property=4]="Property",r[r.Method=8]="Method",r[r.All=13]="All"});t(Ae);Ae.DecoratorType;var Ce=r(function(e,a){function s(e,t,r,n,o){var a;switch(r.length){case 1:if(a=r[0],ce.isClass(a)||ce.isAbstractDecoratorClass(a))return function(e,t,r,n,o){var a=c(t,r).slice(0),i=n||{};i.type||(i.type=r);i.decorator=e,o&&(i=o(i));a.unshift(i),v(r),Reflect.defineMetadata(t,a,r)}(e,t,a,n,o),a;break;case 2:d(e,t,a=r[0],r[1],n,o);break;case 3:if(ce.isNumber(r[2])){!function(e,t,r,n,o,a,i){var s=y(t,r,n).slice(0);for(;s.length<=o;)s.push(null);s[o]=s[o]||[];var c=a||{};if(!c.type){var u=Reflect.getOwnMetadata("design:type",r,n);u||(u=Reflect.getOwnMetadata("design:type",r.constructor,n)),c.type=u}c.propertyKey=n,c.decorator=e,c.index=o,i&&(c=i(c));s[o].unshift(c),Reflect.defineMetadata(t+h,s,r,n)}(e,t,a=r[0],r[1],r[2],n,o)}else{if(!ce.isUndefined(r[2])){a=r[0];var i=r[1],s=r[2];return function(e,t,r,n,o,a,i){var s=ce.lang.assign({},p(t,r));s[n]=s[n]||[];var c=a||{};c.decorator=e,c.propertyKey=n,i&&(c=i(c));s[n].unshift(c),Reflect.defineMetadata(t+u,s,r.constructor)}(e,t,a,i,0,n,o),s}d(e,t,a=r[0],r[1],n,o)}break;default:throw new Error("Invalid @"+e+" Decorator declaration.")}}function c(e,t){var r=Reflect.getOwnMetadata(ce.isFunction(e)?e.toString():e,t);return r=ce.isArray(r)?r:[]}Object.defineProperty(a,"__esModule",{value:!0}),a.ParamerterName="paramerter_names",a.createDecorator=function(n,o,a){var i="@"+n,e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=null;return e.length<1?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}:(r=function(e,t){var r=null;if(e.length)if(t){var n=new Pe.ArgsIterator(e);t(n),r=n.getMetadata()}else 1===e.length&&ce.isMetadataObject(e[0])&&(r=e[0]);return r}(e,o))?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}:1!==e.length||ce.isClass(e[0])?s(n,i,e,r,a):function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}};return e.toString=function(){return i},e.decoratorType=Ae.DecoratorType.All,e},a.getTypeMetadata=function(e,t){var r=Reflect.getOwnMetadata(ce.isFunction(e)?e.toString():e,t);return r=ce.isArray(r)?r:[]},a.getOwnTypeMetadata=c,a.hasClassMetadata=function(e,t){var r=ce.isFunction(e)?e.toString():e;return Reflect.hasMetadata(r,t)},a.hasOwnClassMetadata=function(e,t){var r=ce.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(r,t)};var u="__method";function p(e,t){var r=ce.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+u,t);return n&&!ce.isArray(n)&&ce.lang.hasField(n)||(n=Reflect.getMetadata(r+u,t.constructor)),ce.isArray(n)?{}:n||{}}function i(e,t){var r=ce.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+u,t);return n&&!ce.isArray(n)&&ce.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+u,t.constructor)),ce.isArray(n)?{}:n||{}}a.getMethodMetadata=p,a.getOwnMethodMetadata=i,a.hasOwnMethodMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e;if(r){var o=i(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasOwnMetadata(n+u,t)},a.hasMethodMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e;if(r){var o=p(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+u,t)};var l="__props";function f(e,t){var r=ce.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+l,t);return n&&!ce.isArray(n)&&ce.lang.hasField(n)||(n=Reflect.getMetadata(r+l,t.constructor)),ce.isArray(n)?{}:n||{}}function d(e,t,r,n,o,a){var i=ce.lang.assign({},f(t,r)),s=o||{};if(s.propertyKey=n,s.decorator=e,!s.type){var c=Reflect.getMetadata("design:type",r,n);c||(c=Reflect.getMetadata("design:type",r.constructor,n)),s.type=c}a&&(s=a(s)),i[n]&&ce.isArray(i[n])||(i[n]=[]),i[n].unshift(s),Reflect.defineMetadata(t+l,i,r.constructor)}a.getPropertyMetadata=f,a.getOwnPropertyMetadata=function(e,t){var r=ce.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+l,t);return n&&!ce.isArray(n)&&ce.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+l,t.constructor)),ce.isArray(n)?{}:n||{}},a.hasPropertyMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e;if(r){var o=f(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+l,t)};var h="__params";function y(e,t,r){var n=ce.isFunction(e)?e.toString():e,o=Reflect.getOwnMetadata(n+h,t,r);return o=ce.isArray(o)?o:[]}function g(e){var t=Reflect.getMetadata(a.ParamerterName,e);return t&&!ce.isArray(t)&&ce.lang.hasField(t)||(t=Reflect.getMetadata(a.ParamerterName,e.constructor)),ce.isArray(t)?{}:t||{}}function v(e){var r=ce.lang.assign({},g(e)),t=Object.getOwnPropertyDescriptors(e.prototype),n=/^[a-z]/.test(e.name),o="";e.classAnnations&&e.classAnnations.params&&(o=e.classAnnations.name,r=ce.lang.assign(r,e.classAnnations.params)),n||e.name===o||(ce.lang.forIn(t,function(e,t){"constructor"!==t&&(e.value&&(r[t]=m(e.value)),e.set&&(r[t]=m(e.set)))}),r.constructor=m(e.prototype.constructor)),Reflect.defineMetadata(a.ParamerterName,r,e)}a.getParamMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e,o=Reflect.getMetadata(n+h,t,r);return o=ce.isArray(o)?o:[]},a.getOwnParamMetadata=y,a.hasParamMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e;return Reflect.hasMetadata(n+h,t,r)},a.hasOwnParamMetadata=function(e,t,r){var n=ce.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(n+h,t,r)},a.getParamerterNames=g,a.getOwnParamerterNames=function(e){var t=Reflect.getOwnMetadata(a.ParamerterName,e);return t&&!ce.isArray(t)&&ce.lang.hasField(t)||(t=Reflect.getOwnMetadata(a.ParamerterName,e.constructor)),ce.isArray(t)?{}:t||{}},a.setParamerterNames=v;var n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,o=/([^\s,]+)/g;function m(e){if(!ce.isFunction(e))return[];var t=e.toString().replace(n,""),r=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(o);return null===r&&(r=[]),r}});t(Ce);Ce.ParamerterName,Ce.createDecorator,Ce.getTypeMetadata,Ce.getOwnTypeMetadata,Ce.hasClassMetadata,Ce.hasOwnClassMetadata,Ce.getMethodMetadata,Ce.getOwnMethodMetadata,Ce.hasOwnMethodMetadata,Ce.hasMethodMetadata,Ce.getPropertyMetadata,Ce.getOwnPropertyMetadata,Ce.hasPropertyMetadata,Ce.getParamMetadata,Ce.getOwnParamMetadata,Ce.hasParamMetadata,Ce.hasOwnParamMetadata,Ce.getParamerterNames,Ce.getOwnParamerterNames,Ce.setParamerterNames;var Te=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassDecorator=function(e,t,r){var n=Ce.createDecorator(e,function(e){t&&t(e),e.next({match:function(e){return e&&(ce.isSymbol(e)||ce.isString(e)||ce.isObject(e)&&e instanceof ue.Registration)},setMetadata:function(e,t){e.provide=t}}),e.next({match:function(e){return ce.isString(e)},setMetadata:function(e,t){e.alias=t}}),e.next({match:function(e){return ce.isBoolean(e)},setMetadata:function(e,t){e.singleton=t}}),e.next({match:function(e){return ce.isNumber(e)},setMetadata:function(e,t){e.expires=t}})},r);return n.decoratorType=Ae.DecoratorType.Class,n}});t(Te);Te.createClassDecorator;var Oe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodDecorator=function(e,t,r){var n=Ce.createDecorator(e,function(e){t&&t(e),e.next({match:function(e){return ce.isArray(e)},setMetadata:function(e,t){e.providers=t}})},r);return n.decoratorType=Ae.DecoratorType.Method,n}});t(Oe);Oe.createMethodDecorator;var ke=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamDecorator=function(e,t,r){var n=Ce.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return ce.isParamMetadata(e)},match:function(e){return ce.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=Ae.DecoratorType.Parameter,n}});t(ke);ke.createParamDecorator;var we=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createPropDecorator=function(e,t,r){var n=Ce.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return ce.isPropertyMetadata(e)},match:function(e){return ce.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=Ae.DecoratorType.Property,n}});t(we);we.createPropDecorator;var Se=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamPropDecorator=function(e,t,r){var n=Ce.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return ce.isParamPropMetadata(e)},match:function(e){return ce.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=Ae.DecoratorType.Property|Ae.DecoratorType.Parameter,n}});t(Se);Se.createParamPropDecorator;var xe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassMethodDecorator=function(e,t,r){var n=Ce.createDecorator(e,t,r);return n.decoratorType=Ae.DecoratorType.Class|Ae.DecoratorType.Method,n}});t(xe);xe.createClassMethodDecorator;var je=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropDecorator=function(e,t,r){var n=Ce.createDecorator(e,t,r);return n.decoratorType=Ae.DecoratorType.Method|Ae.DecoratorType.Property,n}});t(je);je.createMethodPropDecorator;var De=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropParamDecorator=function(e,t,r){var n=Ce.createDecorator(e,t,r);return n.decoratorType=Ae.DecoratorType.Method|Ae.DecoratorType.Property|Ae.DecoratorType.Parameter,n}});t(De);De.createMethodPropParamDecorator;var Ie=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(Pe,t),f.__exportStar(Ae,t),f.__exportStar(Ce,t),f.__exportStar(Te,t),f.__exportStar(Oe,t),f.__exportStar(ke,t),f.__exportStar(we,t),f.__exportStar(Se,t),f.__exportStar(xe,t),f.__exportStar(je,t),f.__exportStar(De,t)});t(Ie);var Ee=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.bindProvider)||this}return f.__extends(t,e),t.prototype.working=function(o,e){e.target;var a=e.targetType,t=(e.propertyKey,o.getLifeScope().getClassDecorators(function(e){return e.actions.includes(Me.CoreActions.bindProvider)&&Ie.hasOwnClassMetadata(e.name,a)})),i=[];t.forEach(function(e){var t=Ie.getOwnTypeMetadata(e.name,a);if(Array.isArray(t)&&0<t.length){var r=t.find(function(e){return e&&!!e.provide});if(r){var n=o.getTokenKey(r.provide,r.alias);i.push(n),o.bindProvider(n,r.type)}}}),e.execResult=i},t.classAnnations={name:"BindProviderAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.BindProviderAction=r});t(Ee);Ee.BindProviderAction;var Re=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.bindParameterType)||this}return f.__extends(t,e),t.prototype.working=function(n,e){var o,r=e.target,a=e.targetType,i=e.propertyKey,s=n.getLifeScope();(o=(o=r&&i?Reflect.getMetadata("design:paramtypes",r,i)||[]:Reflect.getMetadata("design:paramtypes",a)||[]).slice(0)).forEach(function(e){s.isVaildDependence(e)&&(n.has(e)||n.register(e))}),s.getParameterDecorators(function(e){return e.actions.includes(Me.CoreActions.bindParameterType)&&(r||"constructor"!==i?Ie.hasParamMetadata(e.name,r,i):Ie.hasOwnParamMetadata(e.name,a))}).forEach(function(e){var t=r||"constructor"!==i?Ie.getParamMetadata(e.name,r,i):Ie.getOwnParamMetadata(e.name,a);ce.isArray(t)&&t.length&&t.forEach(function(e){var t=ce.isArray(e)&&0<e.length?e[0]:null;if(t&&0<=t.index){s.isVaildDependence(t.provider)&&(n.has(t.provider,t.alias)||n.register(n.getToken(t.provider,t.alias))),s.isVaildDependence(t.type)&&(n.has(t.type)||n.register(t.type));var r=t.provider?n.getTokenKey(t.provider,t.alias):t.type;r&&(o[t.index]=r)}})}),e.execResult=o},t.classAnnations={name:"BindParameterTypeAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.BindParameterTypeAction=r});t(Re);Re.BindParameterTypeAction;var Fe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.bindPropertyType)||this}return f.__extends(t,e),t.prototype.working=function(n,e){e.target;var o=e.targetType,a=n.getLifeScope(),t=a.getPropertyDecorators(function(e){return e.actions.includes(Me.CoreActions.bindPropertyType)&&Ie.hasPropertyMetadata(e.name,o)}),i=[];t.forEach(function(e){var t=Ie.getPropertyMetadata(e.name,o);for(var r in t)i=i.concat(t[r]);(i=i.filter(function(e){return!!e})).forEach(function(e){a.isVaildDependence(e.provider)&&(n.has(e.provider,e.alias)||n.register(n.getToken(e.provider,e.alias))),a.isVaildDependence(e.type)&&(n.has(e.type)||n.register(e.type))})}),e.execResult=i},t.classAnnations={name:"BindPropertyTypeAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.BindPropertyTypeAction=r});t(Fe);Fe.BindPropertyTypeAction;var Ne=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.injectProperty)||this}return f.__extends(t,e),t.prototype.working=function(n,o){o.execResult||this.parent.find(function(e){return e.name===Me.CoreActions.bindPropertyType}).execute(n,o),o.target&&o.execResult&&o.execResult.length&&o.execResult.reverse().forEach(function(e,t){if(e){var r=e.provider?n.getToken(e.provider,e.alias):e.type;n.has(r)&&(o.target[e.propertyKey]=n.resolve.apply(n,[r].concat(o.providers||[])))}})},t.classAnnations={name:"InjectPropertyAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.InjectPropertyAction=r});t(Ne);Ne.InjectPropertyAction;var Be=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.bindParameterProviders)||this}return f.__extends(t,e),t.prototype.working=function(e,t){t.target;var r=t.targetType,n=t.propertyKey,o=e.getLifeScope().getMethodDecorators(function(e){return e.actions.includes(Me.CoreActions.bindParameterProviders)&&Ie.hasOwnMethodMetadata(e.name,r)}),a=[];o.forEach(function(e){var t=Ie.getOwnMethodMetadata(e.name,r)[n];t&&ce.isArray(t)&&0<t.length&&t.forEach(function(e){e.providers&&0<e.providers.length&&(a=a.concat(e.providers))})}),t.execResult=a},t.classAnnations={name:"BindParameterProviderAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.BindParameterProviderAction=r});t(Be);Be.BindParameterProviderAction;var Le=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.componentBeforeInit)||this}return f.__extends(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;ce.isFunction(r.beforeInit)&&e.syncInvoke(t.targetType,"beforeInit",t.target)}},t.classAnnations={name:"ComponentBeforeInitAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.ComponentBeforeInitAction=r});t(Le);Le.ComponentBeforeInitAction;var Ke=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.componentInit)||this}return f.__extends(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;ce.isFunction(r.onInit)&&e.syncInvoke(t.targetType,"onInit",t.target)}},t.classAnnations={name:"ComponentInitAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.ComponentInitAction=r});t(Ke);Ke.ComponentInitAction;var $e=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.componentAfterInit)||this}return f.__extends(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;ce.isFunction(r.afterInit)&&e.syncInvoke(t.targetType,"afterInit",t.target)}},t.classAnnations={name:"ComponentAfterInitAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.ComponentAfterInitAction=r});t($e);$e.ComponentAfterInitAction;var Ue=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CacheManagerToken=new pe.InjectToken("__IOC_ICacheManager")});t(Ue);Ue.CacheManagerToken;var qe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.cache)||this}return f.__extends(t,e),t.prototype.working=function(e,t){if(t.singleton||!t.targetType||!ce.isClass(t.targetType))return t;var r=e.get(Ue.CacheManagerToken);if(t.target){if(!r.hasCache(t.targetType))(n=this.getCacheMetadata(e,t))&&r.cache(t.targetType,t.target,n.expires)}else{var n,o=r.get(t.targetType);if(o)(n=this.getCacheMetadata(e,t))&&(r.cache(t.targetType,o,n.expires),t.execResult=o)}return t},t.prototype.getCacheMetadata=function(e,t){for(var r,n=e.getLifeScope().getClassDecorators(function(e){return Ie.hasOwnClassMetadata(e.name,t.targetType)}),o=0;o<n.length;o++){var a=n[o],i=Ie.getOwnTypeMetadata(a.name,t.targetType);if(Array.isArray(i)&&0<i.length&&(r=i.find(function(e){return e&&ce.isNumber(e.expires)&&0<e.expires})))break}return r},t.classAnnations={name:"CacheAction",params:{constructor:[],working:["container","data"],getCacheMetadata:["container","data"]}},t}(_e.ActionComposite);t.CacheAction=r});t(qe);qe.CacheAction;var Ve=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.singletion)||this}return f.__extends(t,e),t.prototype.working=function(e,t){t.tokenKey&&t.target&&t.singleton&&e.registerValue(t.tokenKey,t.target)},t.classAnnations={name:"SingletionAction",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.SingletionAction=r});t(Ve);Ve.SingletionAction;var ze=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Component=Ie.createClassDecorator("Component")});t(ze);ze.Component;var We=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Injectable=Ie.createClassDecorator("Injectable")});t(We);We.Injectable;var Ge=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Inject=Ie.createParamPropDecorator("Inject")});t(Ge);Ge.Inject;var He=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AutoWired=Ie.createParamPropDecorator("AutoWired")});t(He);He.AutoWired;var Xe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Param=Ie.createParamDecorator("Param")});t(Xe);Xe.Param;var Ye=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Method=Ie.createMethodDecorator("Method")});t(Ye);Ye.Method;var Ze=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Singleton=Ie.createClassDecorator("Singleton",null,function(e){return e.singleton=!0,e})});t(Ze);Ze.Singleton;var Je=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Abstract=Ie.createClassDecorator("Abstract")});t(Je);Je.Abstract;var Qe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Autorun=Ie.createClassMethodDecorator("Autorun",function(e){e.next({isMetadata:function(e){return ce.isClassMetadata(e,["autorun"])},match:function(e){return ce.isString(e)||ce.isNumber(e)},setMetadata:function(e,t){ce.isString(t)?e.autorun=t:e.order=t}})},function(e){return e.singleton=!0,e})});t(Qe);Qe.Autorun;var et=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IocExt=Ie.createClassDecorator("IocExt",function(e){e.next({isMetadata:function(e){return ce.isClassMetadata(e,["autorun"])},match:function(e){return ce.isString(e)},setMetadata:function(e,t){e.autorun=t}})},function(e){return e.singleton=!0,e}),t.IocModule=t.IocExt});t(et);et.IocExt,et.IocModule;var tt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DefModule=Ie.createClassDecorator("DefModule")});t(tt);tt.DefModule;var rt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(ze,t),f.__exportStar(We,t),f.__exportStar(Ge,t),f.__exportStar(He,t),f.__exportStar(Xe,t),f.__exportStar(Ye,t),f.__exportStar(Ze,t),f.__exportStar(Je,t),f.__exportStar(Qe,t),f.__exportStar(et,t),f.__exportStar(tt,t)});t(rt);var nt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.autorun)||this}return f.__extends(t,e),t.prototype.getDecorator=function(){return[rt.IocExt,rt.Autorun]},t.prototype.working=function(o,a){a.tokenKey&&a.targetType&&this.getDecorator().forEach(function(e){if(Ie.hasClassMetadata(e,a.targetType)){var t=Ie.getTypeMetadata(e,a.targetType),r=t.find(function(e){return!!e.autorun});if(!r&&t.length&&(r=t[0]),r){var n=o.get(a.tokenKey);n&&r.autorun&&ce.isFunction(n[r.autorun])&&o.syncInvoke(a.tokenKey,r.autorun,n)}}})},t.classAnnations={name:"AutorunAction",params:{constructor:[],getDecorator:[],working:["container","data"]}},t}(_e.ActionComposite);t.AutorunAction=r});t(nt);nt.AutorunAction;var ot=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(_e,t),f.__exportStar(be,t),f.__exportStar(Me,t),f.__exportStar(me,t),f.__exportStar(Ee,t),f.__exportStar(Re,t),f.__exportStar(Fe,t),f.__exportStar(Ne,t),f.__exportStar(Be,t),f.__exportStar(Le,t),f.__exportStar(Ke,t),f.__exportStar($e,t),f.__exportStar(qe,t),f.__exportStar(Ve,t),f.__exportStar(nt,t)});t(ot);var at=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderMapToken=new pe.InjectToken("__IOC_ProviderMap");var r=function(){function e(e){this.container=e,this.maps=new ce.MapSet}return e.prototype.has=function(e){return this.maps.has(e)},e.prototype.get=function(e){return this.maps.get(e)},e.prototype.add=function(e,n){var t,o=this;return ce.isUndefined(e)||(t=ce.isToken(n)&&this.container.has(n)?function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=o.container).resolve.apply(e,[n].concat(t))}:ce.isFunction(n)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,[o.container].concat(e))}:function(){return n},this.maps.set(e,t)),this},e.prototype.remove=function(e){return this.maps.has(e)&&this.maps.delete(e),this},e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this.maps.has(e))return!ce.isNumber(e)&&this.container.has(e)?(n=this.container).resolve.apply(n,[e].concat(t)):null;var n,o,a=this.maps.get(e);return ce.isToken(a)?(o=this.container).resolve.apply(o,[a].concat(t)):a.apply(void 0,t)},e.prototype.forEach=function(e){this.maps.forEach(e)},e.prototype.copy=function(e){var r=this;e&&e.forEach(function(e,t){r.maps.set(t,e)})},e.classAnnations={name:"ProviderMap",params:{constructor:["container"],has:["provide"],get:["provide"],add:["provide","provider"],remove:["provide"],resolve:["provide","providers"],forEach:["express"],copy:["map"]}},e}();t.ProviderMap=r});t(at);at.ProviderMapToken,at.ProviderMap;var it=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t){this.type=e,this.value=t}return r.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return ce.isUndefined(this.value)?e.has(this.type)?e.resolve.apply(e,[this.type].concat(t)):null:this.value},r.create=function(e,t){return new r(e,t)},r.createExtends=function(e,t,r){return new a(e,t,r)},r.createInvoke=function(e,t,r){return new n(e,t,r)},r.createParam=function(e,t,r,n){return new o(e,t,r,n)},r.classAnnations={name:"Provider",params:{constructor:["type","value"],resolve:["container","providers"],create:["type","value"],createExtends:["token","value","extendsTarget"],createInvoke:["token","method","value"],createParam:["token","value","index","method"]}},r}(),n=function(o){function e(e,t,r){var n=o.call(this,e,r)||this;return n.method=t,n}return f.__extends(e,o),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.method?e.syncInvoke.apply(e,[this.type,this.method].concat(t)):o.prototype.resolve.apply(this,[e].concat(t))},e.classAnnations={name:"InvokeProvider",params:{constructor:["type","method","value"],resolve:["container","providers"]}},e}(t.Provider=r),o=function(a){function e(e,t,r,n){var o=a.call(this,e,n,t)||this;return o.index=r,o}return f.__extends(e,a),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return a.prototype.resolve.apply(this,[e].concat(t))},e.classAnnations={name:"ParamProvider",params:{constructor:["token","value","index","method"],resolve:["container","providers"]}},e}(t.InvokeProvider=n);t.ParamProvider=o;var a=function(o){function e(e,t,r){var n=o.call(this,e,t)||this;return n.extendsTarget=r,n}return f.__extends(e,o),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return o.prototype.resolve.apply(this,[e].concat(t))},e.prototype.extends=function(e){ce.isObject(e)&&ce.isFunction(this.extendsTarget)&&this.extendsTarget(e,this)},e.classAnnations={name:"ExtendsProvider",params:{constructor:["token","value","extendsTarget"],resolve:["container","providers"],extends:["target"]}},e}(r);t.ExtendsProvider=a});t(it);it.Provider,it.InvokeProvider,it.ParamProvider,it.ExtendsProvider;var st=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(it,t),f.__exportStar(at,t),t.isProviderMap=function(e){return!!ce.isObject(e)&&e instanceof at.ProviderMap}});t(st);st.isProviderMap;var ct=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognizerToken=new pe.InjectToken("__IOC_IRecognizer")});t(ct);ct.RecognizerToken;var ut=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderMatcherToken=new pe.InjectToken("__IOC_IProviderMatcher")});t(ut);ut.ProviderMatcherToken;var pt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,Me.CoreActions.methodAutorun)||this}return f.__extends(t,e),t.prototype.working=function(t,r){if(r.target&&r.targetType&&Ie.hasMethodMetadata(rt.Autorun,r.targetType)){var e=Ie.getMethodMetadata(rt.Autorun,r.targetType),n=[],o=ce.lang.keys(e).length;ce.lang.forIn(e,function(e,t){if(e&&e.length){var r=e[0];r.autorun=t,o++,ce.isNumber(r.order)||(r.order=o),n.push(r)}}),n.sort(function(e,t){return e.order-e.order}).forEach(function(e){t.syncInvoke(r.targetType,e.autorun,r.target)})}},t.classAnnations={name:"MethodAutorun",params:{constructor:[],working:["container","data"]}},t}(_e.ActionComposite);t.MethodAutorun=r});t(pt);pt.MethodAutorun;var lt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.create=function(e){var t;switch(e){case ot.CoreActions.bindParameterType:t=new ot.BindParameterTypeAction;break;case ot.CoreActions.bindPropertyType:t=new ot.BindPropertyTypeAction;break;case ot.CoreActions.injectProperty:t=new ot.InjectPropertyAction;break;case ot.CoreActions.bindProvider:t=new ot.BindProviderAction;break;case ot.CoreActions.bindParameterProviders:t=new ot.BindParameterProviderAction;break;case ot.CoreActions.componentInit:t=new ot.ComponentInitAction;break;case ot.CoreActions.componentBeforeInit:t=new ot.ComponentBeforeInitAction;break;case ot.CoreActions.componentAfterInit:t=new ot.ComponentAfterInitAction;break;case ot.CoreActions.cache:t=new ot.CacheAction;break;case ot.CoreActions.singletion:t=new ot.SingletionAction;break;case ot.CoreActions.autorun:t=new ot.AutorunAction;break;case ot.CoreActions.methodAutorun:t=new pt.MethodAutorun;break;default:t=new ot.ActionComposite(e)}return t},e.classAnnations={name:"ActionFactory",params:{create:["type"]}},e}();t.ActionFactory=r});t(lt);lt.ActionFactory;var ft=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.decorators=[],this.buildAction()}return e.prototype.addAction=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.action;return t.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.add(e),this},e.prototype.registerDecorator=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getDecoratorType(e);return this.registerCustomDecorator.apply(this,[e,n].concat(t))},e.prototype.registerCustomDecorator=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this.toActionName(t),a=e.toString();return this.decorators.some(function(e){return e.name===a})||this.decorators.push({name:a,types:o,actions:r}),this},e.prototype.execute=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t=t.filter(function(e){return!!e});var n=this.action;t.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.execute(this.container,e)},e.prototype.getClassDecorators=function(e){return this.getTypeDecorators(this.toActionName(Ie.DecoratorType.Class),e)},e.prototype.getMethodDecorators=function(e){return this.getTypeDecorators(this.toActionName(Ie.DecoratorType.Method),e)},e.prototype.getPropertyDecorators=function(e){return this.getTypeDecorators(this.toActionName(Ie.DecoratorType.Property),e)},e.prototype.getParameterDecorators=function(e){return this.getTypeDecorators(this.toActionName(Ie.DecoratorType.Parameter),e)},e.prototype.getDecoratorType=function(e){return e.decoratorType||Ie.DecoratorType.All},e.prototype.isVaildDependence=function(t){return!!t&&(!!ce.isClass(t)&&(!ce.isAbstractDecoratorClass(t)&&this.getClassDecorators().some(function(e){return Ie.hasOwnClassMetadata(e.name,t)})))},e.prototype.getAtionByName=function(t){return this.action.find(function(e){return e.name===t})},e.prototype.getClassAction=function(){return this.getAtionByName(this.toActionName(Ie.DecoratorType.Class))},e.prototype.getMethodAction=function(){return this.getAtionByName(this.toActionName(Ie.DecoratorType.Method))},e.prototype.getPropertyAction=function(){return this.getAtionByName(this.toActionName(Ie.DecoratorType.Property))},e.prototype.getParameterAction=function(){return this.getAtionByName(this.toActionName(Ie.DecoratorType.Parameter))},e.prototype.getConstructorParameters=function(e){return this.getParameters(e)},e.prototype.getMethodParameters=function(e,t,r){return this.getParameters(e,t,r)},e.prototype.getParamerterNames=function(e,t){var r=Ie.getOwnParamerterNames(e),n=[];return r&&r.hasOwnProperty(t)&&(n=r[t]),ce.isArray(n)||(n=[]),n},e.prototype.isSingletonType=function(r){return!!Ie.hasOwnClassMetadata(rt.Singleton,r)||this.getClassDecorators().some(function(e){var t=Ie.getOwnTypeMetadata(e.name,r)||[];return!!ce.isArray(t)&&t.some(function(e){return!0===e.singleton})})},e.prototype.getMethodMetadatas=function(r,n){var o=[];return this.getMethodDecorators().forEach(function(e){var t=Ie.getOwnMethodMetadata(e.name,r);t.hasOwnProperty(n)&&(o=o.concat(t[n]||[]))}),o},e.prototype.filerDecorators=function(e){return this.decorators.filter(e)},e.prototype.getParameters=function(e,t,r){var n={target:t,targetType:e,propertyKey:r=r||"constructor"};this.execute(n,ot.LifeState.onInit,ot.CoreActions.bindParameterType);var o=this.getParamerterNames(e,r);return n.execResult.length?n.execResult.map(function(e,t){return{type:e,name:o[t]}}):o.map(function(e){return{name:e,type:void 0}})},e.prototype.getTypeDecorators=function(r,n){return this.filerDecorators(function(e){var t=0<=(e.types||"").indexOf(r);return t&&n&&(t=n(e)),t})},e.prototype.buildAction=function(){var e=new lt.ActionFactory,t=e.create("");t.add(e.create(fe.IocState.design).add(e.create(ot.CoreActions.bindProvider)).add(e.create(ot.CoreActions.autorun))).add(e.create(fe.IocState.runtime).add(e.create(ot.LifeState.beforeCreateArgs)).add(e.create(ot.LifeState.beforeConstructor)).add(e.create(ot.LifeState.afterConstructor)).add(e.create(ot.LifeState.onInit).add(e.create(ot.CoreActions.componentBeforeInit)).add(e.create(this.toActionName(Ie.DecoratorType.Class))).add(e.create(this.toActionName(Ie.DecoratorType.Method))).add(e.create(this.toActionName(Ie.DecoratorType.Property)).add(e.create(ot.CoreActions.bindPropertyType)).add(e.create(ot.CoreActions.injectProperty))).add(e.create(this.toActionName(Ie.DecoratorType.Parameter)).add(e.create(ot.CoreActions.bindParameterType)).add(e.create(ot.CoreActions.bindParameterProviders))).add(e.create(ot.CoreActions.componentInit))).add(e.create(ot.LifeState.AfterInit).add(e.create(ot.CoreActions.singletion)).add(e.create(ot.CoreActions.componentAfterInit)).add(e.create(ot.CoreActions.methodAutorun)))).add(e.create(ot.CoreActions.cache)),this.action=t},e.prototype.toActionName=function(e){var t=[];return e&Ie.DecoratorType.Class&&t.push("ClassDecorator"),e&Ie.DecoratorType.Method&&t.push("MethodDecorator"),e&Ie.DecoratorType.Property&&t.push("PropertyDecorator"),e&Ie.DecoratorType.Parameter&&t.push("ParameterDecorator"),t.join(",")},e.classAnnations={name:"DefaultLifeScope",params:{constructor:["container"],addAction:["action","nodepaths"],registerDecorator:["decorator","actions"],registerCustomDecorator:["decorator","type","actions"],execute:["data","names"],getClassDecorators:["match"],getMethodDecorators:["match"],getPropertyDecorators:["match"],getParameterDecorators:["match"],getDecoratorType:["decirator"],isVaildDependence:["target"],getAtionByName:["name"],getClassAction:[],getMethodAction:[],getPropertyAction:[],getParameterAction:[],getConstructorParameters:["type"],getMethodParameters:["type","instance","propertyKey"],getParamerterNames:["type","propertyKey"],isSingletonType:["type"],getMethodMetadatas:["type","propertyKey"],filerDecorators:["express"],getParameters:["type","instance","propertyKey"],getTypeDecorators:["decType","match"],buildAction:[],toActionName:["type"]}},e}();t.DefaultLifeScope=r});t(ft);ft.DefaultLifeScope;var dt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.toProviderMap=function(){for(var o=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length&&st.isProviderMap(e[0]))return e[0];var a=this.container.resolve(st.ProviderMapToken);return e.forEach(function(r,e){if(!ce.isUndefined(r)&&!ce.isNull(r))if(st.isProviderMap(r))a.copy(r);else if(r instanceof st.Provider)r instanceof st.ParamProvider?!r.type&&ce.isNumber(r.index)?a.add(r.index,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))}):a.add(r.type,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))}):a.add(r.type,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))});else if(ce.isClass(r))o.container.has(r)||o.container.register(r),a.add(r,r);else if(ce.isBaseObject(r)){var t=r,n=!1;ce.isToken(t.provide)?(ce.isArray(t.deps)&&t.deps.length&&t.deps.forEach(function(e){ce.isClass(e)&&!o.container.has(e)&&o.container.register(e)}),ce.isUndefined(t.useValue)?ce.isClass(t.useClass)?(o.container.has(t.useClass)||o.container.register(t.useClass),a.add(t.provide,t.useClass)):ce.isFunction(t.useFactory)?a.add(t.provide,function(){var e=[];return ce.isArray(t.deps)&&t.deps.length&&(e=t.deps.map(function(e){return ce.isClass(e)?o.container.get(e):e})),t.useFactory.apply(t,e)}):ce.isToken(t.useExisting)?o.container.has(t.useExisting)?a.add(t.provide,function(){return o.container.resolve(t.useExisting)}):console.log("has not register:",t.useExisting):n=!0:a.add(t.provide,function(){return t.useValue})):n=!0,n&&ce.lang.forIn(r,function(e,t){ce.isUndefined(e)||(ce.isClass(e)?a.add(t,e):ce.isFunction(e)||ce.isString(e)?a.add(t,function(){return e}):a.add(t,e))})}else ce.isFunction(r)?a.add(name,function(){return r}):a.add(e,r)}),a},e.prototype.matchProviders=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.match(e,this.toProviderMap.apply(this,t))},e.prototype.match=function(e,r){var n=this,o=this.container.resolve(st.ProviderMapToken);return e.length&&e.forEach(function(e,t){e.name&&(r.has(e.name)?o.add(e.name,r.get(e.name)):ce.isToken(e.type)?r.has(e.type)?o.add(e.name,r.get(e.type)):n.container.has(e.type)&&o.add(e.name,e.type):r.has(t)&&o.add(e.name,r.get(t)))}),o},e.classAnnations={name:"ProviderMatcher",params:{constructor:["container"],toProviderMap:["providers"],matchProviders:["params","providers"],match:["params","providers"]}},e}();t.ProviderMatcher=r});t(dt);dt.ProviderMatcher;var ht=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.getMatcher=function(){return this.container.get(ut.ProviderMatcherToken)},e.prototype.invoke=function(s,c,u){for(var p=[],e=3;e<arguments.length;e++)p[e-3]=arguments[e];return f.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,i;return f.__generator(this,function(e){switch(e.label){case 0:if(u||(u=(i=this.container).resolve.apply(i,[s].concat(p))),!(t=this.container.getTokenImpl(s)))throw Error(s.toString()+" is not implements by any class.");return u&&ce.isFunction(u[c])?(r={target:u,targetType:t,propertyKey:c},(n=this.container.getLifeScope()).execute(r,ot.LifeState.onInit,ot.CoreActions.bindParameterProviders),p=p.concat(r.execResult),o=n.getMethodParameters(t,u,c),[4,this.createParams.apply(this,[o].concat(p))]):[3,2];case 1:return a=e.sent(),[2,u[c].apply(u,a)];case 2:throw new Error("type: "+t+" has no method "+c+".");case 3:return[2]}})})},e.prototype.syncInvoke=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];r||(r=(a=this.container).resolve.apply(a,[e].concat(n)));var a,i=this.container.getTokenImpl(e);if(!i)throw Error(e.toString()+" is not implements by any class.");if(r&&ce.isFunction(r[t])){var s={target:r,targetType:i,propertyKey:t},c=this.container.getLifeScope();c.execute(s,ot.LifeState.onInit,ot.CoreActions.bindParameterProviders),n=n.concat(s.execResult);var u=c.getMethodParameters(i,r,t),p=this.createSyncParams.apply(this,[u].concat(n));return r[t].apply(r,p)}throw new Error("type: "+i+" has no method "+t+".")},e.prototype.createSyncParams=function(e){for(var n=this,o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];var r,a=(r=this.getMatcher()).matchProviders.apply(r,[e].concat(o));return e.map(function(e,t){return e.name&&a.has(e.name)?a.resolve(e.name):ce.isToken(e.type)?(r=n.container).resolve.apply(r,[e.type].concat(o)):void 0;var r})},e.prototype.createParams=function(e){for(var n=this,o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];var r,a=(r=this.getMatcher()).matchProviders.apply(r,[e].concat(o));return Promise.all(e.map(function(e,t){return e.name&&a.has(e.name)?a.resolve(e.name):ce.isToken(e.type)?(r=n.container).resolve.apply(r,[e.type].concat(o)):void 0;var r}))},e.classAnnations={name:"MethodAccessor",params:{constructor:["container"],getMatcher:[],invoke:["token","propertyKey","target","providers"],syncInvoke:["token","propertyKey","target","providers"],createSyncParams:["params","providers"],createParams:["params","providers"]}},e}();t.MethodAccessor=r});t(ht);ht.MethodAccessor;var yt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.cacheTokens=new ce.MapSet}return e.prototype.isChecking=function(){return!!this.timeout},e.prototype.hasCache=function(e){return this.cacheTokens.has(e)},e.prototype.cache=function(e,t,r){var n;this.hasCache(e)?(n=this.cacheTokens.get(e)).expires=Date.now()+r:n={target:t,expires:Date.now()+r},this.cacheTokens.set(e,n),this.isChecking()||this.checkExpires()},e.prototype.get=function(e,t){var r=null;if(!this.cacheTokens.has(e))return null;var n=this.cacheTokens.get(e);return n.expires<=Date.now()?(r=n.target,ce.isNumber(t)&&0<t&&(n.expires=Date.now()+t,this.cacheTokens.set(e,n))):this.destroy(e,n.target),r},e.prototype.checkExpires=function(){var t=this;if(this.timeout&&(clearTimeout(this.timeout),this.timeout=0),0<this.cacheTokens.size){var r=[];this.cacheTokens.forEach(function(e,t){e.expires>=Date.now()&&r.push(t)}),r.length&&r.forEach(function(e){t.destroy(e,t.cacheTokens.get(e).target)}),this.timeout=setTimeout(function(){t.checkExpires()},6e4)}},e.prototype.destroy=function(e,t){if(this.hasCache(e)){t||(t=this.cacheTokens.get(e).target);try{var r=t;ce.isFunction(r.onDestroy)&&this.container.syncInvoke(e,"onDestroy",t),this.cacheTokens.delete(e)}catch(e){console.error&&console.error(e)}}},e.classAnnations={name:"CacheManager",params:{constructor:["container"],isChecking:[],hasCache:["targetType"],cache:["targetType","target","expires"],get:["targetType","expires"],checkExpires:[],destroy:["targetType","target"]}},e}();t.CacheManager=r});t(yt);yt.CacheManager;var gt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(ot,t),f.__exportStar(rt,t),f.__exportStar(Ie,t),f.__exportStar(st,t),f.__exportStar(ct,t),f.__exportStar(ut,t),f.__exportStar(lt,t),f.__exportStar(ft,t),f.__exportStar(dt,t),f.__exportStar(ht,t),f.__exportStar(yt,t)});t(gt);var vt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LifeScopeToken=new pe.InjectToken("__IOC_LifeScope")});t(vt);vt.LifeScopeToken;var mt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerBuilderToken=new pe.InjectToken("__IOC_IContainerBuilder")});t(mt);mt.ContainerBuilderToken;var _t=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.build=function(o,a){return f.__awaiter(this,void 0,void 0,function(){var t,r,n;return f.__generator(this,function(e){switch(e.label){case 0:return t=this.getConfigure(o,a),(r=t.bootstrap||(ce.isToken(o)?o:null))?(n=this.container,[4,this.registerDepdences(t)]):[2,Promise.reject("not find bootstrap token.")];case 1:return e.sent(),ce.isClass(r)&&(n.has(r)||n.register(r)),[2,n.resolve(r)]}})})},e.prototype.getConfigure=function(e,t){var r;return ce.isClass(e)?r=this.getMetaConfig(e,t||gt.DefModule):ce.isToken(e)||(r=e),r||{}},e.prototype.getMetaConfig=function(e,t){if(gt.hasClassMetadata(t,e)){var r=gt.getTypeMetadata(t,e);if(r&&r.length)return r[0]}return null},e.prototype.registerDepdences=function(r){return f.__awaiter(this,void 0,void 0,function(){var t;return f.__generator(this,function(e){switch(e.label){case 0:return ce.isArray(r.imports)&&r.imports.length?[4,(t=this.container).loadModule.apply(t,r.imports)]:[3,2];case 1:e.sent(),e.label=2;case 2:return ce.isArray(r.providers)&&r.providers.length&&this.bindProvider(this.container,r.providers),[2,this.container]}})})},e.prototype.bindProvider=function(o,e){e.forEach(function(r,e){if(!ce.isUndefined(r)&&!ce.isNull(r))if(gt.isProviderMap(r))r.forEach(function(e,t){o.bindProvider(e,t)});else if(r instanceof gt.Provider)o.bindProvider(r.type,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o].concat(e))});else if(ce.isClass(r))o.has(r)||o.register(r);else if(ce.isBaseObject(r)){var t=r,n=!1;ce.isToken(t.provide)?(ce.isArray(t.deps)&&t.deps.length&&t.deps.forEach(function(e){ce.isClass(e)&&!o.has(e)&&o.register(e)}),ce.isUndefined(t.useValue)?ce.isClass(t.useClass)?(o.has(t.useClass)||o.register(t.useClass),o.bindProvider(t.provide,t.useClass)):ce.isFunction(t.useFactory)?o.bindProvider(t.provide,function(){var e=[];return ce.isArray(t.deps)&&t.deps.length&&(e=t.deps.map(function(e){return ce.isClass(e)?o.get(e):e})),t.useFactory.apply(t,e)}):ce.isToken(t.useExisting)?o.has(t.useExisting)?o.bindProvider(t.provide,t.useExisting):console.log("has not register:",t.useExisting):n=!0:o.bindProvider(t.provide,function(){return t.useValue})):n=!0,n&&ce.lang.forIn(r,function(e,t){ce.isUndefined(e)||(ce.isClass(e)?o.bindProvider(t,e):ce.isFunction(e)||ce.isString(e)?o.bindProvider(t,function(){return e}):o.bindProvider(t,e))})}else ce.isFunction(r)&&o.bindProvider(name,function(){return r})})},e.classAnnations={name:"ModuleBuilder",params:{constructor:["container"],build:["modules","moduleDecorator"],getConfigure:["modules","moduleDecorator"],getMetaConfig:["bootModule","moduleDecorator"],registerDepdences:["config"],bindProvider:["container","providers"]}},e}();t.ModuleBuilder=r});t(_t);_t.ModuleBuilder;var bt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleBuilderToken=new pe.InjectToken("__IOC_ModuleBuilder")});t(bt);bt.ModuleBuilderToken;var Mt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.registerCores=function(e){e.registerSingleton(vt.LifeScopeToken,function(){return new ft.DefaultLifeScope(e)}),e.registerSingleton(Ue.CacheManagerToken,function(){return new yt.CacheManager(e)}),e.register(st.ProviderMapToken,function(){return new st.ProviderMap(e)}),e.bindProvider(st.ProviderMap,st.ProviderMapToken),e.registerSingleton(ut.ProviderMatcherToken,function(){return new dt.ProviderMatcher(e)}),e.registerSingleton(de.MethodAccessorToken,function(){return new ht.MethodAccessor(e)}),e.register(bt.ModuleBuilderToken,function(){return new _t.ModuleBuilder(e)});var t=e.get(vt.LifeScopeToken);t.registerDecorator(rt.Injectable,ot.CoreActions.bindProvider,ot.CoreActions.cache),t.registerDecorator(rt.Component,ot.CoreActions.bindProvider,ot.CoreActions.cache,ot.CoreActions.componentBeforeInit,ot.CoreActions.componentInit,ot.CoreActions.componentAfterInit),t.registerDecorator(rt.Singleton,ot.CoreActions.bindProvider),t.registerDecorator(rt.Abstract,ot.CoreActions.bindProvider,ot.CoreActions.cache),t.registerDecorator(rt.AutoWired,ot.CoreActions.bindParameterType,ot.CoreActions.bindPropertyType),t.registerDecorator(rt.Inject,ot.CoreActions.bindParameterType,ot.CoreActions.bindPropertyType),t.registerDecorator(rt.Param,ot.CoreActions.bindParameterType,ot.CoreActions.bindPropertyType),t.registerDecorator(rt.Method,ot.CoreActions.bindParameterProviders),t.registerDecorator(rt.Autorun,ot.CoreActions.autorun,ot.CoreActions.methodAutorun),t.registerDecorator(rt.IocExt,ot.CoreActions.autorun,ot.CoreActions.componentBeforeInit,ot.CoreActions.componentInit,ot.CoreActions.componentAfterInit),e.register(Date,function(){return new Date}),e.register(String,function(){return""}),e.register(Number,function(){return Number.NaN}),e.register(Boolean,function(){})}});t(Mt);Mt.registerCores;var Pt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.init()}return e.prototype.get=function(e,t){return this.resolve(t?this.getTokenKey(e,t):e)},e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getTokenKey(e);return this.hasRegister(n)?this.factories.get(n).apply(void 0,t):(console.error("have not register",n),null)},e.prototype.clearCache=function(e){this.get(Ue.CacheManagerToken).destroy(e)},e.prototype.getToken=function(e,t){return t?new ue.Registration(e,t):e},e.prototype.getTokenKey=function(e,t){return t?new ue.Registration(e,t).toString():e instanceof ue.Registration?e.toString():e},e.prototype.register=function(e,t){return this.registerFactory(e,t),this},e.prototype.has=function(e,t){var r=this.getTokenKey(e,t);return this.hasRegister(r)},e.prototype.hasRegister=function(e){return this.factories.has(e)},e.prototype.unregister=function(e){var t=this.getTokenKey(e);return this.hasRegister(t)&&this.factories.delete(t),this},e.prototype.registerSingleton=function(e,t){return this.registerFactory(e,t,!0),this},e.prototype.registerValue=function(e,t){var r=this,n=this.getTokenKey(e);return this.singleton.set(n,t),this.factories.has(n)||this.factories.set(n,function(){return r.singleton.get(n)}),this},e.prototype.bindProvider=function(e,r){var t,n=this,o=this.getTokenKey(e);if(t=ce.isToken(r)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.resolve.apply(n,[r].concat(e))}:ce.isFunction(r)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,[n].concat(e))}:function(){return r},ce.isClass(r))this.provideTypes.set(e,r);else if(ce.isToken(r))for(var a=r;this.provideTypes.has(a)&&!ce.isClass(a);)if(a=this.provideTypes.get(a),ce.isClass(a)){this.provideTypes.set(e,a);break}return this.factories.set(o,t),this},e.prototype.getTokenImpl=function(e){return ce.isClass(e)?e:this.provideTypes.has(e)?this.provideTypes.get(e):null},e.prototype.getLifeScope=function(){return this.get(vt.LifeScopeToken)},e.prototype.use=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.get(mt.ContainerBuilderToken)).syncLoadModule.apply(e,[this].concat(t)),this},e.prototype.loadModule=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.get(mt.ContainerBuilderToken)).loadModule.apply(e,[this].concat(t))},e.prototype.invoke=function(e,t,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(de.MethodAccessorToken)).invoke.apply(n,[e,t,r].concat(o))},e.prototype.syncInvoke=function(e,t,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(de.MethodAccessorToken)).syncInvoke.apply(n,[e,t,r].concat(o))},e.prototype.createSyncParams=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(t=this.get(de.MethodAccessorToken)).createSyncParams.apply(t,[e].concat(r))},e.prototype.createParams=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(t=this.get(de.MethodAccessorToken)).createParams.apply(t,[e].concat(r))},e.prototype.cacheDecorator=function(e,t){e.has(t.name)||e.set(t.name,t)},e.prototype.init=function(){var e=this;this.factories=new ce.MapSet,this.singleton=new ce.MapSet,this.provideTypes=new ce.MapSet,this.bindProvider(le.ContainerToken,function(){return e}),Mt.registerCores(this)},e.prototype.registerFactory=function(e,t,r){var n=this.getTokenKey(e);if(!this.factories.has(n)){var o;if(ce.isUndefined(t)){if(!ce.isString(e)&&!ce.isSymbol(e)){var a=e instanceof ue.Registration?e.getClass():e;ce.isClass(a)&&this.bindTypeFactory(n,a,r)}}else ce.isFunction(t)?ce.isClass(t)?this.bindTypeFactory(n,t,r):o=this.createCustomFactory(n,t,r):r&&void 0!==t&&(o=this.createCustomFactory(n,function(){return t},r));o&&this.factories.set(n,o)}},e.prototype.createCustomFactory=function(n,o,e){var a=this;return e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(a.singleton.has(n))return a.singleton.get(n);var r=o.apply(void 0,[a].concat(e));return a.singleton.set(n,r),r}:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.apply(void 0,[a].concat(e))}},e.prototype.bindTypeFactory=function(a,i,s){var c=this;if(Reflect.isExtensible(i)){var u=this.getLifeScope(),p=u.getConstructorParameters(i);s||(s=u.isSingletonType(i));this.factories.set(a,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(s&&c.singleton.has(a))return c.singleton.get(a);if(e.length<1){var r={tokenKey:a,targetType:i,singleton:s};if(u.execute(r,gt.CoreActions.cache),r.execResult&&r.execResult instanceof i)return r.execResult}u.execute({tokenKey:a,targetType:i,params:p,providers:e,singleton:s},fe.IocState.runtime,gt.LifeState.beforeCreateArgs);var n=c.createSyncParams.apply(c,[p].concat(e));u.execute({tokenKey:a,targetType:i,args:n,params:p,providers:e,singleton:s},fe.IocState.runtime,gt.LifeState.beforeConstructor);var o=new(i.bind.apply(i,[void 0].concat(n)));return u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:e,singleton:s},fe.IocState.runtime,gt.LifeState.afterConstructor),u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:e,singleton:s},fe.IocState.runtime,gt.LifeState.onInit),u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:e,singleton:s},fe.IocState.runtime,gt.LifeState.AfterInit),u.execute({tokenKey:a,target:o,targetType:i},gt.CoreActions.cache),o}),u.execute({tokenKey:a,targetType:i},fe.IocState.design)}},e.classAnnations={name:"Container",params:{constructor:[],get:["token","alias"],resolve:["token","providers"],clearCache:["targetType"],getToken:["token","alias"],getTokenKey:["token","alias"],register:["token","value"],has:["token","alias"],hasRegister:["key"],unregister:["token"],registerSingleton:["token","value"],registerValue:["token","value"],bindProvider:["provide","provider"],getTokenImpl:["token"],getLifeScope:[],use:["modules"],loadModule:["modules"],invoke:["token","propertyKey","instance","providers"],syncInvoke:["token","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"],cacheDecorator:["map","action"],init:[],registerFactory:["token","value","singleton"],createCustomFactory:["key","factory","singleton"],bindTypeFactory:["key","ClassT","singleton"]}},e}();t.Container=r});t(Pt);Pt.Container;var At=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleLoaderToken=new pe.InjectToken("__IOC_ModuleLoader")});t(At);At.ModuleLoaderToken;var Ct=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getLoader=function(){return this._loader||(this._loader=this.createLoader()),this._loader},e.prototype.load=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.length?Promise.all(e.map(function(e){return ce.isString(e)?t.isFile(e)?t.loadFile(e):t.loadModule(e):ce.isObject(e)&&(e.modules||e.files)?t.loadPathModule(e):e?[e]:[]})).then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e)}),t}):Promise.resolve([])},e.prototype.loadTypes=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return f.__awaiter(this,void 0,void 0,function(){var t;return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.load.apply(this,r)];case 1:return t=e.sent(),[2,this.getTypes.apply(this,t)]}})})},e.prototype.getTypes=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=[];return e.forEach(function(e){var t=n.getContentTypes(e),r=t.find(function(e){return gt.hasOwnClassMetadata(gt.IocExt,e)});r?o.push(r):o.push.apply(o,t)}),o},e.prototype.loadFile=function(e,t){var r=this.getLoader();return(ce.isArray(e)?Promise.all(e.map(function(e){return r(e)})).then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e)}),t}):r(e)).then(function(e){return e.filter(function(e){return!!e})})},e.prototype.isFile=function(e){return e&&/\/((\w|%|\.))+\.\w+$/.test(e.replace(/\\\\/gi,"/"))},e.prototype.loadModule=function(e){return this.getLoader()(e).then(function(e){return e.filter(function(e){return!!e})})},e.prototype.loadPathModule=function(n){return f.__awaiter(this,void 0,void 0,function(){var t,r=this;return f.__generator(this,function(e){switch(e.label){case 0:return this.getLoader(),t=[],n.files?[4,this.loadFile(n.files,n.basePath).then(function(e){return e.forEach(function(e){t=t.concat(e)}),t})]:[3,2];case 1:e.sent(),e.label=2;case 2:return n.modules?[4,Promise.all(n.modules.map(function(e){return ce.isString(e)?r.loadModule(e):e})).then(function(e){return t=t.concat(e)})]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2,t]}})})},e.prototype.createLoader=function(){if(void 0!==n)return function(e){return new Promise(function(e,t){n()})};throw new Error("has not module loader")},e.prototype.getContentTypes=function(e){var t=[];if(ce.isClass(e))t.push(e);else{var r=e.exports?e.exports:e;for(var n in r)ce.isClass(r[n])&&t.push(r[n])}return t},e.classAnnations={name:"DefaultModuleLoader",params:{constructor:[],getLoader:[],load:["modules"],loadTypes:["modules"],getTypes:["modules"],loadFile:["files","basePath"],isFile:["str"],loadModule:["moduleName"],loadPathModule:["pmd"],createLoader:[],getContentTypes:["regModule"]}},e}();t.DefaultModuleLoader=r});t(Ct);Ct.DefaultModuleLoader;var Tt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._loader=e}return Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader||(this._loader=new Ct.DefaultModuleLoader),this._loader},enumerable:!0,configurable:!0}),e.prototype.create=function(){var e=this,t=new Pt.Container;return t.bindProvider(mt.ContainerBuilderToken,function(){return e}),t.bindProvider(At.ModuleLoaderToken,function(){return e.loader}),t},e.prototype.build=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return f.__awaiter(this,void 0,void 0,function(){var t;return f.__generator(this,function(e){switch(e.label){case 0:return t=this.create(),r.length?[4,this.loadModule.apply(this,[t].concat(r))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,t]}})})},e.prototype.loadModule=function(n){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return f.__awaiter(this,void 0,void 0,function(){var t,r;return f.__generator(this,function(e){switch(e.label){case 0:return[4,(r=this.loader).loadTypes.apply(r,o)];case 1:return t=e.sent(),[2,this.registers(n,t)]}})})},e.prototype.syncBuild=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.create();return e.length&&this.syncLoadModule.apply(this,[r].concat(e)),r},e.prototype.syncLoadModule=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,o=(n=this.loader).getTypes.apply(n,t);return this.registers(e,o)},e.prototype.registers=function(t,e){return(e=e||[]).forEach(function(e){t.register(e)}),e},e.classAnnations={name:"DefaultContainerBuilder",params:{constructor:["loader"],create:[],build:["modules"],loadModule:["container","modules"],syncBuild:["modules"],syncLoadModule:["container","modules"],registers:["container","types"]}},e}();t.DefaultContainerBuilder=r});t(Tt);Tt.DefaultContainerBuilder;var Ot=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AppConfigurationToken=new pe.InjectToken("__IOC_AppConfiguration")});t(Ot);Ot.AppConfigurationToken;var kt=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.baseURL=e,this.usedModules=[],this.customs=[]}return e.prototype.useContainer=function(e){return e&&(this.container=Promise.resolve(e)),this},e.prototype.useContainerBuilder=function(e){return this.builder=e,this},e.prototype.useConfiguration=function(e){var t;this.configuration||(this.configuration=Promise.resolve(this.getDefaultConfig()));var r=this.getContainerBuilder();return ce.isString(e)?t=r.loader.load(e).then(function(e){return e.length?e[0]:null}):e&&(t=Promise.resolve(e)),t&&(this.configuration=this.configuration.then(function(r){return t.then(function(e){var t=e.default?e.default:e;return r=ce.lang.assign(r||{},t||{})})})),this},e.prototype.useModules=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach(function(e){ce.isFunction(e)&&!ce.isClass(e)?t.customs.push(e):t.usedModules.push(e)}),this},e.prototype.bootstrap=function(o){return f.__awaiter(this,void 0,void 0,function(){var t,r,n;return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.getContainer()];case 1:return t=e.sent(),r=this.getModuleBuilder(t),[4,this.getConfiguration(this.getModuleConfigure(r,o))];case 2:return n=e.sent(),[4,this.initContainer(n,t)];case 3:return e.sent(),n.bootstrap=n.bootstrap||o,[4,r.build(n)];case 4:return[2,e.sent()]}})})},e.prototype.getModuleBuilder=function(e){return this._moduleBuilder||(this._moduleBuilder=e.get(bt.ModuleBuilderToken)),this._moduleBuilder},e.prototype.getModuleConfigure=function(e,t){return e.getConfigure(t)},e.prototype.setConfigRoot=function(e){this.baseURL&&(e.baseURL=this.baseURL)},e.prototype.initContainer=function(o,a){return f.__awaiter(this,void 0,void 0,function(){var t,r,n=this;return f.__generator(this,function(e){switch(e.label){case 0:return this.setConfigRoot(o),this.usedModules.length?(t=this.usedModules,this.usedModules=[],[4,a.loadModule.apply(a,[a].concat(t))]):[3,2];case 1:e.sent(),e.label=2;case 2:return a.bindProvider(Ot.AppConfigurationToken,o),this.customs.length?(r=this.customs,this.customs=[],[4,Promise.all(r.map(function(e){return e(a,o,n)}))]):[3,4];case 3:e.sent(),e.label=4;case 4:return[2,a]}})})},e.prototype.getContainerBuilder=function(){return this.builder||(this.builder=new Tt.DefaultContainerBuilder),this.builder},e.prototype.getContainer=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.container||(this.container=(e=this.getContainerBuilder()).build.apply(e,t)),this.container},e.prototype.getConfiguration=function(t){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return this.configuration?ce.lang.hasField(t)&&this.useConfiguration(t):this.useConfiguration(t),[4,this.configuration];case 1:return[2,e.sent()]}})})},e.prototype.getDefaultConfig=function(){return{debug:!1}},e.classAnnations={name:"ApplicationBuilder",params:{constructor:["baseURL"],useContainer:["container"],useContainerBuilder:["builder"],useConfiguration:["config"],useModules:["modules"],bootstrap:["bootModule"],getModuleBuilder:["container"],getModuleConfigure:["builer","boot"],setConfigRoot:["config"],initContainer:["config","container"],getContainerBuilder:[],getContainer:["modules"],getConfiguration:["cfg"],getDefaultConfig:[]}},e}();t.ApplicationBuilder=r});t(kt);kt.ApplicationBuilder;return t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),f.__exportStar(le,t),f.__exportStar(Pt,t),f.__exportStar(fe,t),f.__exportStar(ue,t),f.__exportStar(pe,t),f.__exportStar(mt,t),f.__exportStar(de,t),f.__exportStar(Ue,t),f.__exportStar(vt,t),f.__exportStar(At,t),f.__exportStar(Ct,t),f.__exportStar(Tt,t),f.__exportStar(ce,t),f.__exportStar(ve,t),f.__exportStar(gt,t),f.__exportStar(bt,t),f.__exportStar(_t,t),f.__exportStar(Ot,t),f.__exportStar(kt,t)}))});