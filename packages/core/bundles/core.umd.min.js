!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("reflect-metadata")):"function"==typeof define&&define.amd?define(["reflect-metadata"],t):(e.core=e.core||{},e.core.umd=e.core.umd||{},e.core.umd.js=t(e.Reflect))}(this,function(e){"use strict";function t(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}e=e&&e.hasOwnProperty("default")?e.default:e;var o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a=o&&o.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=(o&&o.__decorate,o&&o.__metadata,o&&o.__param,n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.design="design",e.runtime="runtime"}(t.IocState||(t.IocState={}));!function(e){e[e.route=1]="route",e[e.children=2]="children",e[e.traverse=3]="traverse",e[e.traverseLast=4]="traverseLast"}(t.Mode||(t.Mode={}))}));r(i);var s=n(function(e,t){function r(e){return!!e&&"function"==typeof e}function n(e){if(!r(e))return!1;if(e.prototype){if(!e.name||"Object"===e.name)return!1;if(Reflect.hasOwnMetadata("@Abstract",e))return!1;var t=e;if(/^[a-z]$/.test(t.name))return!(!t.classAnnations||!t.classAnnations.name);if(t.classAnnations&&s(t.classAnnations.name))return!0;if(!/^[A-Z@]/.test(e.name))return!1;if(!o()&&/MSIE [6-9]/.test(navigator.userAgent))return!0;try{return e.arguments&&e.caller,!1}catch(e){return!0}}return!1}function o(){return"undefined"!=typeof process&&void 0!==process.versions.node}function a(e){return!!e&&!!(s(e)||u(e)||n(e)||c(e)&&e instanceof f.Registration)}function i(e,t,r){return!!e&&(!a(e)&&(!(e instanceof RegExp||e instanceof Date)&&((!e.constructor||"Object"===e.constructor.name)&&(t=t||["type"],r&&(t=r.concat(t)),Object.keys(e).some(function(e){return t.indexOf(e)>0})))))}function s(e){return"string"==typeof e}function c(e){var t=typeof e;return null!=e&&("object"===t||"function"===t)}function u(e){return"symbol"==typeof e||c(e)&&/^Symbol\(/.test(e.toString())}Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=r,t.isAbstractDecoratorClass=function(e){return!!r(e)&&!!Reflect.hasOwnMetadata("@Abstract",e)},t.getClassName=function(e){return r(e)?/^[a-z]$/.test(e.name)&&e.classAnnations?e.classAnnations.name:e.name:""},t.isClass=n,t.isNodejsEnv=o,t.isToken=a,t.isPromise=function(e){return!!e&&!(!r(e.then)||!r(e.catch))},t.isObservable=function(e){return!(!e&&!c(e)||!r(e.subscribe)||!r(e.toPromise))},t.isBaseObject=function(e){return!!e&&!(!e.constructor||"Object"!==e.constructor.name)},t.isMetadataObject=i,t.isClassMetadata=function(e,t){return i(e,["singleton","provide","alias","type"],t)},t.isParamMetadata=function(e,t){return i(e,["type","provider","index"],t)},t.isParamPropMetadata=function(e,t){return i(e,["type","provider","index"],t)},t.isPropertyMetadata=function(e,t){return i(e,["type","provider"],t)},t.isString=s,t.isBoolean=function(e){return"boolean"==typeof e||!0===e||!1===e},t.isNumber=function(e){return"number"==typeof e},t.isUndefined=function(e){return void 0===e||void 0===e},t.isNull=function(e){return null===e},t.isArray=function(e){return Array.isArray(e)},t.isObject=c,t.isDate=function(e){return c(e)&&e instanceof Date},t.isSymbol=u,t.isRegExp=function(e){return e&&e instanceof RegExp}});r(s);var c=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.valueMap={},this.keyMap={}}return e.prototype.clear=function(){this.valueMap={},this.keyMap={}},e.prototype.getTypeKey=function(e){return s.isString(e)?e:s.isFunction(e)?e.name:e.toString()},e.prototype.delete=function(e){var t=this.getTypeKey(e).toString();try{return delete this.keyMap[t],delete this.valueMap[t],!0}catch(e){return!1}},e.prototype.forEach=function(e,t){var r=this;Object.keys(this.keyMap).forEach(function(t){e(r.valueMap[t],r.keyMap[t],r)})},e.prototype.get=function(e){var t=this.getTypeKey(e);return this.valueMap[t]},e.prototype.has=function(e){var t=this.getTypeKey(e);return!s.isUndefined(this.keyMap[t])},e.prototype.set=function(e,t){var r=this.getTypeKey(e);return this.keyMap[r]=e,this.valueMap[r]=t,this},Object.defineProperty(e.prototype,"size",{get:function(){return Object.keys(this.keyMap).length},enumerable:!0,configurable:!0}),e.classAnnations={name:"ObjectMapSet",params:{constructor:[],clear:[],getTypeKey:["key"],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},e}();t.ObjectMapSet=r;var n=function(){function e(){this.map=s.isClass(Map)?new Map:new r}return e.prototype.clear=function(){this.map.clear()},e.prototype.delete=function(e){return this.map.delete(e)},e.prototype.forEach=function(e,t){this.map.forEach(e,t)},e.prototype.get=function(e){return this.map.get(e)},e.prototype.has=function(e){return this.map.has(e)},e.prototype.set=function(e,t){return this.map.set(e,t),this},Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),e.classAnnations={name:"MapSet",params:{constructor:[],clear:[],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},e}();t.MapSet=n});r(c);var u=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.symbols={IContainer:Symbol("IContainer"),LifeScope:Symbol("LifeScope"),IProviderMatcher:Symbol("IProviderMatcher"),IMethodAccessor:Symbol("IMethodAccessor"),ICacheManager:Symbol("ICacheManager"),IContainerBuilder:Symbol("IContainerBuilder"),IRecognizer:Symbol("IRecognizer")}});r(u);var p=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(s),r(c),r(u)});r(p);var f=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.classType=e,this.desc=t,this.type="Registration"}return e.prototype.getClass=function(){return p.isClass(this.classType)?this.classType:null},e.prototype.getDesc=function(){return this.desc},e.prototype.toString=function(){var e="";return e=p.isFunction(this.classType)?p.getClassName(this.classType):this.classType.toString(),this.type+" "+e+" "+this.desc},e.classAnnations={name:"Registration",params:{constructor:["classType","desc"],getClass:[],getDesc:[],toString:[]}},e}();t.Registration=r});r(f);var l=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.args=e,this.idx=-1,this.metadata=null}return e.prototype.isCompeted=function(){return this.idx>=this.args.length},e.prototype.end=function(){this.idx=this.args.length},e.prototype.next=function(e){if(this.isCompeted())return null;if(this.idx++,this.isCompeted())return null;var t=this.args[this.idx];e.isMetadata&&e.isMetadata(t)?(this.metadata=t,this.end()):e.match(t)?(this.metadata=this.metadata||{},e.setMetadata(this.metadata,t)):this.end()},e.prototype.getArgs=function(){return this.args},e.prototype.getMetadata=function(){return this.metadata},e.classAnnations={name:"ArgsIterator",params:{constructor:["args"],isCompeted:[],end:[],next:["express"],getArgs:[],getMetadata:[]}},e}();t.ArgsIterator=r});r(l);var d=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Class=1]="Class",e[e.Parameter=2]="Parameter",e[e.Property=4]="Property",e[e.Method=8]="Method",e[e.All=13]="All"}(t.DecoratorType||(t.DecoratorType={}))});r(d);var h=n(function(e,t){function r(e,t,r){var o="@"+e,a=function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var s=null;return a.length<1?function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n(e,o,t,s,r)}:(s=function(e,t){var r=null;if(e.length)if(1===e.length&&p.isMetadataObject(e[0]))r=e[0];else if(t){var n=new l.ArgsIterator(e);t(n),r=n.getMetadata()}return r}(a,t))?function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n(e,o,t,s,r)}:1!==a.length||p.isClass(a[0])?n(e,o,a,s,r):function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n(e,o,t,s,r)}};return a.toString=function(){return o},a.decoratorType=d.DecoratorType.All,a}function n(e,t,r,n,i){var s;switch(r.length){case 1:if(s=r[0],p.isClass(s)||p.isAbstractDecoratorClass(s))return function(e,t,r,n,a){var i=o(t,r).slice(0),s=n||{};s.type||(s.type=r);s.decorator=e,a&&(s=a(s));i.unshift(s),h(r),Reflect.defineMetadata(t,i,r)}(e,t,s,n,i),s;break;case 2:c(e,t,s=r[0],r[1],n,i);break;case 3:if(p.isNumber(r[2])){!function(e,t,r,n,o,a,i){var s=u(t,r,n).slice(0);for(;s.length<=o;)s.push(null);s[o]=s[o]||[];var c=a||{};if(!c.type){var p=Reflect.getOwnMetadata("design:type",r,n);p||(p=Reflect.getOwnMetadata("design:type",r.constructor,n)),c.type=p}c.propertyKey=n,c.decorator=e,c.index=o,i&&(c=i(c));s[o].unshift(c),Reflect.defineMetadata(t+m,s,r,n)}(e,t,s=r[0],r[1],r[2],n,i)}else{if(!p.isUndefined(r[2])){s=r[0];var f=r[1],l=r[2];return function(e,t,r,n,o,i,s){var c=Object.assign({},a(t,r));c[n]=c[n]||[];var u=i||{};u.decorator=e,u.propertyKey=n,s&&(u=s(u));c[n].unshift(u),Reflect.defineMetadata(t+v,c,r.constructor)}(e,t,s,f,0,n,i),l}c(e,t,s=r[0],r[1],n,i)}break;default:throw new Error("Invalid @"+e+" Decorator declaration.")}}function o(e,t){var r=Reflect.getOwnMetadata(p.isFunction(e)?e.toString():e,t);return r=p.isArray(r)?r:[]}function a(e,t){var r=p.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+v,t);return(!n||p.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getMetadata(r+v,t.constructor)),p.isArray(n)?{}:n||{}}function i(e,t){var r=p.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+v,t);return(!n||p.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getOwnMetadata(r+v,t.constructor)),p.isArray(n)?{}:n||{}}function s(e,t){var r=p.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+g,t);return(!n||p.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getMetadata(r+g,t.constructor)),p.isArray(n)?{}:n||{}}function c(e,t,r,n,o,a){var i=Object.assign({},s(t,r)),c=o||{};if(c.propertyKey=n,c.decorator=e,!c.type){var u=Reflect.getMetadata("design:type",r,n);u||(u=Reflect.getMetadata("design:type",r.constructor,n)),c.type=u}a&&(c=a(c)),i[n]&&p.isArray(i[n])||(i[n]=[]),i[n].unshift(c),Reflect.defineMetadata(t+g,i,r.constructor)}function u(e,t,r){var n=p.isFunction(e)?e.toString():e,o=Reflect.getOwnMetadata(n+m,t,r);return o=p.isArray(o)?o:[]}function f(e){var r=Reflect.getMetadata(t.ParamerterName,e);return(!r||p.isArray(r)||Object.keys(r).length<0)&&(r=Reflect.getMetadata(t.ParamerterName,e.constructor)),p.isArray(r)?{}:r||{}}function h(e){var r=Object.assign({},f(e)),n=Object.getOwnPropertyDescriptors(e.prototype),o=/^[a-z]/.test(e.name),a="";e.classAnnations&&e.classAnnations.params&&(a=e.classAnnations.name,r=Object.assign(r,e.classAnnations.params)),o||e.name===a||(Object.keys(n).forEach(function(e){"constructor"!==e&&(n[e].value&&(r[e]=y(n[e].value)),n[e].set&&(r[e]=y(n[e].set)))}),r.constructor=y(e.prototype.constructor)),Reflect.defineMetadata(t.ParamerterName,r,e)}function y(e){if(!p.isFunction(e))return[];var t=e.toString().replace(M,""),r=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(P);return null===r&&(r=[]),r}Object.defineProperty(t,"__esModule",{value:!0}),t.ParamerterName="paramerter_names",t.createDecorator=r,t.getTypeMetadata=function(e,t){var r=Reflect.getOwnMetadata(p.isFunction(e)?e.toString():e,t);return r=p.isArray(r)?r:[]},t.getOwnTypeMetadata=o,t.hasClassMetadata=function(e,t){var r=p.isFunction(e)?e.toString():e;return Reflect.hasMetadata(r,t)},t.hasOwnClassMetadata=function(e,t){var r=p.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(r,t)};var v="__method";t.getMethodMetadata=a,t.getOwnMethodMetadata=i,t.hasOwnMethodMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e;if(r){var o=i(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasOwnMetadata(n+v,t)},t.hasMethodMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e;if(r){var o=a(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+v,t)};var g="__props";t.getPropertyMetadata=s,t.getOwnPropertyMetadata=function(e,t){var r=p.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+g,t);return(!n||p.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getOwnMetadata(r+g,t.constructor)),p.isArray(n)?{}:n||{}},t.hasPropertyMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e;if(r){var o=s(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+g,t)};var m="__params";t.getParamMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e,o=Reflect.getMetadata(n+m,t,r);return o=p.isArray(o)?o:[]},t.getOwnParamMetadata=u,t.hasParamMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e;return Reflect.hasMetadata(n+m,t,r)},t.hasOwnParamMetadata=function(e,t,r){var n=p.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(n+m,t,r)},t.getParamerterNames=f,t.getOwnParamerterNames=function(e){var r=Reflect.getOwnMetadata(t.ParamerterName,e);return(!r||p.isArray(r)||Object.keys(r).length<0)&&(r=Reflect.getOwnMetadata(t.ParamerterName,e.constructor)),p.isArray(r)?{}:r||{}},t.setParamerterNames=h;var M=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,P=/([^\s,]+)/g});r(h);var y=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassDecorator=function(e,t,r){var n=h.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return p.isClassMetadata(e)},match:function(e){return e&&(p.isSymbol(e)||p.isString(e)||p.isObject(e)&&e instanceof f.Registration)},setMetadata:function(e,t){e.provide=t}}),e.next({match:function(e){return p.isString(e)},setMetadata:function(e,t){e.alias=t}}),e.next({match:function(e){return p.isBoolean(e)},setMetadata:function(e,t){e.singleton=t}}),e.next({match:function(e){return p.isNumber(e)},setMetadata:function(e,t){e.expires=t}})},r);return n.decoratorType=d.DecoratorType.Class,n}});r(y);var v=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodDecorator=function(e,t,r){var n=h.createDecorator(e,function(e){t&&t(e),e.next({match:function(e){return p.isArray(e)},setMetadata:function(e,t){e.providers=t}})},r);return n.decoratorType=d.DecoratorType.Method,n}});r(v);var g=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamDecorator=function(e,t,r){var n=h.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return p.isParamMetadata(e)},match:function(e){return p.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=d.DecoratorType.Parameter,n}});r(g);var m=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createPropDecorator=function(e,t,r){var n=h.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return p.isPropertyMetadata(e)},match:function(e){return p.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=d.DecoratorType.Property,n}});r(m);var M=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamPropDecorator=function(e,t,r){var n=h.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return p.isParamPropMetadata(e)},match:function(e){return p.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=d.DecoratorType.Property|d.DecoratorType.Parameter,n}});r(M);var P=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassMethodDecorator=function(e,t,r){var n=h.createDecorator(e,t,r);return n.decoratorType=d.DecoratorType.Class|d.DecoratorType.Method,n}});r(P);var A=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropDecorator=function(e,t,r){var n=h.createDecorator(e,t,r);return n.decoratorType=d.DecoratorType.Method|d.DecoratorType.Property,n}});r(A);var b=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropParamDecorator=function(e,t,r){var n=h.createDecorator(e,t,r);return n.decoratorType=d.DecoratorType.Method|d.DecoratorType.Property|d.DecoratorType.Parameter,n}});r(b);var C=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(l),r(d),r(h),r(y),r(v),r(g),r(m),r(M),r(P),r(A),r(b)});r(C);var T=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Component=C.createClassDecorator("Component")});r(T);var k=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Injectable=C.createClassDecorator("Injectable")});r(k);var w=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Inject=C.createParamPropDecorator("Inject")});r(w);var O=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AutoWired=C.createParamPropDecorator("AutoWired")});r(O);var _=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Param=C.createParamDecorator("Param")});r(_);var D=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Method=C.createMethodDecorator("Method")});r(D);var x=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Singleton=C.createClassDecorator("Singleton",null,function(e){return e.singleton=!0,e})});r(x);var S=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Abstract=C.createClassDecorator("Abstract")});r(S);var I=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Autorun=C.createClassMethodDecorator("Autorun",function(e){e.next({isMetadata:function(e){return p.isClassMetadata(e,["autorun"])},match:function(e){return p.isString(e)},setMetadata:function(e,t){e.autorun=t}})})});r(I);var j=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IocModule=C.createClassDecorator("IocModule",function(e){e.next({isMetadata:function(e){return p.isClassMetadata(e,["autorun"])},match:function(e){return p.isString(e)},setMetadata:function(e,t){e.autorun=t}})})});r(j);var R=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(T),r(k),r(w),r(O),r(_),r(D),r(x),r(S),r(I),r(j)});r(R);var N=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.isEmpty=function(){return!0},e.prototype.add=function(e){return this},e.prototype.remove=function(e){return this},e.prototype.find=function(e,r){return t.NullNode},e.prototype.filter=function(e,t){return[]},e.prototype.each=function(e,t){},e.prototype.trans=function(e){},e.prototype.transAfter=function(e){},e.prototype.routeUp=function(e){},e.prototype.equals=function(e){return e===t.NullNode},e.prototype.empty=function(){return t.NullNode},e.classAnnations={name:"NullComponent",params:{isEmpty:[],add:["action"],remove:["action"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],trans:["express"],transAfter:["express"],routeUp:["express"],equals:["node"],empty:[]}},e}();t.NullComponent=r,t.NullNode=new r});r(N);var E=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.name=e,this.children=[]}return e.prototype.add=function(e){return e.parent=this,this.children.push(e),this},e.prototype.remove=function(e){var t;return(t=p.isString(e)?this.find(function(t){return p.isString(e)?t.name===e:t.equals(e)}):e||this).parent?this.equals(t.parent)?(this.children.splice(this.children.indexOf(t),1),t.parent=null,this):(t.parent.remove(t),this):this},e.prototype.find=function(e,t){var r;return this.each(function(t){if(r)return!1;return!(p.isFunction(e)?e(t):e===t)||(r=t,!1)},t),r||this.empty()},e.prototype.filter=function(e,t){var r=[];return this.each(function(t){e(t)&&r.push(t)},t),r},e.prototype.each=function(e,t){var r;switch(t=t||i.Mode.traverse){case i.Mode.route:r=this.routeUp(e);break;case i.Mode.children:r=this.eachChildren(e);break;case i.Mode.traverse:r=this.trans(e);break;case i.Mode.traverseLast:r=this.transAfter(e);break;default:r=this.trans(e)}return r},e.prototype.eachChildren=function(e){(this.children||[]).forEach(function(t){return e(t)})},e.prototype.routeUp=function(e){return!1!==e(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(e):void 0)},e.prototype.trans=function(e){if(!1===e(this))return!1;for(var t=this.children||[],r=0;r<t.length;r++){var n=t[r].trans(e);if(!1===n)return n}return!0},e.prototype.transAfter=function(e){for(var t=this.children||[],r=0;r<t.length;r++){if(!1===t[r].transAfter(e))return!1}return!1!==e(this)},e.prototype.equals=function(e){return this===e},e.prototype.empty=function(){return N.NullNode},e.prototype.isEmpty=function(){return this.equals(this.empty())},e.classAnnations={name:"Composite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],eachChildren:["express"],routeUp:["express"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},e}();t.Composite=r});r(E);var F=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.name=e,this.children=[]}return e.prototype.add=function(e){return e.parent=this,this.children.push(e),this},e.prototype.remove=function(e){var t;return(t=p.isString(e)?this.find(function(t){return p.isString(e)?t.name===e:t.equals(e)}):e||this).parent?this.equals(t.parent)?(this.children.splice(this.children.indexOf(t),1),t.parent=null,this):(t.parent.remove(t),null):this},e.prototype.find=function(e,t){var r;return this.each(function(t){if(r)return!1;return!(p.isFunction(e)?e(t):e===t)||(r=t,!1)},t),r||this.empty()},e.prototype.filter=function(e,t){var r=[];return this.each(function(t){e(t)&&r.push(t)},t),r},e.prototype.each=function(e,t){var r;switch(t=t||i.Mode.traverse){case i.Mode.route:r=this.routeUp(e);break;case i.Mode.children:r=this.eachChildren(e);break;case i.Mode.traverse:r=this.trans(e);break;case i.Mode.traverseLast:r=this.transAfter(e);break;default:r=this.trans(e)}return r},e.prototype.eachChildren=function(e){(this.children||[]).forEach(function(t){return e(t)})},e.prototype.routeUp=function(e){return!1!==e(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(e):void 0)},e.prototype.trans=function(e){if(!1===e(this))return!1;for(var t=this.children||[],r=0;r<t.length;r++){var n=t[r].trans(e);if(!1===n)return n}return!0},e.prototype.transAfter=function(e){for(var t=this.children||[],r=0;r<t.length;r++){if(!1===t[r].transAfter(e))return!1}return!1!==e(this)},e.prototype.equals=function(e){return this===e},e.prototype.empty=function(){return N.NullNode},e.prototype.isEmpty=function(){return this.equals(this.empty())},e.classAnnations={name:"GComposite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["iterate","mode"],eachChildren:["iterate"],routeUp:["iterate"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},e}();t.GComposite=r});r(F);var L=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(E),r(F),r(N)});r(L);var K=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return a(r,e),r.prototype.insert=function(e,t){return this},r.prototype.execute=function(e,t,r){},r.prototype.empty=function(){return t.NullAction},r.classAnnations={name:"NullActionClass",params:{insert:["action","index"],execute:["container","data","name"],empty:[]}},r}(L.NullComponent);t.NullAction=new r});r(K);var B=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var r=e.call(this,t)||this;return r.children=[],r}return a(t,e),t.prototype.insert=function(e,t){return e.parent=this,t<0?t=0:t>=this.children.length&&(t=this.children.length-1),this.children.splice(t,0,e),this},t.prototype.execute=function(e,r,n){n?this.find(function(e){return e.name===n}).execute(e,r):this.trans(function(n){n instanceof t&&n.working(e,r)})},t.prototype.empty=function(){return K.NullAction},t.prototype.working=function(e,t){},t.classAnnations={name:"ActionComposite",params:{constructor:["name"],insert:["node","index"],execute:["container","data","name"],empty:[],working:["container","data"]}},t}(L.GComposite);t.ActionComposite=r});r(B);var U=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.beforeCreateArgs="beforeCreateArgs",e.beforeConstructor="beforeConstructor",e.afterConstructor="afterConstructor",e.onInit="onInit",e.AfterInit="AfterInit"}(t.LifeState||(t.LifeState={}))});r(U);var q=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.bindParameterType="bindParameterType",e.bindPropertyType="bindPropertyType",e.injectProperty="injectProperty",e.bindProvider="bindProvider",e.bindParameterProviders="bindParameterProviders",e.cache="cache",e.componentBeforeInit="componentBeforeInit",e.componentInit="componentInit",e.componentAfterInit="componentAfterInit",e.singletion="singletion",e.autorun="autorun"}(t.CoreActions||(t.CoreActions={}))});r(q);var V=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.bindProvider)||this}return a(t,e),t.prototype.working=function(e,t){var r=t.targetType,n=[];e.getLifeScope().getClassDecorators(function(e){return e.actions.includes(q.CoreActions.bindProvider)&&C.hasOwnClassMetadata(e.name,r)}).forEach(function(t){var o=C.getOwnTypeMetadata(t.name,r);if(Array.isArray(o)&&o.length>0){var a=o.find(function(e){return e&&!!e.provide});if(a){var i=e.getTokenKey(a.provide,a.alias);n.push(i),e.bindProvider(i,a.type)}}}),t.execResult=n},t.classAnnations={name:"BindProviderAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.BindProviderAction=r});r(V);var z=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.bindParameterType)||this}return a(t,e),t.prototype.working=function(e,t){var r,n=t.target,o=t.targetType,a=t.propertyKey,i=e.getLifeScope();r=n&&a?Reflect.getMetadata("design:paramtypes",n,a)||[]:Reflect.getMetadata("design:paramtypes",o)||[],(r=r.slice(0)).forEach(function(t){i.isVaildDependence(t)&&(e.has(t)||e.register(t))});i.getParameterDecorators(function(e){return e.actions.includes(q.CoreActions.bindParameterType)&&(n||"constructor"!==a?C.hasParamMetadata(e.name,n,a):C.hasOwnParamMetadata(e.name,o))}).forEach(function(t){var s=n||"constructor"!==a?C.getParamMetadata(t.name,n,a):C.getOwnParamMetadata(t.name,o);p.isArray(s)&&s.length&&s.forEach(function(t){var n=p.isArray(t)&&t.length>0?t[0]:null;if(n&&n.index>=0){i.isVaildDependence(n.provider)&&(e.has(n.provider,n.alias)||e.register(e.getToken(n.provider,n.alias))),i.isVaildDependence(n.type)&&(e.has(n.type)||e.register(n.type));var o=n.provider?e.getTokenKey(n.provider,n.alias):n.type;o&&(r[n.index]=o)}})}),t.execResult=r},t.classAnnations={name:"BindParameterTypeAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.BindParameterTypeAction=r});r(z);var G=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.bindPropertyType)||this}return a(t,e),t.prototype.working=function(e,t){var r=t.targetType,n=e.getLifeScope(),o=[];n.getPropertyDecorators(function(e){return e.actions.includes(q.CoreActions.bindPropertyType)&&C.hasPropertyMetadata(e.name,r)}).forEach(function(t){var a=C.getPropertyMetadata(t.name,r);for(var i in a)o=o.concat(a[i]);(o=o.filter(function(e){return!!e})).forEach(function(t){n.isVaildDependence(t.provider)&&(e.has(t.provider,t.alias)||e.register(e.getToken(t.provider,t.alias))),n.isVaildDependence(t.type)&&(e.has(t.type)||e.register(t.type))})}),t.execResult=o},t.classAnnations={name:"BindPropertyTypeAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.BindPropertyTypeAction=r});r(G);var W=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.injectProperty)||this}return a(t,e),t.prototype.working=function(e,t){t.execResult||this.parent.find(function(e){return e.name===q.CoreActions.bindPropertyType}).execute(e,t),t.target&&t.execResult&&t.execResult.length&&t.execResult.forEach(function(r,n){if(r){var o=r.provider?e.getToken(r.provider,r.alias):r.type;e.has(o)&&(t.target[r.propertyKey]=e.resolve.apply(e,[o].concat(t.providers||[])))}})},t.classAnnations={name:"InjectPropertyAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.InjectPropertyAction=r});r(W);var $=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.bindParameterProviders)||this}return a(t,e),t.prototype.working=function(e,t){var r=t.targetType,n=t.propertyKey,o=[];e.getLifeScope().getMethodDecorators(function(e){return e.actions.includes(q.CoreActions.bindParameterProviders)&&C.hasOwnMethodMetadata(e.name,r)}).forEach(function(e){var t=C.getOwnMethodMetadata(e.name,r)[n];t&&p.isArray(t)&&t.length>0&&t.forEach(function(e){e.providers&&e.providers.length>0&&(o=o.concat(e.providers))})}),t.execResult=o},t.classAnnations={name:"BindParameterProviderAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.BindParameterProviderAction=r});r($);var Z=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.componentBeforeInit)||this}return a(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;p.isFunction(r.beforeInit)&&e.syncInvoke(t.targetType,"beforeInit",t.target)}},t.classAnnations={name:"ComponentBeforeInitAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.ComponentBeforeInitAction=r});r(Z);var H=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.componentInit)||this}return a(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;p.isFunction(r.onInit)&&e.syncInvoke(t.targetType,"onInit",t.target)}},t.classAnnations={name:"ComponentInitAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.ComponentInitAction=r});r(H);var J=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.componentAfterInit)||this}return a(t,e),t.prototype.working=function(e,t){if(t.targetType&&t.target){var r=t.target;p.isFunction(r.afterInit)&&e.syncInvoke(t.targetType,"afterInit",t.target)}},t.classAnnations={name:"ComponentAfterInitAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.ComponentAfterInitAction=r});r(J);var Q=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.cache)||this}return a(t,e),t.prototype.working=function(e,t){if(t.singleton||!t.targetType||!p.isClass(t.targetType))return t;var r=e.get(p.symbols.ICacheManager);if(t.target){if(!r.hasCache(t.targetType)){(o=this.getCacheMetadata(e,t))&&r.cache(t.targetType,t.target,o.expires)}}else{var n=r.get(t.targetType);if(n){var o=this.getCacheMetadata(e,t);o&&(r.cache(t.targetType,n,o.expires),t.execResult=n)}}return t},t.prototype.getCacheMetadata=function(e,t){for(var r,n=e.getLifeScope().getClassDecorators(function(e){return C.hasOwnClassMetadata(e.name,t.targetType)}),o=0;o<n.length;o++){var a=n[o],i=C.getOwnTypeMetadata(a.name,t.targetType);if(Array.isArray(i)&&i.length>0&&(r=i.find(function(e){return e&&p.isNumber(e.expires)&&e.expires>0})))break}return r},t.classAnnations={name:"CacheAction",params:{constructor:[],working:["container","data"],getCacheMetadata:["container","data"]}},t}(B.ActionComposite);t.CacheAction=r});r(Q);var X=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.singletion)||this}return a(t,e),t.prototype.working=function(e,t){t.tokenKey&&t.target&&t.singleton&&e.registerValue(t.tokenKey,t.target)},t.classAnnations={name:"SingletionAction",params:{constructor:[],working:["container","data"]}},t}(B.ActionComposite);t.SingletionAction=r});r(X);var Y=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,q.CoreActions.autorun)||this}return a(t,e),t.prototype.getDecorator=function(){return[R.IocModule,R.Autorun]},t.prototype.working=function(e,t){if(t.tokenKey&&t.targetType){this.getDecorator().forEach(function(r){if(C.hasClassMetadata(r,t.targetType)){var n=C.getTypeMetadata(r,t.targetType),o=n.find(function(e){return!!e.autorun});if(!o&&n.length&&(o=n[0]),o){var a=e.get(t.tokenKey);a&&o.autorun&&p.isFunction(a[o.autorun])&&e.syncInvoke(t.tokenKey,o.autorun,a)}}else if(C.hasMethodMetadata(r,t.targetType)){var i,s=C.getMethodMetadata(r,t.targetType);Object.keys(s).forEach(function(e){var t=s[e];t&&!i&&(i=t.find(function(e){return!!e.autorun}))}),i&&i.autorun&&e.syncInvoke(t.tokenKey,i.autorun)}})}},t.classAnnations={name:"AutorunAction",params:{constructor:[],getDecorator:[],working:["container","data"]}},t}(B.ActionComposite);t.AutorunAction=r});r(Y);var ee=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(B),r(U),r(q),r(K),r(V),r(z),r(G),r(W),r($),r(Z),r(H),r(J),r(Q),r(X),r(Y)});r(ee);var te=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.create=function(e){var t;switch(e){case ee.CoreActions.bindParameterType:t=new ee.BindParameterTypeAction;break;case ee.CoreActions.bindPropertyType:t=new ee.BindPropertyTypeAction;break;case ee.CoreActions.injectProperty:t=new ee.InjectPropertyAction;break;case ee.CoreActions.bindProvider:t=new ee.BindProviderAction;break;case ee.CoreActions.bindParameterProviders:t=new ee.BindParameterProviderAction;break;case ee.CoreActions.componentInit:t=new ee.ComponentInitAction;break;case ee.CoreActions.componentBeforeInit:t=new ee.ComponentBeforeInitAction;break;case ee.CoreActions.componentAfterInit:t=new ee.ComponentAfterInitAction;break;case ee.CoreActions.cache:t=new ee.CacheAction;break;case ee.CoreActions.singletion:t=new ee.SingletionAction;break;case ee.CoreActions.autorun:t=new ee.AutorunAction;break;default:t=new ee.ActionComposite(e)}return t},e.classAnnations={name:"ActionFactory",params:{create:["type"]}},e}();t.ActionFactory=r});r(te);var re=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.decorators=[],this.buildAction()}return e.prototype.addAction=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.action;return t.forEach(function(e){n=n.find(function(t){return t.name===e})}),n&&n.add(e),this},e.prototype.registerDecorator=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getDecoratorType(e);return this.registerCustomDecorator.apply(this,[e,n].concat(t))},e.prototype.registerCustomDecorator=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this.toActionName(t),a=e.toString();return this.decorators.some(function(e){return e.name===a})||this.decorators.push({name:a,types:o,actions:r}),this},e.prototype.execute=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t=t.filter(function(e){return!!e});var n=this.action;t.forEach(function(e){n=n.find(function(t){return t.name===e})}),n&&n.execute(this.container,e)},e.prototype.getClassDecorators=function(e){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Class),e)},e.prototype.getMethodDecorators=function(e){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Method),e)},e.prototype.getPropertyDecorators=function(e){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Property),e)},e.prototype.getParameterDecorators=function(e){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Parameter),e)},e.prototype.getDecoratorType=function(e){return e.decoratorType||C.DecoratorType.All},e.prototype.isVaildDependence=function(e){return!!e&&(!!p.isClass(e)&&(!p.isAbstractDecoratorClass(e)&&this.getClassDecorators().some(function(t){return C.hasOwnClassMetadata(t.name,e)})))},e.prototype.getAtionByName=function(e){return this.action.find(function(t){return t.name===e})},e.prototype.getClassAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Class))},e.prototype.getMethodAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Method))},e.prototype.getPropertyAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Property))},e.prototype.getParameterAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Parameter))},e.prototype.getConstructorParameters=function(e){return this.getParameters(e)},e.prototype.getMethodParameters=function(e,t,r){return this.getParameters(e,t,r)},e.prototype.getParamerterNames=function(e,t){var r=C.getOwnParamerterNames(e),n=[];return r&&r.hasOwnProperty(t)&&(n=r[t]),p.isArray(n)||(n=[]),n},e.prototype.isSingletonType=function(e){return!!C.hasOwnClassMetadata(R.Singleton,e)||this.getClassDecorators().some(function(t){var r=C.getOwnTypeMetadata(t.name,e)||[];return!!p.isArray(r)&&r.some(function(e){return!0===e.singleton})})},e.prototype.getMethodMetadatas=function(e,t){var r=[];return this.getMethodDecorators().forEach(function(n){var o=C.getOwnMethodMetadata(n.name,e);o.hasOwnProperty(t)&&(r=r.concat(o[t]||[]))}),r},e.prototype.filerDecorators=function(e){return this.decorators.filter(e)},e.prototype.getParameters=function(e,t,r){var n={target:t,targetType:e,propertyKey:r=r||"constructor"};this.execute(n,ee.LifeState.onInit,ee.CoreActions.bindParameterType);var o=this.getParamerterNames(e,r);return n.execResult.length?n.execResult.map(function(e,t){return{type:e,name:o[t]}}):o.map(function(e){return{name:e,type:void 0}})},e.prototype.getTypeDecorators=function(e,t){return this.filerDecorators(function(r){var n=(r.types||"").indexOf(e)>=0;return n&&t&&(n=t(r)),n})},e.prototype.buildAction=function(){var e=new te.ActionFactory,t=e.create("");t.add(e.create(i.IocState.design).add(e.create(ee.CoreActions.bindProvider)).add(e.create(ee.CoreActions.autorun))).add(e.create(i.IocState.runtime).add(e.create(ee.LifeState.beforeCreateArgs)).add(e.create(ee.LifeState.beforeConstructor)).add(e.create(ee.LifeState.afterConstructor)).add(e.create(ee.LifeState.onInit).add(e.create(ee.CoreActions.componentBeforeInit)).add(e.create(this.toActionName(C.DecoratorType.Class))).add(e.create(this.toActionName(C.DecoratorType.Method))).add(e.create(this.toActionName(C.DecoratorType.Property)).add(e.create(ee.CoreActions.bindPropertyType)).add(e.create(ee.CoreActions.injectProperty))).add(e.create(this.toActionName(C.DecoratorType.Parameter)).add(e.create(ee.CoreActions.bindParameterType)).add(e.create(ee.CoreActions.bindParameterProviders))).add(e.create(ee.CoreActions.componentInit))).add(e.create(ee.LifeState.AfterInit).add(e.create(ee.CoreActions.singletion)).add(e.create(ee.CoreActions.componentAfterInit)))).add(e.create(ee.CoreActions.cache)),this.action=t},e.prototype.toActionName=function(e){var t=[];return e&C.DecoratorType.Class&&t.push("ClassDecorator"),e&C.DecoratorType.Method&&t.push("MethodDecorator"),e&C.DecoratorType.Property&&t.push("PropertyDecorator"),e&C.DecoratorType.Parameter&&t.push("ParameterDecorator"),t.join(",")},e.classAnnations={name:"DefaultLifeScope",params:{constructor:["container"],addAction:["action","nodepaths"],registerDecorator:["decorator","actions"],registerCustomDecorator:["decorator","type","actions"],execute:["data","names"],getClassDecorators:["match"],getMethodDecorators:["match"],getPropertyDecorators:["match"],getParameterDecorators:["match"],getDecoratorType:["decirator"],isVaildDependence:["target"],getAtionByName:["name"],getClassAction:[],getMethodAction:[],getPropertyAction:[],getParameterAction:[],getConstructorParameters:["type"],getMethodParameters:["type","instance","propertyKey"],getParamerterNames:["type","propertyKey"],isSingletonType:["type"],getMethodMetadatas:["type","propertyKey"],filerDecorators:["express"],getParameters:["type","instance","propertyKey"],getTypeDecorators:["decType","match"],buildAction:[],toActionName:["type"]}},e}();t.DefaultLifeScope=r});r(re);var ne=n(function(e,t){var r=o&&o.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,s)}c((n=n.apply(e,t||[])).next())})},n=o&&o.__generator||function(e,t){function r(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}var n,o,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.container=e}return e.prototype.getMatcher=function(){return this.container.get(p.symbols.IProviderMatcher)},e.prototype.invoke=function(e,t,o){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return r(this,void 0,void 0,function(){var r,i,s,c,u,f;return n(this,function(n){switch(n.label){case 0:if(o||(o=(f=this.container).resolve.apply(f,[e].concat(a))),!(r=this.container.getTokenImpl(e)))throw Error(e.toString()+" is not implements by any class.");return o&&p.isFunction(o[t])?(i={target:o,targetType:r,propertyKey:t},(s=this.container.getLifeScope()).execute(i,ee.LifeState.onInit,ee.CoreActions.bindParameterProviders),a=a.concat(i.execResult),c=s.getMethodParameters(r,o,t),[4,this.createParams.apply(this,[c].concat(a))]):[3,2];case 1:return u=n.sent(),[2,o[t].apply(o,u)];case 2:throw new Error("type: "+r+" has no method "+t+".");case 3:return[2]}})})},e.prototype.syncInvoke=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];r||(r=(f=this.container).resolve.apply(f,[e].concat(n)));var a=this.container.getTokenImpl(e);if(!a)throw Error(e.toString()+" is not implements by any class.");if(r&&p.isFunction(r[t])){var i={target:r,targetType:a,propertyKey:t},s=this.container.getLifeScope();s.execute(i,ee.LifeState.onInit,ee.CoreActions.bindParameterProviders),n=n.concat(i.execResult);var c=s.getMethodParameters(a,r,t),u=this.createSyncParams.apply(this,[c].concat(n));return r[t].apply(r,u)}throw new Error("type: "+a+" has no method "+t+".");var f},e.prototype.createSyncParams=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=(a=this.getMatcher()).matchProviders.apply(a,[e].concat(r));return e.map(function(e,n){return e.name&&o.has(e.name)?o.resolve(e.name):p.isToken(e.type)?(a=t.container).resolve.apply(a,[e.type].concat(r)):void 0;var a});var a},e.prototype.createParams=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=(a=this.getMatcher()).matchProviders.apply(a,[e].concat(r));return Promise.all(e.map(function(e,n){return e.name&&o.has(e.name)?o.resolve(e.name):p.isToken(e.type)?(a=t.container).resolve.apply(a,[e.type].concat(r)):void 0;var a}));var a},e.classAnnations={name:"MethodAccessor",params:{constructor:["container"],getMatcher:[],invoke:["token","propertyKey","target","providers"],syncInvoke:["token","propertyKey","target","providers"],createSyncParams:["params","providers"],createParams:["params","providers"]}},e}();t.MethodAccessor=a});r(ne);var oe=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.maps=new p.MapSet}return e.prototype.has=function(e){return this.maps.has(e)},e.prototype.get=function(e){return this.maps.get(e)},e.prototype.add=function(e,t){var r=this;if(p.isUndefined(e))return this;var n;return n=p.isToken(t)&&this.container.has(t)?function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(o=r.container).resolve.apply(o,[t].concat(e));var o}:p.isFunction(t)?function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(void 0,[r.container].concat(e))}:function(){return t},this.maps.set(e,n),this},e.prototype.remove=function(e){return this.maps.has(e)&&this.maps.delete(e),this},e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this.maps.has(e))return!p.isNumber(e)&&this.container.has(e)?(o=this.container).resolve.apply(o,[e].concat(t)):null;var n=this.maps.get(e);return p.isToken(n)?(a=this.container).resolve.apply(a,[n].concat(t)):n.apply(void 0,t);var o,a},e.prototype.forEach=function(e){this.maps.forEach(e)},e.prototype.copy=function(e){var t=this;e&&e.forEach(function(e,r){t.maps.set(r,e)})},e.classAnnations={name:"ProviderMap",params:{constructor:["container"],has:["provide"],get:["provide"],add:["provide","provider"],remove:["provide"],resolve:["provide","providers"],forEach:["express"],copy:["map"]}},e}();t.ProviderMap=r});r(oe);var ae=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.type=e,this.value=t}return e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return p.isUndefined(this.value)?e.has(this.type)?e.resolve.apply(e,[this.type].concat(t)):null:this.value},e.create=function(t,r){return new e(t,r)},e.createExtends=function(e,t,r){return new s(e,t,r)},e.createCustom=function(e,t,r){return new n(e,t,r)},e.createInvoke=function(e,t,r){return new o(e,t,r)},e.createParam=function(e,t,r,n){return new i(e,t,r,n)},e.createAsyncParam=function(e,t,r,n,o){return new c(e,t,r,n,o)},e.classAnnations={name:"Provider",params:{constructor:["type","value"],resolve:["container","providers"],create:["type","value"],createExtends:["token","value","extendsTarget"],createCustom:["type","toInstance","value"],createInvoke:["token","method","value"],createParam:["token","value","index","method"],createAsyncParam:["files","token","index","method","value"]}},e}();t.Provider=r;var n=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.toInstance=r,o}return a(t,e),t.prototype.resolve=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.toInstance?this.toInstance.apply(this,[t].concat(r)):e.prototype.resolve.apply(this,[t].concat(r))},t.classAnnations={name:"CustomProvider",params:{constructor:["type","toInstance","value"],resolve:["container","providers"]}},t}(r);t.CustomProvider=n;var o=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.method=r,o}return a(t,e),t.prototype.resolve=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.method?t.syncInvoke.apply(t,[this.type,this.method].concat(r)):e.prototype.resolve.apply(this,[t].concat(r))},t.classAnnations={name:"InvokeProvider",params:{constructor:["type","method","value"],resolve:["container","providers"]}},t}(r);t.InvokeProvider=o;var i=function(e){function t(t,r,n,o){var a=e.call(this,t,o,r)||this;return a.index=n,a}return a(t,e),t.prototype.resolve=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return e.prototype.resolve.apply(this,[t].concat(r))},t.classAnnations={name:"ParamProvider",params:{constructor:["token","value","index","method"],resolve:["container","providers"]}},t}(o);t.ParamProvider=i;var s=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.extendsTarget=n,o}return a(t,e),t.prototype.resolve=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return e.prototype.resolve.apply(this,[t].concat(r))},t.prototype.extends=function(e){p.isObject(e)&&p.isFunction(this.extendsTarget)&&this.extendsTarget(e,this)},t.classAnnations={name:"ExtendsProvider",params:{constructor:["token","value","extendsTarget"],resolve:["container","providers"],extends:["target"]}},t}(r);t.ExtendsProvider=s;var c=function(e){function t(t,r,n,o,a){var i=e.call(this,r,a,n,o)||this;return i.files=t,i}return a(t,e),t.prototype.resolve=function(t){for(var r=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.get(p.symbols.IContainerBuilder).loadModule(t,{files:this.files}).then(function(){return e.prototype.resolve.apply(r,[t].concat(n))})},t.classAnnations={name:"AsyncParamProvider",params:{constructor:["files","token","index","method","value"],resolve:["container","providers"]}},t}(i);t.AsyncParamProvider=c});r(ae);var ie=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(ae),r(oe),t.isProviderMap=function(e){return!!p.isObject(e)&&e instanceof oe.ProviderMap}});r(ie);var se=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.toProviderMap=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(1===t.length&&ie.isProviderMap(t[0]))return t[0];var n=this.container.resolve(ie.ProviderMap);return t.forEach(function(t,r){p.isUndefined(t)||p.isNull(t)||(ie.isProviderMap(t)?n.copy(t):t instanceof ie.Provider?t instanceof ie.ParamProvider&&!t.type&&p.isNumber(t.index)?n.add(t.index,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.resolve.apply(t,[e.container].concat(r))}):n.add(t.type,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.resolve.apply(t,[e.container].concat(r))}):p.isBaseObject(t)?Object.keys(t).forEach(function(e){p.isUndefined(t[e])||(p.isClass(t[e])?n.add(e,t[e]):p.isFunction(t[e])||p.isString(t[e])?n.add(e,function(){return t[e]}):n.add(e,t[e]))}):p.isFunction(t)?n.add(name,function(){return t}):n.add(r,t))}),n},e.prototype.matchProviders=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.match(e,this.toProviderMap.apply(this,t))},e.prototype.match=function(e,t){var r=this,n=this.container.resolve(ie.ProviderMap);return e.length?(e.forEach(function(e,o){e.name&&(t.has(e.name)?n.add(e.name,t.get(e.name)):p.isToken(e.type)?t.has(e.type)?n.add(e.name,t.get(e.type)):r.container.has(e.type)&&n.add(e.name,e.type):t.has(o)&&n.add(e.name,t.get(o)))}),n):n},e.classAnnations={name:"ProviderMatcher",params:{constructor:["container"],toProviderMap:["providers"],matchProviders:["params","providers"],match:["params","providers"]}},e}();t.ProviderMatcher=r});r(se);var ce=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.cacheTokens=new p.MapSet}return e.prototype.isChecking=function(){return!!this.timeout},e.prototype.hasCache=function(e){return this.cacheTokens.has(e)},e.prototype.cache=function(e,t,r){var n;this.hasCache(e)?(n=this.cacheTokens.get(e)).expires=Date.now()+r:n={target:t,expires:Date.now()+r},this.cacheTokens.set(e,n),this.isChecking()||this.checkExpires()},e.prototype.get=function(e,t){var r=null;if(!this.cacheTokens.has(e))return null;var n=this.cacheTokens.get(e);return n.expires<=Date.now()?(r=n.target,p.isNumber(t)&&t>0&&(n.expires=Date.now()+t,this.cacheTokens.set(e,n))):this.destroy(e,n.target),r},e.prototype.checkExpires=function(){var e=this;if(this.timeout&&(clearTimeout(this.timeout),this.timeout=0),this.cacheTokens.size>0){var t=[];this.cacheTokens.forEach(function(e,r){e.expires>=Date.now()&&t.push(r)}),t.length&&t.forEach(function(t){e.destroy(t,e.cacheTokens.get(t).target)}),this.timeout=setTimeout(function(){e.checkExpires()},6e4)}},e.prototype.destroy=function(e,t){if(this.hasCache(e)){t||(t=this.cacheTokens.get(e).target);try{var r=t;p.isFunction(r.onDestroy)&&this.container.syncInvoke(e,"onDestroy",t),this.cacheTokens.delete(e)}catch(e){console.error&&console.error(e)}}},e.classAnnations={name:"CacheManager",params:{constructor:["container"],isChecking:[],hasCache:["targetType"],cache:["targetType","target","expires"],get:["targetType","expires"],checkExpires:[],destroy:["targetType","target"]}},e}();t.CacheManager=r});r(ce);var ue=n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(ee),r(R),r(C),r(ie),r(te),r(re),r(se),r(ne),r(ce),t.registerCores=function(e){e.registerSingleton(p.symbols.LifeScope,function(){return new re.DefaultLifeScope(e)}),e.register(ie.ProviderMap,function(){return new ie.ProviderMap(e)}),e.registerSingleton(p.symbols.ICacheManager,function(){return new ce.CacheManager(e)}),e.registerSingleton(p.symbols.IProviderMatcher,function(){return new se.ProviderMatcher(e)}),e.registerSingleton(p.symbols.IMethodAccessor,function(){return new ne.MethodAccessor(e)});var t=e.get(p.symbols.LifeScope);t.registerDecorator(R.Injectable,ee.CoreActions.bindProvider,ee.CoreActions.cache),t.registerDecorator(R.Component,ee.CoreActions.bindProvider,ee.CoreActions.cache,ee.CoreActions.componentBeforeInit,ee.CoreActions.componentInit,ee.CoreActions.componentAfterInit),t.registerDecorator(R.Singleton,ee.CoreActions.bindProvider),t.registerDecorator(R.Abstract,ee.CoreActions.bindProvider,ee.CoreActions.cache),t.registerDecorator(R.AutoWired,ee.CoreActions.bindParameterType,ee.CoreActions.bindPropertyType),t.registerDecorator(R.Inject,ee.CoreActions.bindParameterType,ee.CoreActions.bindPropertyType),t.registerDecorator(R.Param,ee.CoreActions.bindParameterType,ee.CoreActions.bindPropertyType),t.registerDecorator(R.Method,ee.CoreActions.bindParameterProviders),t.registerDecorator(R.Autorun,ee.CoreActions.autorun),t.registerDecorator(R.IocModule,ee.CoreActions.autorun,ee.CoreActions.componentBeforeInit,ee.CoreActions.componentInit,ee.CoreActions.componentAfterInit),e.register(Date,function(){return new Date}),e.register(String,function(){return""}),e.register(Number,function(){return Number.NaN}),e.register(Boolean,function(){})}});r(ue);var pe=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.init()}return e.prototype.get=function(e,t){return this.resolve(t?this.getTokenKey(e,t):e)},e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getTokenKey(e);if(!this.hasRegister(n))return console.error("have not register",n),null;return this.factories.get(n).apply(void 0,t)},e.prototype.clearCache=function(e){this.get(p.symbols.ICacheManager).destroy(e)},e.prototype.getToken=function(e,t){return e instanceof f.Registration?e:t&&p.isFunction(e)?new f.Registration(e,t):e},e.prototype.getTokenKey=function(e,t){return e instanceof f.Registration?e.toString():t?new f.Registration(e,t).toString():e},e.prototype.register=function(e,t){return this.registerFactory(e,t),this},e.prototype.has=function(e,t){var r=this.getTokenKey(e,t);return this.hasRegister(r)},e.prototype.hasRegister=function(e){return this.factories.has(e)},e.prototype.unregister=function(e){var t=this.getTokenKey(e);return this.hasRegister(t)&&this.factories.delete(t),this},e.prototype.registerSingleton=function(e,t){return this.registerFactory(e,t,!0),this},e.prototype.registerValue=function(e,t){var r=this,n=this.getTokenKey(e);return this.singleton.set(n,t),this.factories.has(n)||this.factories.set(n,function(){return r.singleton.get(n)}),this},e.prototype.bindProvider=function(e,t){var r,n=this,o=this.getTokenKey(e);if(r=p.isToken(t)?function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.resolve.apply(n,[t].concat(e))}:p.isFunction(t)?function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(void 0,[n].concat(e))}:function(){return t},p.isClass(t))this.provideTypes.set(e,t);else if(p.isToken(t))for(var a=t;this.provideTypes.has(a)&&!p.isClass(a);)if(a=this.provideTypes.get(a),p.isClass(a)){this.provideTypes.set(e,a);break}return this.factories.set(o,r),this},e.prototype.getTokenImpl=function(e){return p.isClass(e)?e:this.provideTypes.has(e)?this.provideTypes.get(e):null},e.prototype.getLifeScope=function(){return this.get(p.symbols.LifeScope)},e.prototype.use=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(r=this.get(p.symbols.IContainerBuilder)).syncLoadModule.apply(r,[this].concat(e)),this;var r},e.prototype.invoke=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return(a=this.get(p.symbols.IMethodAccessor)).invoke.apply(a,[e,t,r].concat(n));var a},e.prototype.syncInvoke=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return(a=this.get(p.symbols.IMethodAccessor)).syncInvoke.apply(a,[e,t,r].concat(n));var a},e.prototype.createSyncParams=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return(n=this.get(p.symbols.IMethodAccessor)).createSyncParams.apply(n,[e].concat(t));var n},e.prototype.createParams=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return(n=this.get(p.symbols.IMethodAccessor)).createParams.apply(n,[e].concat(t));var n},e.prototype.cacheDecorator=function(e,t){e.has(t.name)||e.set(t.name,t)},e.prototype.init=function(){var e=this;this.factories=new p.MapSet,this.singleton=new p.MapSet,this.provideTypes=new p.MapSet,this.bindProvider(p.symbols.IContainer,function(){return e}),ue.registerCores(this)},e.prototype.registerFactory=function(e,t,r){var n=this.getTokenKey(e);if(!this.factories.has(n)){var o;if(p.isUndefined(t)){if(!p.isString(e)&&!p.isSymbol(e)){var a=e instanceof f.Registration?e.getClass():e;p.isClass(a)&&this.bindTypeFactory(n,a,r)}}else p.isFunction(t)?p.isClass(t)?this.bindTypeFactory(n,t,r):o=this.createCustomFactory(n,t,r):r&&void 0!==t&&(o=this.createCustomFactory(n,function(){return t},r));o&&this.factories.set(n,o)}},e.prototype.createCustomFactory=function(e,t,r){var n=this;return r?function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(n.singleton.has(e))return n.singleton.get(e);var a=t.apply(void 0,[n].concat(r));return n.singleton.set(e,a),a}:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(void 0,[n].concat(e))}},e.prototype.bindTypeFactory=function(e,t,r){var n=this;if(Reflect.isExtensible(t)){var o=this.getLifeScope(),a=o.getConstructorParameters(t);r||(r=o.isSingletonType(t));this.factories.set(e,function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];if(r&&n.singleton.has(e))return n.singleton.get(e);if(s.length<1){var u={tokenKey:e,targetType:t,singleton:r};if(o.execute(u,ue.CoreActions.cache),u.execResult&&u.execResult instanceof t)return u.execResult}o.execute({tokenKey:e,targetType:t,params:a,providers:s,singleton:r},i.IocState.runtime,ue.LifeState.beforeCreateArgs);var p=n.createSyncParams.apply(n,[a].concat(s));o.execute({tokenKey:e,targetType:t,args:p,params:a,providers:s,singleton:r},i.IocState.runtime,ue.LifeState.beforeConstructor);var f=new(t.bind.apply(t,[void 0].concat(p)));return o.execute({tokenKey:e,target:f,targetType:t,args:p,params:a,providers:s,singleton:r},i.IocState.runtime,ue.LifeState.afterConstructor),o.execute({tokenKey:e,target:f,targetType:t,args:p,params:a,providers:s,singleton:r},i.IocState.runtime,ue.LifeState.onInit),o.execute({tokenKey:e,target:f,targetType:t,args:p,params:a,providers:s,singleton:r},i.IocState.runtime,ue.LifeState.AfterInit),o.execute({tokenKey:e,target:f,targetType:t},ue.CoreActions.cache),f}),o.execute({tokenKey:e,targetType:t},i.IocState.design)}},e.classAnnations={name:"Container",params:{constructor:[],get:["token","alias"],resolve:["token","providers"],clearCache:["targetType"],getToken:["token","alias"],getTokenKey:["token","alias"],register:["token","value"],has:["token","alias"],hasRegister:["key"],unregister:["token"],registerSingleton:["token","value"],registerValue:["token","value"],bindProvider:["provide","provider"],getTokenImpl:["token"],getLifeScope:[],use:["modules"],invoke:["token","propertyKey","instance","providers"],syncInvoke:["token","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"],cacheDecorator:["map","action"],init:[],registerFactory:["token","value","singleton"],createCustomFactory:["key","factory","singleton"],bindTypeFactory:["key","ClassT","singleton"]}},e}();t.Container=r});r(pe);var fe=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getLoader=function(){return this._loader||(this._loader=this.createLoader()),this._loader},e.prototype.load=function(e){var t=this;return e.files?Promise.all(e.files).then(function(e){return e.map(function(e){return t.loadModule(e)})}):Promise.resolve([])},e.prototype.loadModule=function(e){return this.getLoader()(e)},e.prototype.createLoader=function(){if(void 0!==t)return function(e){return new Promise(function(e,r){t()})};throw new Error("has not module loader")},e.classAnnations={name:"DefaultModuleLoader",params:{constructor:[],getLoader:[],load:["options"],loadModule:["file"],createLoader:[]}},e}();r.DefaultModuleLoader=n});r(fe);var le=n(function(e,t){var r=o&&o.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,s)}c((n=n.apply(e,t||[])).next())})},n=o&&o.__generator||function(e,t){function r(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}var n,o,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.loader=e,e||(this.loader=new fe.DefaultModuleLoader)}return e.prototype.create=function(){var e=this,t=new pe.Container;return t.bindProvider(p.symbols.IContainerBuilder,function(){return e}),t},e.prototype.build=function(e){return r(this,void 0,void 0,function(){var t;return n(this,function(r){switch(r.label){case 0:return t=this.create(),e?[4,this.loadModule(t,e)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2,t]}})})},e.prototype.loadModule=function(e,t){return r(this,void 0,void 0,function(){var r;return n(this,function(n){switch(n.label){case 0:return[4,this.loadTypes(t)];case 1:return r=n.sent(),[2,this.registers(e,r)]}})})},e.prototype.syncBuild=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.create();return e.length&&this.syncLoadModule.apply(this,[r].concat(e)),r},e.prototype.syncLoadModule=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getModules.apply(this,t);return this.registers(e,n)},e.prototype.loadTypes=function(e){return r(this,void 0,void 0,function(){var t,r,o=this;return n(this,function(n){switch(n.label){case 0:return e?[4,this.loader.load(e)]:[3,3];case 1:return t=n.sent(),e.modules&&e.modules.length?[4,Promise.all(e.modules.map(function(e){return p.isString(e)?o.loader.loadModule(e):e}))]:[3,3];case 2:r=n.sent(),t=t.concat(r),n.label=3;case 3:return[2,this.getModules.apply(this,t)]}})})},e.prototype.registers=function(e,t){return(t=t||[]).forEach(function(t){e.register(t)}),t},e.prototype.getModules=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=[];return t.forEach(function(t){var r=e.getTypes(t),o=r.find(function(e){return ue.hasOwnClassMetadata(ue.IocModule,e)});o?n.push(o):n.push.apply(n,r)}),n},e.prototype.getTypes=function(e){var t=[];if(p.isClass(e))t.push(e);else{var r=e.exports?e.exports:e;for(var n in r)p.isClass(r[n])&&t.push(r[n])}return t},e.classAnnations={name:"DefaultContainerBuilder",params:{constructor:["loader"],create:[],build:["options"],loadModule:["container","options"],syncBuild:["modules"],syncLoadModule:["container","modules"],loadTypes:["options"],registers:["container","types"],getModules:["modules"],getTypes:["regModule"]}},e}();t.DefaultContainerBuilder=a});r(le);return r(n(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(pe),r(i),r(f),r(fe),r(le),r(p),r(L),r(ue)}))});