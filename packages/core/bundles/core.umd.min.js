!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("reflect-metadata")):"function"==typeof define&&define.amd?define(["reflect-metadata"],e):(t.core=t.core||{},t.core.umd=t.core.umd||{},t.core.umd.js=e(t.Reflect))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var f=r(function(t,e){var r,n;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.IocState||(e.IocState={})).design="design",r.runtime="runtime",(n=e.Mode||(e.Mode={}))[n.route=1]="route",n[n.children=2]="children",n[n.traverse=3]="traverse",n[n.traverseLast=4]="traverseLast"});e(f);f.IocState,f.Mode;var p=r(function(t,e){function o(r,n){a.isArray(r)?r.forEach(n):a.isObject(r)&&Object.keys(r).forEach(function(t,e){n(r[t],t)})}e.keys=function(t){return a.isObject(t)?Object.keys(t):[]},e.assign=function(t,e,r,n){return n&&n.length?(n.unshift(r||{}),n.unshift(e||{}),Object.assign.apply(Object,[t].concat(n))):r?Object.assign(t,e||{},r):Object.assign(t,e||{})},e.omit=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(a.isObject(e)){var n={};return Object.keys(e).forEach(function(t){r.indexOf(t)<0&&(n[t]=e[t])}),n}return e},e.hasField=function(t){return!!a.isObject(t)&&0<Object.keys(t).length},e.forIn=o,e.find=function(t,r){var n;o(t,function(t,e){return!(n||r(t,e)&&(n=t,1))})}});e(p);p.keys,p.assign,p.omit,p.hasField,p.forIn,p.find;var a=r(function(t,e){function r(t){return!!t&&"function"==typeof t}function n(t){if(!r(t))return!1;if(t.prototype){if(!t.name||"Object"===t.name)return!1;if(Reflect.hasOwnMetadata("@Abstract",t))return!1;var e=t;if(/^[a-z]$/.test(e.name))return!(!e.classAnnations||!e.classAnnations.name);if(e.classAnnations&&s(e.classAnnations.name))return!0;if(!/^[A-Z@]/.test(t.name))return!1;if(!o()&&/MSIE [6-9]/.test(navigator.userAgent))return!0;try{return t.arguments&&t.caller,!1}catch(t){return!0}}return!1}function o(){return"undefined"!=typeof process&&void 0!==process.versions.node}function a(t){return!!t&&!!(s(t)||u(t)||n(t)||c(t)&&t instanceof d.Registration)}function i(t,e,r){return!!t&&(!a(t)&&(!(t instanceof RegExp||t instanceof Date)&&((!t.constructor||"Object"===t.constructor.name)&&(e=e||["type"],r&&(e=r.concat(e)),p.keys(t).some(function(t){return 0<e.indexOf(t)})))))}function s(t){return"string"==typeof t}function c(t){var e=typeof t;return null!=t&&("object"===e||"function"===e)}function u(t){return"symbol"==typeof t||c(t)&&/^Symbol\(/.test(t.toString())}e.isFunction=r,e.isAbstractDecoratorClass=function(t){return!!r(t)&&!!Reflect.hasOwnMetadata("@Abstract",t)},e.getClassName=function(t){return r(t)?/^[a-z]$/.test(t.name)&&t.classAnnations?t.classAnnations.name:t.name:""},e.isClass=n,e.isNodejsEnv=o,e.isToken=a,e.isPromise=function(t){return!!t&&!(!r(t.then)||!r(t.catch))},e.isObservable=function(t){return!(!t&&!c(t)||!r(t.subscribe)||!r(t.toPromise))},e.isBaseObject=function(t){return!!t&&!(!t.constructor||"Object"!==t.constructor.name)},e.isMetadataObject=i,e.isClassMetadata=function(t,e){return i(t,["singleton","provide","alias","type"],e)},e.isParamMetadata=function(t,e){return i(t,["type","provider","index"],e)},e.isParamPropMetadata=function(t,e){return i(t,["type","provider","index"],e)},e.isPropertyMetadata=function(t,e){return i(t,["type","provider"],e)},e.isString=s,e.isBoolean=function(t){return"boolean"==typeof t||!0===t||!1===t},e.isNumber=function(t){return"number"==typeof t},e.isUndefined=function(t){return void 0===t||void 0===t},e.isNull=function(t){return null===t},e.isArray=function(t){return Array.isArray(t)},e.isObject=c,e.isDate=function(t){return c(t)&&t instanceof Date},e.isSymbol=u,e.isRegExp=function(t){return t&&t instanceof RegExp}});e(a);a.isFunction,a.isAbstractDecoratorClass,a.getClassName,a.isClass,a.isNodejsEnv,a.isToken,a.isPromise,a.isObservable,a.isBaseObject,a.isMetadataObject,a.isClassMetadata,a.isParamMetadata,a.isParamPropMetadata,a.isPropertyMetadata,a.isString,a.isBoolean,a.isNumber,a.isUndefined,a.isNull,a.isArray,a.isObject,a.isDate,a.isSymbol,a.isRegExp;var o=r(function(t,e){var r=function(){function t(){this.valueMap={},this.keyMap={}}return t.prototype.clear=function(){this.valueMap={},this.keyMap={}},t.prototype.getTypeKey=function(t){return a.isString(t)?t:a.isFunction(t)?t.name:t.toString()},t.prototype.delete=function(t){var e=this.getTypeKey(t).toString();try{return delete this.keyMap[e],delete this.valueMap[e],!0}catch(t){return!1}},t.prototype.forEach=function(r,t){var n=this;p.forIn(this.keyMap,function(t,e){r(n.valueMap[e],t,n)})},t.prototype.get=function(t){var e=this.getTypeKey(t);return this.valueMap[e]},t.prototype.has=function(t){var e=this.getTypeKey(t);return!a.isUndefined(this.keyMap[e])},t.prototype.set=function(t,e){var r=this.getTypeKey(t);return this.keyMap[r]=t,this.valueMap[r]=e,this},Object.defineProperty(t.prototype,"size",{get:function(){return p.keys(this.keyMap).length},enumerable:!0,configurable:!0}),t.classAnnations={name:"ObjectMapSet",params:{constructor:[],clear:[],getTypeKey:["key"],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},t}();e.ObjectMapSet=r;var n=function(){function t(){this.map=a.isClass(Map)?new Map:new r}return t.prototype.clear=function(){this.map.clear()},t.prototype.delete=function(t){return this.map.delete(t)},t.prototype.forEach=function(t,e){this.map.forEach(t,e)},t.prototype.get=function(t){return this.map.get(t)},t.prototype.has=function(t){return this.map.has(t)},t.prototype.set=function(t,e){return this.map.set(t,e),this},Object.defineProperty(t.prototype,"size",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),t.classAnnations={name:"MapSet",params:{constructor:[],clear:[],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},t}();e.MapSet=n});e(o);o.ObjectMapSet,o.MapSet;var i=r(function(t,e){e.symbols={IContainer:Symbol("IContainer"),LifeScope:Symbol("LifeScope"),IProviderMatcher:Symbol("IProviderMatcher"),IMethodAccessor:Symbol("IMethodAccessor"),ICacheManager:Symbol("ICacheManager"),IContainerBuilder:Symbol("IContainerBuilder"),IRecognizer:Symbol("IRecognizer")}});e(i);i.symbols;var A=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(a),e(o),e(i),r.lang=p});e(A);A.lang;var d=r(function(t,e){var r=function(){function t(t,e){this.classType=t,this.desc=e,this.type="Registration"}return t.prototype.getClass=function(){return A.isClass(this.classType)?this.classType:null},t.prototype.getDesc=function(){return this.desc},t.prototype.toString=function(){var t="";return t=A.isFunction(this.classType)?A.getClassName(this.classType):this.classType.toString(),this.type+" "+t+" "+this.desc},t.classAnnations={name:"Registration",params:{constructor:["classType","desc"],getClass:[],getDesc:[],toString:[]}},t}();e.Registration=r});e(d);d.Registration;var M=r(function(t,e){var r=function(){function t(t){this.args=t,this.idx=-1,this.metadata=null}return t.prototype.isCompeted=function(){return this.idx>=this.args.length},t.prototype.end=function(){this.idx=this.args.length},t.prototype.next=function(t){if(this.isCompeted())return null;if(this.idx++,this.isCompeted())return null;var e=this.args[this.idx];t.isMetadata&&t.isMetadata(e)?(this.metadata=e,this.end()):t.match(e)?(this.metadata=this.metadata||{},t.setMetadata(this.metadata,e)):this.end()},t.prototype.getArgs=function(){return this.args},t.prototype.getMetadata=function(){return this.metadata},t.classAnnations={name:"ArgsIterator",params:{constructor:["args"],isCompeted:[],end:[],next:["express"],getArgs:[],getMetadata:[]}},t}();e.ArgsIterator=r});e(M);M.ArgsIterator;var P=r(function(t,e){var r;(r=e.DecoratorType||(e.DecoratorType={}))[r.Class=1]="Class",r[r.Parameter=2]="Parameter",r[r.Property=4]="Property",r[r.Method=8]="Method",r[r.All=13]="All"});e(P);P.DecoratorType;var c=r(function(t,a){function s(t,e,r,n,o){var a;switch(r.length){case 1:if(a=r[0],A.isClass(a)||A.isAbstractDecoratorClass(a))return function(t,e,r,n,o){var a=c(e,r).slice(0),i=n||{};i.type||(i.type=r);i.decorator=t,o&&(i=o(i));a.unshift(i),v(r),Reflect.defineMetadata(e,a,r)}(t,e,a,n,o),a;break;case 2:l(t,e,a=r[0],r[1],n,o);break;case 3:if(A.isNumber(r[2])){!function(t,e,r,n,o,a,i){var s=y(e,r,n).slice(0);for(;s.length<=o;)s.push(null);s[o]=s[o]||[];var c=a||{};if(!c.type){var u=Reflect.getOwnMetadata("design:type",r,n);u||(u=Reflect.getOwnMetadata("design:type",r.constructor,n)),c.type=u}c.propertyKey=n,c.decorator=t,c.index=o,i&&(c=i(c));s[o].unshift(c),Reflect.defineMetadata(e+h,s,r,n)}(t,e,a=r[0],r[1],r[2],n,o)}else{if(!A.isUndefined(r[2])){a=r[0];var i=r[1],s=r[2];return function(t,e,r,n,o,a,i){var s=A.lang.assign({},p(e,r));s[n]=s[n]||[];var c=a||{};c.decorator=t,c.propertyKey=n,i&&(c=i(c));s[n].unshift(c),Reflect.defineMetadata(e+u,s,r.constructor)}(t,e,a,i,0,n,o),s}l(t,e,a=r[0],r[1],n,o)}break;default:throw new Error("Invalid @"+t+" Decorator declaration.")}}function c(t,e){var r=Reflect.getOwnMetadata(A.isFunction(t)?t.toString():t,e);return r=A.isArray(r)?r:[]}a.ParamerterName="paramerter_names",a.createDecorator=function(n,o,a){var i="@"+n,t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=null;return t.length<1?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s(n,i,t,r,a)}:(r=function(t,e){var r=null;if(t.length)if(1===t.length&&A.isMetadataObject(t[0]))r=t[0];else if(e){var n=new M.ArgsIterator(t);e(n),r=n.getMetadata()}return r}(t,o))?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s(n,i,t,r,a)}:1!==t.length||A.isClass(t[0])?s(n,i,t,r,a):function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s(n,i,t,r,a)}};return t.toString=function(){return i},t.decoratorType=P.DecoratorType.All,t},a.getTypeMetadata=function(t,e){var r=Reflect.getOwnMetadata(A.isFunction(t)?t.toString():t,e);return r=A.isArray(r)?r:[]},a.getOwnTypeMetadata=c,a.hasClassMetadata=function(t,e){var r=A.isFunction(t)?t.toString():t;return Reflect.hasMetadata(r,e)},a.hasOwnClassMetadata=function(t,e){var r=A.isFunction(t)?t.toString():t;return Reflect.hasOwnMetadata(r,e)};var u="__method";function p(t,e){var r=A.isFunction(t)?t.toString():t,n=Reflect.getMetadata(r+u,e);return n&&!A.isArray(n)&&A.lang.hasField(n)||(n=Reflect.getMetadata(r+u,e.constructor)),A.isArray(n)?{}:n||{}}function i(t,e){var r=A.isFunction(t)?t.toString():t,n=Reflect.getOwnMetadata(r+u,e);return n&&!A.isArray(n)&&A.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+u,e.constructor)),A.isArray(n)?{}:n||{}}a.getMethodMetadata=p,a.getOwnMethodMetadata=i,a.hasOwnMethodMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t;if(r){var o=i(n,e);return o&&o.hasOwnProperty(r)}return Reflect.hasOwnMetadata(n+u,e)},a.hasMethodMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t;if(r){var o=p(n,e);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+u,e)};var f="__props";function d(t,e){var r=A.isFunction(t)?t.toString():t,n=Reflect.getMetadata(r+f,e);return n&&!A.isArray(n)&&A.lang.hasField(n)||(n=Reflect.getMetadata(r+f,e.constructor)),A.isArray(n)?{}:n||{}}function l(t,e,r,n,o,a){var i=A.lang.assign({},d(e,r)),s=o||{};if(s.propertyKey=n,s.decorator=t,!s.type){var c=Reflect.getMetadata("design:type",r,n);c||(c=Reflect.getMetadata("design:type",r.constructor,n)),s.type=c}a&&(s=a(s)),i[n]&&A.isArray(i[n])||(i[n]=[]),i[n].unshift(s),Reflect.defineMetadata(e+f,i,r.constructor)}a.getPropertyMetadata=d,a.getOwnPropertyMetadata=function(t,e){var r=A.isFunction(t)?t.toString():t,n=Reflect.getOwnMetadata(r+f,e);return n&&!A.isArray(n)&&A.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+f,e.constructor)),A.isArray(n)?{}:n||{}},a.hasPropertyMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t;if(r){var o=d(n,e);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+f,e)};var h="__params";function y(t,e,r){var n=A.isFunction(t)?t.toString():t,o=Reflect.getOwnMetadata(n+h,e,r);return o=A.isArray(o)?o:[]}function g(t){var e=Reflect.getMetadata(a.ParamerterName,t);return e&&!A.isArray(e)&&A.lang.hasField(e)||(e=Reflect.getMetadata(a.ParamerterName,t.constructor)),A.isArray(e)?{}:e||{}}function v(t){var r=A.lang.assign({},g(t)),e=Object.getOwnPropertyDescriptors(t.prototype),n=/^[a-z]/.test(t.name),o="";t.classAnnations&&t.classAnnations.params&&(o=t.classAnnations.name,r=A.lang.assign(r,t.classAnnations.params)),n||t.name===o||(A.lang.forIn(e,function(t,e){"constructor"!==e&&(t.value&&(r[e]=m(t.value)),t.set&&(r[e]=m(t.set)))}),r.constructor=m(t.prototype.constructor)),Reflect.defineMetadata(a.ParamerterName,r,t)}a.getParamMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t,o=Reflect.getMetadata(n+h,e,r);return o=A.isArray(o)?o:[]},a.getOwnParamMetadata=y,a.hasParamMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t;return Reflect.hasMetadata(n+h,e,r)},a.hasOwnParamMetadata=function(t,e,r){var n=A.isFunction(t)?t.toString():t;return Reflect.hasOwnMetadata(n+h,e,r)},a.getParamerterNames=g,a.getOwnParamerterNames=function(t){var e=Reflect.getOwnMetadata(a.ParamerterName,t);return e&&!A.isArray(e)&&A.lang.hasField(e)||(e=Reflect.getOwnMetadata(a.ParamerterName,t.constructor)),A.isArray(e)?{}:e||{}},a.setParamerterNames=v;var n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,o=/([^\s,]+)/g;function m(t){if(!A.isFunction(t))return[];var e=t.toString().replace(n,""),r=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(o);return null===r&&(r=[]),r}});e(c);c.ParamerterName,c.createDecorator,c.getTypeMetadata,c.getOwnTypeMetadata,c.hasClassMetadata,c.hasOwnClassMetadata,c.getMethodMetadata,c.getOwnMethodMetadata,c.hasOwnMethodMetadata,c.hasMethodMetadata,c.getPropertyMetadata,c.getOwnPropertyMetadata,c.hasPropertyMetadata,c.getParamMetadata,c.getOwnParamMetadata,c.hasParamMetadata,c.hasOwnParamMetadata,c.getParamerterNames,c.getOwnParamerterNames,c.setParamerterNames;var u=r(function(t,e){e.createClassDecorator=function(t,e,r){var n=c.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return A.isClassMetadata(t)},match:function(t){return t&&(A.isSymbol(t)||A.isString(t)||A.isObject(t)&&t instanceof d.Registration)},setMetadata:function(t,e){t.provide=e}}),t.next({match:function(t){return A.isString(t)},setMetadata:function(t,e){t.alias=e}}),t.next({match:function(t){return A.isBoolean(t)},setMetadata:function(t,e){t.singleton=e}}),t.next({match:function(t){return A.isNumber(t)},setMetadata:function(t,e){t.expires=e}})},r);return n.decoratorType=P.DecoratorType.Class,n}});e(u);u.createClassDecorator;var l=r(function(t,e){e.createMethodDecorator=function(t,e,r){var n=c.createDecorator(t,function(t){e&&e(t),t.next({match:function(t){return A.isArray(t)},setMetadata:function(t,e){t.providers=e}})},r);return n.decoratorType=P.DecoratorType.Method,n}});e(l);l.createMethodDecorator;var h=r(function(t,e){e.createParamDecorator=function(t,e,r){var n=c.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return A.isParamMetadata(t)},match:function(t){return A.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=P.DecoratorType.Parameter,n}});e(h);h.createParamDecorator;var y=r(function(t,e){e.createPropDecorator=function(t,e,r){var n=c.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return A.isPropertyMetadata(t)},match:function(t){return A.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=P.DecoratorType.Property,n}});e(y);y.createPropDecorator;var g=r(function(t,e){e.createParamPropDecorator=function(t,e,r){var n=c.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return A.isParamPropMetadata(t)},match:function(t){return A.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=P.DecoratorType.Property|P.DecoratorType.Parameter,n}});e(g);g.createParamPropDecorator;var v=r(function(t,e){e.createClassMethodDecorator=function(t,e,r){var n=c.createDecorator(t,e,r);return n.decoratorType=P.DecoratorType.Class|P.DecoratorType.Method,n}});e(v);v.createClassMethodDecorator;var m=r(function(t,e){e.createMethodPropDecorator=function(t,e,r){var n=c.createDecorator(t,e,r);return n.decoratorType=P.DecoratorType.Method|P.DecoratorType.Property,n}});e(m);m.createMethodPropDecorator;var C=r(function(t,e){e.createMethodPropParamDecorator=function(t,e,r){var n=c.createDecorator(t,e,r);return n.decoratorType=P.DecoratorType.Method|P.DecoratorType.Property|P.DecoratorType.Parameter,n}});e(C);C.createMethodPropParamDecorator;var b=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(M),e(P),e(c),e(u),e(l),e(h),e(y),e(g),e(v),e(m),e(C)});e(b);var T=r(function(t,e){e.Component=b.createClassDecorator("Component")});e(T);T.Component;var k=r(function(t,e){e.Injectable=b.createClassDecorator("Injectable")});e(k);k.Injectable;var w=r(function(t,e){e.Inject=b.createParamPropDecorator("Inject")});e(w);w.Inject;var x=r(function(t,e){e.AutoWired=b.createParamPropDecorator("AutoWired")});e(x);x.AutoWired;var D=r(function(t,e){e.Param=b.createParamDecorator("Param")});e(D);D.Param;var I=r(function(t,e){e.Method=b.createMethodDecorator("Method")});e(I);I.Method;var S=r(function(t,e){e.Singleton=b.createClassDecorator("Singleton",null,function(t){return t.singleton=!0,t})});e(S);S.Singleton;var O=r(function(t,e){e.Abstract=b.createClassDecorator("Abstract")});e(O);O.Abstract;var N=r(function(t,e){e.Autorun=b.createClassMethodDecorator("Autorun",function(t){t.next({isMetadata:function(t){return A.isClassMetadata(t,["autorun"])},match:function(t){return A.isString(t)},setMetadata:function(t,e){t.autorun=e}})})});e(N);N.Autorun;var R=r(function(t,e){e.IocModule=b.createClassDecorator("IocModule",function(t){t.next({isMetadata:function(t){return A.isClassMetadata(t,["autorun"])},match:function(t){return A.isString(t)},setMetadata:function(t,e){t.autorun=e}})})});e(R);R.IocModule;var _=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(T),e(k),e(w),e(x),e(D),e(I),e(S),e(O),e(N),e(R)});e(_);var E=r(function(t,r){var e=function(){function t(){}return t.prototype.isEmpty=function(){return!0},t.prototype.add=function(t){return this},t.prototype.remove=function(t){return this},t.prototype.find=function(t,e){return r.NullNode},t.prototype.filter=function(t,e){return[]},t.prototype.each=function(t,e){},t.prototype.trans=function(t){},t.prototype.transAfter=function(t){},t.prototype.routeUp=function(t){},t.prototype.equals=function(t){return t===r.NullNode},t.prototype.empty=function(){return r.NullNode},t.classAnnations={name:"NullComponent",params:{isEmpty:[],add:["action"],remove:["action"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],trans:["express"],transAfter:["express"],routeUp:["express"],equals:["node"],empty:[]}},t}();r.NullComponent=e,r.NullNode=new e});e(E);E.NullComponent,E.NullNode;var j=r(function(t,e){var r=function(){function t(t){this.name=t,this.children=[]}return t.prototype.add=function(t){return(t.parent=this).children.push(t),this},t.prototype.remove=function(e){var t;return(t=A.isString(e)?this.find(function(t){return A.isString(e)?t.name===e:t.equals(e)}):e||this).parent&&(this.equals(t.parent)?(this.children.splice(this.children.indexOf(t),1),t.parent=null):t.parent.remove(t)),this},t.prototype.find=function(e,t){var r;return this.each(function(t){return!r&&(!(A.isFunction(e)?e(t):e===t)||(r=t,!1))},t),r||this.empty()},t.prototype.filter=function(e,t){var r=[];return this.each(function(t){e(t)&&r.push(t)},t),r},t.prototype.each=function(t,e){var r;switch(e=e||f.Mode.traverse){case f.Mode.route:r=this.routeUp(t);break;case f.Mode.children:r=this.eachChildren(t);break;case f.Mode.traverse:r=this.trans(t);break;case f.Mode.traverseLast:r=this.transAfter(t);break;default:r=this.trans(t)}return r},t.prototype.eachChildren=function(e){(this.children||[]).forEach(function(t){return e(t)})},t.prototype.routeUp=function(t){return!1!==t(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(t):void 0)},t.prototype.trans=function(t){if(!1===t(this))return!1;for(var e=this.children||[],r=0;r<e.length;r++){var n=e[r].trans(t);if(!1===n)return n}return!0},t.prototype.transAfter=function(t){for(var e=this.children||[],r=0;r<e.length;r++){if(!1===e[r].transAfter(t))return!1}return!1!==t(this)},t.prototype.equals=function(t){return this===t},t.prototype.empty=function(){return E.NullNode},t.prototype.isEmpty=function(){return this.equals(this.empty())},t.classAnnations={name:"Composite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],eachChildren:["express"],routeUp:["express"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},t}();e.Composite=r});e(j);j.Composite;var F=r(function(t,e){var r=function(){function t(t){this.name=t,this.children=[]}return t.prototype.add=function(t){return(t.parent=this).children.push(t),this},t.prototype.remove=function(e){var t;return(t=A.isString(e)?this.find(function(t){return A.isString(e)?t.name===e:t.equals(e)}):e||this).parent?this.equals(t.parent)?(this.children.splice(this.children.indexOf(t),1),t.parent=null,this):(t.parent.remove(t),null):this},t.prototype.find=function(e,t){var r;return this.each(function(t){return!r&&(!(A.isFunction(e)?e(t):e===t)||(r=t,!1))},t),r||this.empty()},t.prototype.filter=function(e,t){var r=[];return this.each(function(t){e(t)&&r.push(t)},t),r},t.prototype.each=function(t,e){var r;switch(e=e||f.Mode.traverse){case f.Mode.route:r=this.routeUp(t);break;case f.Mode.children:r=this.eachChildren(t);break;case f.Mode.traverse:r=this.trans(t);break;case f.Mode.traverseLast:r=this.transAfter(t);break;default:r=this.trans(t)}return r},t.prototype.eachChildren=function(e){(this.children||[]).forEach(function(t){return e(t)})},t.prototype.routeUp=function(t){return!1!==t(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(t):void 0)},t.prototype.trans=function(t){if(!1===t(this))return!1;for(var e=this.children||[],r=0;r<e.length;r++){var n=e[r].trans(t);if(!1===n)return n}return!0},t.prototype.transAfter=function(t){for(var e=this.children||[],r=0;r<e.length;r++){if(!1===e[r].transAfter(t))return!1}return!1!==t(this)},t.prototype.equals=function(t){return this===t},t.prototype.empty=function(){return E.NullNode},t.prototype.isEmpty=function(){return this.equals(this.empty())},t.classAnnations={name:"GComposite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["iterate","mode"],eachChildren:["iterate"],routeUp:["iterate"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},t}();e.GComposite=r});e(F);F.GComposite;var L=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(j),e(F),e(E)});e(L);var B=r(function(t,r){var n,o=s&&s.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.insert=function(t,e){return this},e.prototype.execute=function(t,e,r){},e.prototype.empty=function(){return r.NullAction},e.classAnnations={name:"NullActionClass",params:{insert:["action","index"],execute:["container","data","name"],empty:[]}},e}(L.NullComponent);r.NullAction=new e});e(B);B.NullAction;var K=r(function(t,e){var r=function(r){function o(t){var e=r.call(this,t)||this;return e.children=[],e}return __extends(o,r),o.prototype.insert=function(t,e){return t.parent=this,e<0?e=0:e>=this.children.length&&(e=this.children.length-1),this.children.splice(e,0,t),this},o.prototype.execute=function(e,r,n){n?this.find(function(t){return t.name===n}).execute(e,r):this.trans(function(t){t instanceof o&&t.working(e,r)})},o.prototype.empty=function(){return B.NullAction},o.prototype.working=function(t,e){},o.classAnnations={name:"ActionComposite",params:{constructor:["name"],insert:["node","index"],execute:["container","data","name"],empty:[],working:["container","data"]}},o}(L.GComposite);e.ActionComposite=r});e(K);K.ActionComposite;var U=r(function(t,e){var r;(r=e.LifeState||(e.LifeState={})).beforeCreateArgs="beforeCreateArgs",r.beforeConstructor="beforeConstructor",r.afterConstructor="afterConstructor",r.onInit="onInit",r.AfterInit="AfterInit"});e(U);U.LifeState;var q=r(function(t,e){var r;(r=e.CoreActions||(e.CoreActions={})).bindParameterType="bindParameterType",r.bindPropertyType="bindPropertyType",r.injectProperty="injectProperty",r.bindProvider="bindProvider",r.bindParameterProviders="bindParameterProviders",r.cache="cache",r.componentBeforeInit="componentBeforeInit",r.componentInit="componentInit",r.componentAfterInit="componentAfterInit",r.singletion="singletion",r.autorun="autorun"});e(q);q.CoreActions;var V=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.bindProvider)||this}return __extends(e,t),e.prototype.working=function(o,t){t.target;var a=t.targetType,e=(t.propertyKey,o.getLifeScope().getClassDecorators(function(t){return t.actions.includes(q.CoreActions.bindProvider)&&b.hasOwnClassMetadata(t.name,a)})),i=[];e.forEach(function(t){var e=b.getOwnTypeMetadata(t.name,a);if(Array.isArray(e)&&0<e.length){var r=e.find(function(t){return t&&!!t.provide});if(r){var n=o.getTokenKey(r.provide,r.alias);i.push(n),o.bindProvider(n,r.type)}}}),t.execResult=i},e.classAnnations={name:"BindProviderAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.BindProviderAction=r});e(V);V.BindProviderAction;var z=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.bindParameterType)||this}return __extends(e,t),e.prototype.working=function(n,t){var o,r=t.target,a=t.targetType,i=t.propertyKey,s=n.getLifeScope();(o=(o=r&&i?Reflect.getMetadata("design:paramtypes",r,i)||[]:Reflect.getMetadata("design:paramtypes",a)||[]).slice(0)).forEach(function(t){s.isVaildDependence(t)&&(n.has(t)||n.register(t))}),s.getParameterDecorators(function(t){return t.actions.includes(q.CoreActions.bindParameterType)&&(r||"constructor"!==i?b.hasParamMetadata(t.name,r,i):b.hasOwnParamMetadata(t.name,a))}).forEach(function(t){var e=r||"constructor"!==i?b.getParamMetadata(t.name,r,i):b.getOwnParamMetadata(t.name,a);A.isArray(e)&&e.length&&e.forEach(function(t){var e=A.isArray(t)&&0<t.length?t[0]:null;if(e&&0<=e.index){s.isVaildDependence(e.provider)&&(n.has(e.provider,e.alias)||n.register(n.getToken(e.provider,e.alias))),s.isVaildDependence(e.type)&&(n.has(e.type)||n.register(e.type));var r=e.provider?n.getTokenKey(e.provider,e.alias):e.type;r&&(o[e.index]=r)}})}),t.execResult=o},e.classAnnations={name:"BindParameterTypeAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.BindParameterTypeAction=r});e(z);z.BindParameterTypeAction;var G=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.bindPropertyType)||this}return __extends(e,t),e.prototype.working=function(n,t){t.target;var o=t.targetType,a=n.getLifeScope(),e=a.getPropertyDecorators(function(t){return t.actions.includes(q.CoreActions.bindPropertyType)&&b.hasPropertyMetadata(t.name,o)}),i=[];e.forEach(function(t){var e=b.getPropertyMetadata(t.name,o);for(var r in e)i=i.concat(e[r]);(i=i.filter(function(t){return!!t})).forEach(function(t){a.isVaildDependence(t.provider)&&(n.has(t.provider,t.alias)||n.register(n.getToken(t.provider,t.alias))),a.isVaildDependence(t.type)&&(n.has(t.type)||n.register(t.type))})}),t.execResult=i},e.classAnnations={name:"BindPropertyTypeAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.BindPropertyTypeAction=r});e(G);G.BindPropertyTypeAction;var W=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.injectProperty)||this}return __extends(e,t),e.prototype.working=function(n,o){o.execResult||this.parent.find(function(t){return t.name===q.CoreActions.bindPropertyType}).execute(n,o),o.target&&o.execResult&&o.execResult.length&&o.execResult.reverse().forEach(function(t,e){if(t){var r=t.provider?n.getToken(t.provider,t.alias):t.type;n.has(r)&&(o.target[t.propertyKey]=n.resolve.apply(n,[r].concat(o.providers||[])))}})},e.classAnnations={name:"InjectPropertyAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.InjectPropertyAction=r});e(W);W.InjectPropertyAction;var $=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.bindParameterProviders)||this}return __extends(e,t),e.prototype.working=function(t,e){e.target;var r=e.targetType,n=e.propertyKey,o=t.getLifeScope().getMethodDecorators(function(t){return t.actions.includes(q.CoreActions.bindParameterProviders)&&b.hasOwnMethodMetadata(t.name,r)}),a=[];o.forEach(function(t){var e=b.getOwnMethodMetadata(t.name,r)[n];e&&A.isArray(e)&&0<e.length&&e.forEach(function(t){t.providers&&0<t.providers.length&&(a=a.concat(t.providers))})}),e.execResult=a},e.classAnnations={name:"BindParameterProviderAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.BindParameterProviderAction=r});e($);$.BindParameterProviderAction;var Z=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.componentBeforeInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;A.isFunction(r.beforeInit)&&t.syncInvoke(e.targetType,"beforeInit",e.target)}},e.classAnnations={name:"ComponentBeforeInitAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.ComponentBeforeInitAction=r});e(Z);Z.ComponentBeforeInitAction;var H=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.componentInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;A.isFunction(r.onInit)&&t.syncInvoke(e.targetType,"onInit",e.target)}},e.classAnnations={name:"ComponentInitAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.ComponentInitAction=r});e(H);H.ComponentInitAction;var J=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.componentAfterInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;A.isFunction(r.afterInit)&&t.syncInvoke(e.targetType,"afterInit",e.target)}},e.classAnnations={name:"ComponentAfterInitAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.ComponentAfterInitAction=r});e(J);J.ComponentAfterInitAction;var Q=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.cache)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.singleton||!e.targetType||!A.isClass(e.targetType))return e;var r=t.get(A.symbols.ICacheManager);if(e.target){if(!r.hasCache(e.targetType))(n=this.getCacheMetadata(t,e))&&r.cache(e.targetType,e.target,n.expires)}else{var n,o=r.get(e.targetType);if(o)(n=this.getCacheMetadata(t,e))&&(r.cache(e.targetType,o,n.expires),e.execResult=o)}return e},e.prototype.getCacheMetadata=function(t,e){for(var r,n=t.getLifeScope().getClassDecorators(function(t){return b.hasOwnClassMetadata(t.name,e.targetType)}),o=0;o<n.length;o++){var a=n[o],i=b.getOwnTypeMetadata(a.name,e.targetType);if(Array.isArray(i)&&0<i.length&&(r=i.find(function(t){return t&&A.isNumber(t.expires)&&0<t.expires})))break}return r},e.classAnnations={name:"CacheAction",params:{constructor:[],working:["container","data"],getCacheMetadata:["container","data"]}},e}(K.ActionComposite);e.CacheAction=r});e(Q);Q.CacheAction;var X=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.singletion)||this}return __extends(e,t),e.prototype.working=function(t,e){e.tokenKey&&e.target&&e.singleton&&t.registerValue(e.tokenKey,e.target)},e.classAnnations={name:"SingletionAction",params:{constructor:[],working:["container","data"]}},e}(K.ActionComposite);e.SingletionAction=r});e(X);X.SingletionAction;var Y=r(function(t,e){var r=function(t){function e(){return t.call(this,q.CoreActions.autorun)||this}return __extends(e,t),e.prototype.getDecorator=function(){return[_.IocModule,_.Autorun]},e.prototype.working=function(a,i){i.tokenKey&&i.targetType&&this.getDecorator().forEach(function(t){if(b.hasClassMetadata(t,i.targetType)){var e=(o=b.getTypeMetadata(t,i.targetType)).find(function(t){return!!t.autorun});if(!e&&o.length&&(e=o[0]),e){var r=a.get(i.tokenKey);r&&e.autorun&&A.isFunction(r[e.autorun])&&a.syncInvoke(i.tokenKey,e.autorun,r)}}else if(b.hasMethodMetadata(t,i.targetType)){var n,o=b.getMethodMetadata(t,i.targetType);A.lang.forIn(o,function(t){t&&!n&&(n=t.find(function(t){return!!t.autorun}))}),n&&n.autorun&&a.syncInvoke(i.tokenKey,n.autorun)}})},e.classAnnations={name:"AutorunAction",params:{constructor:[],getDecorator:[],working:["container","data"]}},e}(K.ActionComposite);e.AutorunAction=r});e(Y);Y.AutorunAction;var tt=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(K),e(U),e(q),e(B),e(V),e(z),e(G),e(W),e($),e(Z),e(H),e(J),e(Q),e(X),e(Y)});e(tt);var et=r(function(t,e){var r=function(){function t(){}return t.prototype.create=function(t){var e;switch(t){case tt.CoreActions.bindParameterType:e=new tt.BindParameterTypeAction;break;case tt.CoreActions.bindPropertyType:e=new tt.BindPropertyTypeAction;break;case tt.CoreActions.injectProperty:e=new tt.InjectPropertyAction;break;case tt.CoreActions.bindProvider:e=new tt.BindProviderAction;break;case tt.CoreActions.bindParameterProviders:e=new tt.BindParameterProviderAction;break;case tt.CoreActions.componentInit:e=new tt.ComponentInitAction;break;case tt.CoreActions.componentBeforeInit:e=new tt.ComponentBeforeInitAction;break;case tt.CoreActions.componentAfterInit:e=new tt.ComponentAfterInitAction;break;case tt.CoreActions.cache:e=new tt.CacheAction;break;case tt.CoreActions.singletion:e=new tt.SingletionAction;break;case tt.CoreActions.autorun:e=new tt.AutorunAction;break;default:e=new tt.ActionComposite(t)}return e},t.classAnnations={name:"ActionFactory",params:{create:["type"]}},t}();e.ActionFactory=r});e(et);et.ActionFactory;var rt=r(function(t,e){var r=function(){function t(t){this.container=t,this.decorators=[],this.buildAction()}return t.prototype.addAction=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.action;return e.forEach(function(e){n=n.find(function(t){return t.name===e})}),n&&n.add(t),this},t.prototype.registerDecorator=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getDecoratorType(t);return this.registerCustomDecorator.apply(this,[t,n].concat(e))},t.prototype.registerCustomDecorator=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this.toActionName(e),a=t.toString();return this.decorators.some(function(t){return t.name===a})||this.decorators.push({name:a,types:o,actions:r}),this},t.prototype.execute=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e=e.filter(function(t){return!!t});var n=this.action;e.forEach(function(e){n=n.find(function(t){return t.name===e})}),n&&n.execute(this.container,t)},t.prototype.getClassDecorators=function(t){return this.getTypeDecorators(this.toActionName(b.DecoratorType.Class),t)},t.prototype.getMethodDecorators=function(t){return this.getTypeDecorators(this.toActionName(b.DecoratorType.Method),t)},t.prototype.getPropertyDecorators=function(t){return this.getTypeDecorators(this.toActionName(b.DecoratorType.Property),t)},t.prototype.getParameterDecorators=function(t){return this.getTypeDecorators(this.toActionName(b.DecoratorType.Parameter),t)},t.prototype.getDecoratorType=function(t){return t.decoratorType||b.DecoratorType.All},t.prototype.isVaildDependence=function(e){return!!e&&(!!A.isClass(e)&&(!A.isAbstractDecoratorClass(e)&&this.getClassDecorators().some(function(t){return b.hasOwnClassMetadata(t.name,e)})))},t.prototype.getAtionByName=function(e){return this.action.find(function(t){return t.name===e})},t.prototype.getClassAction=function(){return this.getAtionByName(this.toActionName(b.DecoratorType.Class))},t.prototype.getMethodAction=function(){return this.getAtionByName(this.toActionName(b.DecoratorType.Method))},t.prototype.getPropertyAction=function(){return this.getAtionByName(this.toActionName(b.DecoratorType.Property))},t.prototype.getParameterAction=function(){return this.getAtionByName(this.toActionName(b.DecoratorType.Parameter))},t.prototype.getConstructorParameters=function(t){return this.getParameters(t)},t.prototype.getMethodParameters=function(t,e,r){return this.getParameters(t,e,r)},t.prototype.getParamerterNames=function(t,e){var r=b.getOwnParamerterNames(t),n=[];return r&&r.hasOwnProperty(e)&&(n=r[e]),A.isArray(n)||(n=[]),n},t.prototype.isSingletonType=function(r){return!!b.hasOwnClassMetadata(_.Singleton,r)||this.getClassDecorators().some(function(t){var e=b.getOwnTypeMetadata(t.name,r)||[];return!!A.isArray(e)&&e.some(function(t){return!0===t.singleton})})},t.prototype.getMethodMetadatas=function(r,n){var o=[];return this.getMethodDecorators().forEach(function(t){var e=b.getOwnMethodMetadata(t.name,r);e.hasOwnProperty(n)&&(o=o.concat(e[n]||[]))}),o},t.prototype.filerDecorators=function(t){return this.decorators.filter(t)},t.prototype.getParameters=function(t,e,r){var n={target:e,targetType:t,propertyKey:r=r||"constructor"};this.execute(n,tt.LifeState.onInit,tt.CoreActions.bindParameterType);var o=this.getParamerterNames(t,r);return n.execResult.length?n.execResult.map(function(t,e){return{type:t,name:o[e]}}):o.map(function(t){return{name:t,type:void 0}})},t.prototype.getTypeDecorators=function(r,n){return this.filerDecorators(function(t){var e=0<=(t.types||"").indexOf(r);return e&&n&&(e=n(t)),e})},t.prototype.buildAction=function(){var t=new et.ActionFactory,e=t.create("");e.add(t.create(f.IocState.design).add(t.create(tt.CoreActions.bindProvider)).add(t.create(tt.CoreActions.autorun))).add(t.create(f.IocState.runtime).add(t.create(tt.LifeState.beforeCreateArgs)).add(t.create(tt.LifeState.beforeConstructor)).add(t.create(tt.LifeState.afterConstructor)).add(t.create(tt.LifeState.onInit).add(t.create(tt.CoreActions.componentBeforeInit)).add(t.create(this.toActionName(b.DecoratorType.Class))).add(t.create(this.toActionName(b.DecoratorType.Method))).add(t.create(this.toActionName(b.DecoratorType.Property)).add(t.create(tt.CoreActions.bindPropertyType)).add(t.create(tt.CoreActions.injectProperty))).add(t.create(this.toActionName(b.DecoratorType.Parameter)).add(t.create(tt.CoreActions.bindParameterType)).add(t.create(tt.CoreActions.bindParameterProviders))).add(t.create(tt.CoreActions.componentInit))).add(t.create(tt.LifeState.AfterInit).add(t.create(tt.CoreActions.singletion)).add(t.create(tt.CoreActions.componentAfterInit)))).add(t.create(tt.CoreActions.cache)),this.action=e},t.prototype.toActionName=function(t){var e=[];return t&b.DecoratorType.Class&&e.push("ClassDecorator"),t&b.DecoratorType.Method&&e.push("MethodDecorator"),t&b.DecoratorType.Property&&e.push("PropertyDecorator"),t&b.DecoratorType.Parameter&&e.push("ParameterDecorator"),e.join(",")},t.classAnnations={name:"DefaultLifeScope",params:{constructor:["container"],addAction:["action","nodepaths"],registerDecorator:["decorator","actions"],registerCustomDecorator:["decorator","type","actions"],execute:["data","names"],getClassDecorators:["match"],getMethodDecorators:["match"],getPropertyDecorators:["match"],getParameterDecorators:["match"],getDecoratorType:["decirator"],isVaildDependence:["target"],getAtionByName:["name"],getClassAction:[],getMethodAction:[],getPropertyAction:[],getParameterAction:[],getConstructorParameters:["type"],getMethodParameters:["type","instance","propertyKey"],getParamerterNames:["type","propertyKey"],isSingletonType:["type"],getMethodMetadatas:["type","propertyKey"],filerDecorators:["express"],getParameters:["type","instance","propertyKey"],getTypeDecorators:["decType","match"],buildAction:[],toActionName:["type"]}},t}();e.DefaultLifeScope=r});e(rt);rt.DefaultLifeScope;var nt=r(function(t,e){var r=s&&s.__awaiter||function(a,i,s,c){return new(s||(s=Promise))(function(t,e){function r(t){try{o(c.next(t))}catch(t){e(t)}}function n(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(r,n)}o((c=c.apply(a,i||[])).next())})},f=s&&s.__generator||function(r,n){var o,a,i,t,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=a[2&e[0]?"return":e[0]?"throw":"next"])&&!(i=i.call(a,e[1])).done)return i;switch(a=0,i&&(e=[0,i.value]),e[0]){case 0:case 1:i=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){s.label=e[1];break}if(6===e[0]&&s.label<i[1]){s.label=i[1],i=e;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(e);break}i[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(r,s)}catch(t){e=[6,t],a=0}finally{o=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},n=function(){function t(t){this.container=t}return t.prototype.getMatcher=function(){return this.container.get(A.symbols.IProviderMatcher)},t.prototype.invoke=function(s,c,u){for(var p=[],t=3;t<arguments.length;t++)p[t-3]=arguments[t];return r(this,void 0,void 0,function(){var e,r,n,o,a,i;return f(this,function(t){switch(t.label){case 0:if(u||(u=(i=this.container).resolve.apply(i,[s].concat(p))),!(e=this.container.getTokenImpl(s)))throw Error(s.toString()+" is not implements by any class.");return u&&A.isFunction(u[c])?(r={target:u,targetType:e,propertyKey:c},(n=this.container.getLifeScope()).execute(r,tt.LifeState.onInit,tt.CoreActions.bindParameterProviders),p=p.concat(r.execResult),o=n.getMethodParameters(e,u,c),[4,this.createParams.apply(this,[o].concat(p))]):[3,2];case 1:return a=t.sent(),[2,u[c].apply(u,a)];case 2:throw new Error("type: "+e+" has no method "+c+".");case 3:return[2]}})})},t.prototype.syncInvoke=function(t,e,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];r||(r=(a=this.container).resolve.apply(a,[t].concat(n)));var a,i=this.container.getTokenImpl(t);if(!i)throw Error(t.toString()+" is not implements by any class.");if(r&&A.isFunction(r[e])){var s={target:r,targetType:i,propertyKey:e},c=this.container.getLifeScope();c.execute(s,tt.LifeState.onInit,tt.CoreActions.bindParameterProviders),n=n.concat(s.execResult);var u=c.getMethodParameters(i,r,e),p=this.createSyncParams.apply(this,[u].concat(n));return r[e].apply(r,p)}throw new Error("type: "+i+" has no method "+e+".")},t.prototype.createSyncParams=function(t){for(var n=this,o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];var r,a=(r=this.getMatcher()).matchProviders.apply(r,[t].concat(o));return t.map(function(t,e){return t.name&&a.has(t.name)?a.resolve(t.name):A.isToken(t.type)?(r=n.container).resolve.apply(r,[t.type].concat(o)):void 0;var r})},t.prototype.createParams=function(t){for(var n=this,o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];var r,a=(r=this.getMatcher()).matchProviders.apply(r,[t].concat(o));return Promise.all(t.map(function(t,e){return t.name&&a.has(t.name)?a.resolve(t.name):A.isToken(t.type)?(r=n.container).resolve.apply(r,[t.type].concat(o)):void 0;var r}))},t.classAnnations={name:"MethodAccessor",params:{constructor:["container"],getMatcher:[],invoke:["token","propertyKey","target","providers"],syncInvoke:["token","propertyKey","target","providers"],createSyncParams:["params","providers"],createParams:["params","providers"]}},t}();e.MethodAccessor=n});e(nt);nt.MethodAccessor;var ot=r(function(t,e){var r=function(){function t(t){this.container=t,this.maps=new A.MapSet}return t.prototype.has=function(t){return this.maps.has(t)},t.prototype.get=function(t){return this.maps.get(t)},t.prototype.add=function(t,n){var e,o=this;return A.isUndefined(t)||(e=A.isToken(n)&&this.container.has(n)?function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=o.container).resolve.apply(t,[n].concat(e))}:A.isFunction(n)?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,[o.container].concat(t))}:function(){return n},this.maps.set(t,e)),this},t.prototype.remove=function(t){return this.maps.has(t)&&this.maps.delete(t),this},t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.maps.has(t))return!A.isNumber(t)&&this.container.has(t)?(n=this.container).resolve.apply(n,[t].concat(e)):null;var n,o,a=this.maps.get(t);return A.isToken(a)?(o=this.container).resolve.apply(o,[a].concat(e)):a.apply(void 0,e)},t.prototype.forEach=function(t){this.maps.forEach(t)},t.prototype.copy=function(t){var r=this;t&&t.forEach(function(t,e){r.maps.set(e,t)})},t.classAnnations={name:"ProviderMap",params:{constructor:["container"],has:["provide"],get:["provide"],add:["provide","provider"],remove:["provide"],resolve:["provide","providers"],forEach:["express"],copy:["map"]}},t}();e.ProviderMap=r});e(ot);ot.ProviderMap;var at=r(function(t,e){var r=function(){function r(t,e){this.type=t,this.value=e}return r.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return A.isUndefined(this.value)?t.has(this.type)?t.resolve.apply(t,[this.type].concat(e)):null:this.value},r.create=function(t,e){return new r(t,e)},r.createExtends=function(t,e,r){return new i(t,e,r)},r.createCustom=function(t,e,r){return new n(t,e,r)},r.createInvoke=function(t,e,r){return new o(t,e,r)},r.createParam=function(t,e,r,n){return new a(t,e,r,n)},r.createAsyncParam=function(t,e,r,n,o){return new s(t,e,r,n,o)},r.classAnnations={name:"Provider",params:{constructor:["type","value"],resolve:["container","providers"],create:["type","value"],createExtends:["token","value","extendsTarget"],createCustom:["type","toInstance","value"],createInvoke:["token","method","value"],createParam:["token","value","index","method"],createAsyncParam:["files","token","index","method","value"]}},r}(),n=function(o){function t(t,e,r){var n=o.call(this,t,r)||this;return n.toInstance=e,n}return __extends(t,o),t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.toInstance?this.toInstance.apply(this,[t].concat(e)):o.prototype.resolve.apply(this,[t].concat(e))},t.classAnnations={name:"CustomProvider",params:{constructor:["type","toInstance","value"],resolve:["container","providers"]}},t}(e.Provider=r);e.CustomProvider=n;var o=function(o){function t(t,e,r){var n=o.call(this,t,r)||this;return n.method=e,n}return __extends(t,o),t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.method?t.syncInvoke.apply(t,[this.type,this.method].concat(e)):o.prototype.resolve.apply(this,[t].concat(e))},t.classAnnations={name:"InvokeProvider",params:{constructor:["type","method","value"],resolve:["container","providers"]}},t}(r),a=function(a){function t(t,e,r,n){var o=a.call(this,t,n,e)||this;return o.index=r,o}return __extends(t,a),t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return a.prototype.resolve.apply(this,[t].concat(e))},t.classAnnations={name:"ParamProvider",params:{constructor:["token","value","index","method"],resolve:["container","providers"]}},t}(e.InvokeProvider=o);e.ParamProvider=a;var i=function(o){function t(t,e,r){var n=o.call(this,t,e)||this;return n.extendsTarget=r,n}return __extends(t,o),t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return o.prototype.resolve.apply(this,[t].concat(e))},t.prototype.extends=function(t){A.isObject(t)&&A.isFunction(this.extendsTarget)&&this.extendsTarget(t,this)},t.classAnnations={name:"ExtendsProvider",params:{constructor:["token","value","extendsTarget"],resolve:["container","providers"],extends:["target"]}},t}(r);e.ExtendsProvider=i;var s=function(i){function t(t,e,r,n,o){var a=i.call(this,e,o,r,n)||this;return a.files=t,a}return __extends(t,i),t.prototype.resolve=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return t.get(A.symbols.IContainerBuilder).loadModule(t,{files:this.files}).then(function(){return i.prototype.resolve.apply(e,[t].concat(r))})},t.classAnnations={name:"AsyncParamProvider",params:{constructor:["files","token","index","method","value"],resolve:["container","providers"]}},t}(a);e.AsyncParamProvider=s});e(at);at.Provider,at.CustomProvider,at.InvokeProvider,at.ParamProvider,at.ExtendsProvider,at.AsyncParamProvider;var it=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(at),e(ot),r.isProviderMap=function(t){return!!A.isObject(t)&&t instanceof ot.ProviderMap}});e(it);it.isProviderMap;var st=r(function(t,e){var r=function(){function t(t){this.container=t}return t.prototype.toProviderMap=function(){for(var n=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length&&it.isProviderMap(t[0]))return t[0];var o=this.container.resolve(it.ProviderMap);return t.forEach(function(r,t){A.isUndefined(r)||A.isNull(r)||(it.isProviderMap(r)?o.copy(r):r instanceof it.Provider?r instanceof it.ParamProvider?!r.type&&A.isNumber(r.index)?o.add(r.index,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.resolve.apply(r,[n.container].concat(t))}):o.add(r.type,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.resolve.apply(r,[n.container].concat(t))}):o.add(r.type,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.resolve.apply(r,[n.container].concat(t))}):A.isBaseObject(r)?A.lang.forIn(r,function(t,e){A.isUndefined(t)||(A.isClass(t)?o.add(e,t):A.isFunction(t)||A.isString(t)?o.add(e,function(){return t}):o.add(e,t))}):A.isFunction(r)?o.add(name,function(){return r}):o.add(t,r))}),o},t.prototype.matchProviders=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.match(t,this.toProviderMap.apply(this,e))},t.prototype.match=function(t,r){var n=this,o=this.container.resolve(it.ProviderMap);return t.length&&t.forEach(function(t,e){t.name&&(r.has(t.name)?o.add(t.name,r.get(t.name)):A.isToken(t.type)?r.has(t.type)?o.add(t.name,r.get(t.type)):n.container.has(t.type)&&o.add(t.name,t.type):r.has(e)&&o.add(t.name,r.get(e)))}),o},t.classAnnations={name:"ProviderMatcher",params:{constructor:["container"],toProviderMap:["providers"],matchProviders:["params","providers"],match:["params","providers"]}},t}();e.ProviderMatcher=r});e(st);st.ProviderMatcher;var ct=r(function(t,e){var r=function(){function t(t){this.container=t,this.cacheTokens=new A.MapSet}return t.prototype.isChecking=function(){return!!this.timeout},t.prototype.hasCache=function(t){return this.cacheTokens.has(t)},t.prototype.cache=function(t,e,r){var n;this.hasCache(t)?(n=this.cacheTokens.get(t)).expires=Date.now()+r:n={target:e,expires:Date.now()+r},this.cacheTokens.set(t,n),this.isChecking()||this.checkExpires()},t.prototype.get=function(t,e){var r=null;if(!this.cacheTokens.has(t))return null;var n=this.cacheTokens.get(t);return n.expires<=Date.now()?(r=n.target,A.isNumber(e)&&0<e&&(n.expires=Date.now()+e,this.cacheTokens.set(t,n))):this.destroy(t,n.target),r},t.prototype.checkExpires=function(){var e=this;if(this.timeout&&(clearTimeout(this.timeout),this.timeout=0),0<this.cacheTokens.size){var r=[];this.cacheTokens.forEach(function(t,e){t.expires>=Date.now()&&r.push(e)}),r.length&&r.forEach(function(t){e.destroy(t,e.cacheTokens.get(t).target)}),this.timeout=setTimeout(function(){e.checkExpires()},6e4)}},t.prototype.destroy=function(t,e){if(this.hasCache(t)){e||(e=this.cacheTokens.get(t).target);try{var r=e;A.isFunction(r.onDestroy)&&this.container.syncInvoke(t,"onDestroy",e),this.cacheTokens.delete(t)}catch(t){console.error&&console.error(t)}}},t.classAnnations={name:"CacheManager",params:{constructor:["container"],isChecking:[],hasCache:["targetType"],cache:["targetType","target","expires"],get:["targetType","expires"],checkExpires:[],destroy:["targetType","target"]}},t}();e.CacheManager=r});e(ct);ct.CacheManager;var ut=r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(tt),e(_),e(b),e(it),e(et),e(rt),e(st),e(nt),e(ct),r.registerCores=function(t){t.registerSingleton(A.symbols.LifeScope,function(){return new rt.DefaultLifeScope(t)}),t.register(it.ProviderMap,function(){return new it.ProviderMap(t)}),t.registerSingleton(A.symbols.ICacheManager,function(){return new ct.CacheManager(t)}),t.registerSingleton(A.symbols.IProviderMatcher,function(){return new st.ProviderMatcher(t)}),t.registerSingleton(A.symbols.IMethodAccessor,function(){return new nt.MethodAccessor(t)});var e=t.get(A.symbols.LifeScope);e.registerDecorator(_.Injectable,tt.CoreActions.bindProvider,tt.CoreActions.cache),e.registerDecorator(_.Component,tt.CoreActions.bindProvider,tt.CoreActions.cache,tt.CoreActions.componentBeforeInit,tt.CoreActions.componentInit,tt.CoreActions.componentAfterInit),e.registerDecorator(_.Singleton,tt.CoreActions.bindProvider),e.registerDecorator(_.Abstract,tt.CoreActions.bindProvider,tt.CoreActions.cache),e.registerDecorator(_.AutoWired,tt.CoreActions.bindParameterType,tt.CoreActions.bindPropertyType),e.registerDecorator(_.Inject,tt.CoreActions.bindParameterType,tt.CoreActions.bindPropertyType),e.registerDecorator(_.Param,tt.CoreActions.bindParameterType,tt.CoreActions.bindPropertyType),e.registerDecorator(_.Method,tt.CoreActions.bindParameterProviders),e.registerDecorator(_.Autorun,tt.CoreActions.autorun),e.registerDecorator(_.IocModule,tt.CoreActions.autorun,tt.CoreActions.componentBeforeInit,tt.CoreActions.componentInit,tt.CoreActions.componentAfterInit),t.register(Date,function(){return new Date}),t.register(String,function(){return""}),t.register(Number,function(){return Number.NaN}),t.register(Boolean,function(){})}});e(ut);ut.registerCores;var pt=r(function(t,e){var r=function(){function t(){this.init()}return t.prototype.get=function(t,e){return this.resolve(e?this.getTokenKey(t,e):t)},t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getTokenKey(t);return this.hasRegister(n)?this.factories.get(n).apply(void 0,e):(console.error("have not register",n),null)},t.prototype.clearCache=function(t){this.get(A.symbols.ICacheManager).destroy(t)},t.prototype.getToken=function(t,e){return t instanceof d.Registration?t:e&&A.isFunction(t)?new d.Registration(t,e):t},t.prototype.getTokenKey=function(t,e){return t instanceof d.Registration?t.toString():e?new d.Registration(t,e).toString():t},t.prototype.register=function(t,e){return this.registerFactory(t,e),this},t.prototype.has=function(t,e){var r=this.getTokenKey(t,e);return this.hasRegister(r)},t.prototype.hasRegister=function(t){return this.factories.has(t)},t.prototype.unregister=function(t){var e=this.getTokenKey(t);return this.hasRegister(e)&&this.factories.delete(e),this},t.prototype.registerSingleton=function(t,e){return this.registerFactory(t,e,!0),this},t.prototype.registerValue=function(t,e){var r=this,n=this.getTokenKey(t);return this.singleton.set(n,e),this.factories.has(n)||this.factories.set(n,function(){return r.singleton.get(n)}),this},t.prototype.bindProvider=function(t,r){var e,n=this,o=this.getTokenKey(t);if(e=A.isToken(r)?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.resolve.apply(n,[r].concat(t))}:A.isFunction(r)?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.apply(void 0,[n].concat(t))}:function(){return r},A.isClass(r))this.provideTypes.set(t,r);else if(A.isToken(r))for(var a=r;this.provideTypes.has(a)&&!A.isClass(a);)if(a=this.provideTypes.get(a),A.isClass(a)){this.provideTypes.set(t,a);break}return this.factories.set(o,e),this},t.prototype.getTokenImpl=function(t){return A.isClass(t)?t:this.provideTypes.has(t)?this.provideTypes.get(t):null},t.prototype.getLifeScope=function(){return this.get(A.symbols.LifeScope)},t.prototype.use=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this.get(A.symbols.IContainerBuilder)).syncLoadModule.apply(t,[this].concat(e)),this},t.prototype.invoke=function(t,e,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(A.symbols.IMethodAccessor)).invoke.apply(n,[t,e,r].concat(o))},t.prototype.syncInvoke=function(t,e,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(A.symbols.IMethodAccessor)).syncInvoke.apply(n,[t,e,r].concat(o))},t.prototype.createSyncParams=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(e=this.get(A.symbols.IMethodAccessor)).createSyncParams.apply(e,[t].concat(r))},t.prototype.createParams=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(e=this.get(A.symbols.IMethodAccessor)).createParams.apply(e,[t].concat(r))},t.prototype.cacheDecorator=function(t,e){t.has(e.name)||t.set(e.name,e)},t.prototype.init=function(){var t=this;this.factories=new A.MapSet,this.singleton=new A.MapSet,this.provideTypes=new A.MapSet,this.bindProvider(A.symbols.IContainer,function(){return t}),ut.registerCores(this)},t.prototype.registerFactory=function(t,e,r){var n=this.getTokenKey(t);if(!this.factories.has(n)){var o;if(A.isUndefined(e)){if(!A.isString(t)&&!A.isSymbol(t)){var a=t instanceof d.Registration?t.getClass():t;A.isClass(a)&&this.bindTypeFactory(n,a,r)}}else A.isFunction(e)?A.isClass(e)?this.bindTypeFactory(n,e,r):o=this.createCustomFactory(n,e,r):r&&void 0!==e&&(o=this.createCustomFactory(n,function(){return e},r));o&&this.factories.set(n,o)}},t.prototype.createCustomFactory=function(n,o,t){var a=this;return t?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(a.singleton.has(n))return a.singleton.get(n);var r=o.apply(void 0,[a].concat(t));return a.singleton.set(n,r),r}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.apply(void 0,[a].concat(t))}},t.prototype.bindTypeFactory=function(a,i,s){var c=this;if(Reflect.isExtensible(i)){var u=this.getLifeScope(),p=u.getConstructorParameters(i);s||(s=u.isSingletonType(i));this.factories.set(a,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(s&&c.singleton.has(a))return c.singleton.get(a);if(t.length<1){var r={tokenKey:a,targetType:i,singleton:s};if(u.execute(r,ut.CoreActions.cache),r.execResult&&r.execResult instanceof i)return r.execResult}u.execute({tokenKey:a,targetType:i,params:p,providers:t,singleton:s},f.IocState.runtime,ut.LifeState.beforeCreateArgs);var n=c.createSyncParams.apply(c,[p].concat(t));u.execute({tokenKey:a,targetType:i,args:n,params:p,providers:t,singleton:s},f.IocState.runtime,ut.LifeState.beforeConstructor);var o=new(i.bind.apply(i,[void 0].concat(n)));return u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:t,singleton:s},f.IocState.runtime,ut.LifeState.afterConstructor),u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:t,singleton:s},f.IocState.runtime,ut.LifeState.onInit),u.execute({tokenKey:a,target:o,targetType:i,args:n,params:p,providers:t,singleton:s},f.IocState.runtime,ut.LifeState.AfterInit),u.execute({tokenKey:a,target:o,targetType:i},ut.CoreActions.cache),o}),u.execute({tokenKey:a,targetType:i},f.IocState.design)}},t.classAnnations={name:"Container",params:{constructor:[],get:["token","alias"],resolve:["token","providers"],clearCache:["targetType"],getToken:["token","alias"],getTokenKey:["token","alias"],register:["token","value"],has:["token","alias"],hasRegister:["key"],unregister:["token"],registerSingleton:["token","value"],registerValue:["token","value"],bindProvider:["provide","provider"],getTokenImpl:["token"],getLifeScope:[],use:["modules"],invoke:["token","propertyKey","instance","providers"],syncInvoke:["token","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"],cacheDecorator:["map","action"],init:[],registerFactory:["token","value","singleton"],createCustomFactory:["key","factory","singleton"],bindTypeFactory:["key","ClassT","singleton"]}},t}();e.Container=r});e(pt);pt.Container;var ft=r(function(t,e){var r=function(){function t(){}return t.prototype.getLoader=function(){return this._loader||(this._loader=this.createLoader()),this._loader},t.prototype.load=function(t){var e=this;return t.files?Promise.all(t.files).then(function(t){return t.map(function(t){return e.loadModule(t)})}):Promise.resolve([])},t.prototype.loadModule=function(t){return this.getLoader()(t)},t.prototype.createLoader=function(){if(void 0!==n)return function(t){return new Promise(function(t,e){n()})};throw new Error("has not module loader")},t.classAnnations={name:"DefaultModuleLoader",params:{constructor:[],getLoader:[],load:["options"],loadModule:["file"],createLoader:[]}},t}();e.DefaultModuleLoader=r});e(ft);ft.DefaultModuleLoader;var dt=r(function(t,e){var a=s&&s.__awaiter||function(a,i,s,c){return new(s||(s=Promise))(function(t,e){function r(t){try{o(c.next(t))}catch(t){e(t)}}function n(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(r,n)}o((c=c.apply(a,i||[])).next())})},i=s&&s.__generator||function(r,n){var o,a,i,t,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=a[2&e[0]?"return":e[0]?"throw":"next"])&&!(i=i.call(a,e[1])).done)return i;switch(a=0,i&&(e=[0,i.value]),e[0]){case 0:case 1:i=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){s.label=e[1];break}if(6===e[0]&&s.label<i[1]){s.label=i[1],i=e;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(e);break}i[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(r,s)}catch(t){e=[6,t],a=0}finally{o=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},r=function(){function t(t){(this.loader=t)||(this.loader=new ft.DefaultModuleLoader)}return t.prototype.create=function(){var t=this,e=new pt.Container;return e.bindProvider(A.symbols.IContainerBuilder,function(){return t}),e},t.prototype.build=function(r){return a(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=this.create(),r?[4,this.loadModule(e,r)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,e]}})})},t.prototype.loadModule=function(r,n){return a(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.loadTypes(n)];case 1:return e=t.sent(),[2,this.registers(r,e)]}})})},t.prototype.syncBuild=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.create();return t.length&&this.syncLoadModule.apply(this,[r].concat(t)),r},t.prototype.syncLoadModule=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getModules.apply(this,e);return this.registers(t,n)},t.prototype.loadTypes=function(o){return a(this,void 0,void 0,function(){var e,r,n=this;return i(this,function(t){switch(t.label){case 0:return o?[4,this.loader.load(o)]:[3,3];case 1:return e=t.sent(),o.modules&&o.modules.length?[4,Promise.all(o.modules.map(function(t){return A.isString(t)?n.loader.loadModule(t):t}))]:[3,3];case 2:r=t.sent(),e=e.concat(r),t.label=3;case 3:return[2,this.getModules.apply(this,e)]}})})},t.prototype.registers=function(e,t){return(t=t||[]).forEach(function(t){e.register(t)}),t},t.prototype.getModules=function(){for(var n=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=[];return t.forEach(function(t){var e=n.getTypes(t),r=e.find(function(t){return ut.hasOwnClassMetadata(ut.IocModule,t)});r?o.push(r):o.push.apply(o,e)}),o},t.prototype.getTypes=function(t){var e=[];if(A.isClass(t))e.push(t);else{var r=t.exports?t.exports:t;for(var n in r)A.isClass(r[n])&&e.push(r[n])}return e},t.classAnnations={name:"DefaultContainerBuilder",params:{constructor:["loader"],create:[],build:["options"],loadModule:["container","options"],syncBuild:["modules"],syncLoadModule:["container","modules"],loadTypes:["options"],registers:["container","types"],getModules:["modules"],getTypes:["regModule"]}},t}();e.DefaultContainerBuilder=r});e(dt);dt.DefaultContainerBuilder;return e(r(function(t,r){function e(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}e(pt),e(f),e(d),e(ft),e(dt),e(A),e(L),e(ut)}))});