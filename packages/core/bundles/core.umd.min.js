!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("reflect-metadata")):"function"==typeof define&&define.amd?define(["reflect-metadata"],e):(t.core=t.core||{},t.core.umd=t.core.umd||{},t.core.umd.js=e(t.Reflect))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function o(t,e){return t(e={exports:{}},e.exports),e.exports}var a=o(function(t,e){var r,n;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.IocState||(e.IocState={})).design="design",r.runtime="runtime",(n=e.Mode||(e.Mode={}))[n.route=1]="route",n[n.children=2]="children",n[n.traverse=3]="traverse",n[n.traverseLast=4]="traverseLast"});n(a);a.IocState,a.Mode;var i=o(function(t,e){function r(t){return!!t&&"function"==typeof t}function n(t){if(!r(t))return!1;if(t.prototype){if(!t.name||"Object"===t.name)return!1;if(Reflect.hasOwnMetadata("@Abstract",t))return!1;var e=t;if(/^[a-z]$/.test(e.name))return!(!e.classAnnations||!e.classAnnations.name);if(e.classAnnations&&s(e.classAnnations.name))return!0;if(!/^[A-Z@]/.test(t.name))return!1;if(!o()&&/MSIE [6-9]/.test(navigator.userAgent))return!0;try{return t.arguments&&t.caller,!1}catch(t){return!0}}return!1}function o(){return"undefined"!=typeof process&&void 0!==process.versions.node}function a(t){return!!t&&!!(s(t)||u(t)||n(t)||c(t)&&t instanceof p.Registration)}function i(t,e,r){return!!t&&(!a(t)&&(!(t instanceof RegExp||t instanceof Date)&&((!t.constructor||"Object"===t.constructor.name)&&(e=e||["type"],r&&(e=r.concat(e)),Object.keys(t).some(function(t){return e.indexOf(t)>0})))))}function s(t){return"string"==typeof t}function c(t){var e=typeof t;return null!=t&&("object"===e||"function"===e)}function u(t){return"symbol"==typeof t||c(t)&&/^Symbol\(/.test(t.toString())}e.isFunction=r,e.isAbstractDecoratorClass=function(t){return!!r(t)&&!!Reflect.hasOwnMetadata("@Abstract",t)},e.getClassName=function(t){return r(t)?/^[a-z]$/.test(t.name)&&t.classAnnations?t.classAnnations.name:t.name:""},e.isClass=n,e.isNodejsEnv=o,e.isToken=a,e.isPromise=function(t){return!!t&&!(!r(t.then)||!r(t.catch))},e.isObservable=function(t){return!(!t&&!c(t)||!r(t.subscribe)||!r(t.toPromise))},e.isBaseObject=function(t){return!!t&&!(!t.constructor||"Object"!==t.constructor.name)},e.isMetadataObject=i,e.isClassMetadata=function(t,e){return i(t,["singleton","provide","alias","type"],e)},e.isParamMetadata=function(t,e){return i(t,["type","provider","index"],e)},e.isParamPropMetadata=function(t,e){return i(t,["type","provider","index"],e)},e.isPropertyMetadata=function(t,e){return i(t,["type","provider"],e)},e.isString=s,e.isBoolean=function(t){return"boolean"==typeof t||!0===t||!1===t},e.isNumber=function(t){return"number"==typeof t},e.isUndefined=function(t){return void 0===t||void 0===t},e.isNull=function(t){return null===t},e.isArray=function(t){return Array.isArray(t)},e.isObject=c,e.isDate=function(t){return c(t)&&t instanceof Date},e.isSymbol=u,e.isRegExp=function(t){return t&&t instanceof RegExp}});n(i);i.isFunction,i.isAbstractDecoratorClass,i.getClassName,i.isClass,i.isNodejsEnv,i.isToken,i.isPromise,i.isObservable,i.isBaseObject,i.isMetadataObject,i.isClassMetadata,i.isParamMetadata,i.isParamPropMetadata,i.isPropertyMetadata,i.isString,i.isBoolean,i.isNumber,i.isUndefined,i.isNull,i.isArray,i.isObject,i.isDate,i.isSymbol,i.isRegExp;var s=o(function(t,e){var r=function(){function t(){this.valueMap={},this.keyMap={}}return t.prototype.clear=function(){this.valueMap={},this.keyMap={}},t.prototype.getTypeKey=function(t){return i.isString(t)?t:i.isFunction(t)?t.name:t.toString()},t.prototype.delete=function(t){var e=this.getTypeKey(t).toString();try{return delete this.keyMap[e],delete this.valueMap[e],!0}catch(t){return!1}},t.prototype.forEach=function(t,e){var r=this;Object.keys(this.keyMap).forEach(function(e){t(r.valueMap[e],r.keyMap[e],r)})},t.prototype.get=function(t){var e=this.getTypeKey(t);return this.valueMap[e]},t.prototype.has=function(t){var e=this.getTypeKey(t);return!i.isUndefined(this.keyMap[e])},t.prototype.set=function(t,e){var r=this.getTypeKey(t);return this.keyMap[r]=t,this.valueMap[r]=e,this},Object.defineProperty(t.prototype,"size",{get:function(){return Object.keys(this.keyMap).length},enumerable:!0,configurable:!0}),t.classAnnations={name:"ObjectMapSet",params:{constructor:[],clear:[],getTypeKey:["key"],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},t}();e.ObjectMapSet=r;var n=function(){function t(){this.map=i.isClass(Map)?new Map:new r}return t.prototype.clear=function(){this.map.clear()},t.prototype.delete=function(t){return this.map.delete(t)},t.prototype.forEach=function(t,e){this.map.forEach(t,e)},t.prototype.get=function(t){return this.map.get(t)},t.prototype.has=function(t){return this.map.has(t)},t.prototype.set=function(t,e){return this.map.set(t,e),this},Object.defineProperty(t.prototype,"size",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),t.classAnnations={name:"MapSet",params:{constructor:[],clear:[],delete:["key"],forEach:["callbackfn","thisArg"],get:["key"],has:["key"],set:["key","value"]}},t}();e.MapSet=n});n(s);s.ObjectMapSet,s.MapSet;var c=o(function(t,e){e.symbols={IContainer:Symbol("IContainer"),LifeScope:Symbol("LifeScope"),IProviderMatcher:Symbol("IProviderMatcher"),IMethodAccessor:Symbol("IMethodAccessor"),ICacheManager:Symbol("ICacheManager"),IContainerBuilder:Symbol("IContainerBuilder"),IRecognizer:Symbol("IRecognizer")}});n(c);c.symbols;var u=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(i),r(s),r(c)});n(u);var p=o(function(t,e){var r=function(){function t(t,e){this.classType=t,this.desc=e,this.type="Registration"}return t.prototype.getClass=function(){return u.isClass(this.classType)?this.classType:null},t.prototype.getDesc=function(){return this.desc},t.prototype.toString=function(){var t="";return t=u.isFunction(this.classType)?u.getClassName(this.classType):this.classType.toString(),this.type+" "+t+" "+this.desc},t.classAnnations={name:"Registration",params:{constructor:["classType","desc"],getClass:[],getDesc:[],toString:[]}},t}();e.Registration=r});n(p);p.Registration;var f=o(function(t,e){var r=function(){function t(t){this.args=t,this.idx=-1,this.metadata=null}return t.prototype.isCompeted=function(){return this.idx>=this.args.length},t.prototype.end=function(){this.idx=this.args.length},t.prototype.next=function(t){if(this.isCompeted())return null;if(this.idx++,this.isCompeted())return null;var e=this.args[this.idx];t.isMetadata&&t.isMetadata(e)?(this.metadata=e,this.end()):t.match(e)?(this.metadata=this.metadata||{},t.setMetadata(this.metadata,e)):this.end()},t.prototype.getArgs=function(){return this.args},t.prototype.getMetadata=function(){return this.metadata},t.classAnnations={name:"ArgsIterator",params:{constructor:["args"],isCompeted:[],end:[],next:["express"],getArgs:[],getMetadata:[]}},t}();e.ArgsIterator=r});n(f);f.ArgsIterator;var d=o(function(t,e){var r;(r=e.DecoratorType||(e.DecoratorType={}))[r.Class=1]="Class",r[r.Parameter=2]="Parameter",r[r.Property=4]="Property",r[r.Method=8]="Method",r[r.All=13]="All"});n(d);d.DecoratorType;var l=o(function(t,e){function r(t,e,r,i,s){var c;switch(r.length){case 1:if(c=r[0],u.isClass(c)||u.isAbstractDecoratorClass(c))return function(t,e,r,o,a){var i=n(e,r).slice(0),s=o||{};s.type||(s.type=r);s.decorator=t,a&&(s=a(s));i.unshift(s),g(r),Reflect.defineMetadata(e,i,r)}(t,e,c,i,s),c;break;case 2:p(t,e,c=r[0],r[1],i,s);break;case 3:if(u.isNumber(r[2])){!function(t,e,r,n,o,a,i){var s=h(e,r,n).slice(0);for(;s.length<=o;)s.push(null);s[o]=s[o]||[];var c=a||{};if(!c.type){var u=Reflect.getOwnMetadata("design:type",r,n);u||(u=Reflect.getOwnMetadata("design:type",r.constructor,n)),c.type=u}c.propertyKey=n,c.decorator=t,c.index=o,i&&(c=i(c));s[o].unshift(c),Reflect.defineMetadata(e+l,s,r,n)}(t,e,c=r[0],r[1],r[2],i,s)}else{if(!u.isUndefined(r[2])){c=r[0];var f=r[1],d=r[2];return function(t,e,r,n,i,s,c){var u=Object.assign({},a(e,r));u[n]=u[n]||[];var p=s||{};p.decorator=t,p.propertyKey=n,c&&(p=c(p));u[n].unshift(p),Reflect.defineMetadata(e+o,u,r.constructor)}(t,e,c,f,0,i,s),d}p(t,e,c=r[0],r[1],i,s)}break;default:throw new Error("Invalid @"+t+" Decorator declaration.")}}function n(t,e){var r=Reflect.getOwnMetadata(u.isFunction(t)?t.toString():t,e);return r=u.isArray(r)?r:[]}e.ParamerterName="paramerter_names",e.createDecorator=function(t,e,n){var o="@"+t,a=function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var s=null;return a.length<1?function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return r(t,o,e,s,n)}:(s=function(t,e){var r=null;if(t.length)if(1===t.length&&u.isMetadataObject(t[0]))r=t[0];else if(e){var n=new f.ArgsIterator(t);e(n),r=n.getMetadata()}return r}(a,e))?function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return r(t,o,e,s,n)}:1!==a.length||u.isClass(a[0])?r(t,o,a,s,n):function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return r(t,o,e,s,n)}};return a.toString=function(){return o},a.decoratorType=d.DecoratorType.All,a},e.getTypeMetadata=function(t,e){var r=Reflect.getOwnMetadata(u.isFunction(t)?t.toString():t,e);return r=u.isArray(r)?r:[]},e.getOwnTypeMetadata=n,e.hasClassMetadata=function(t,e){var r=u.isFunction(t)?t.toString():t;return Reflect.hasMetadata(r,e)},e.hasOwnClassMetadata=function(t,e){var r=u.isFunction(t)?t.toString():t;return Reflect.hasOwnMetadata(r,e)};var o="__method";function a(t,e){var r=u.isFunction(t)?t.toString():t,n=Reflect.getMetadata(r+o,e);return(!n||u.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getMetadata(r+o,e.constructor)),u.isArray(n)?{}:n||{}}function i(t,e){var r=u.isFunction(t)?t.toString():t,n=Reflect.getOwnMetadata(r+o,e);return(!n||u.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getOwnMetadata(r+o,e.constructor)),u.isArray(n)?{}:n||{}}e.getMethodMetadata=a,e.getOwnMethodMetadata=i,e.hasOwnMethodMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t;if(r){var a=i(n,e);return a&&a.hasOwnProperty(r)}return Reflect.hasOwnMetadata(n+o,e)},e.hasMethodMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t;if(r){var i=a(n,e);return i&&i.hasOwnProperty(r)}return Reflect.hasMetadata(n+o,e)};var s="__props";function c(t,e){var r=u.isFunction(t)?t.toString():t,n=Reflect.getMetadata(r+s,e);return(!n||u.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getMetadata(r+s,e.constructor)),u.isArray(n)?{}:n||{}}function p(t,e,r,n,o,a){var i=Object.assign({},c(e,r)),p=o||{};if(p.propertyKey=n,p.decorator=t,!p.type){var f=Reflect.getMetadata("design:type",r,n);f||(f=Reflect.getMetadata("design:type",r.constructor,n)),p.type=f}a&&(p=a(p)),i[n]&&u.isArray(i[n])||(i[n]=[]),i[n].unshift(p),Reflect.defineMetadata(e+s,i,r.constructor)}e.getPropertyMetadata=c,e.getOwnPropertyMetadata=function(t,e){var r=u.isFunction(t)?t.toString():t,n=Reflect.getOwnMetadata(r+s,e);return(!n||u.isArray(n)||Object.keys(n).length<0)&&(n=Reflect.getOwnMetadata(r+s,e.constructor)),u.isArray(n)?{}:n||{}},e.hasPropertyMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t;if(r){var o=c(n,e);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+s,e)};var l="__params";function h(t,e,r){var n=u.isFunction(t)?t.toString():t,o=Reflect.getOwnMetadata(n+l,e,r);return o=u.isArray(o)?o:[]}function y(t){var r=Reflect.getMetadata(e.ParamerterName,t);return(!r||u.isArray(r)||Object.keys(r).length<0)&&(r=Reflect.getMetadata(e.ParamerterName,t.constructor)),u.isArray(r)?{}:r||{}}function g(t){var r=Object.assign({},y(t)),n=Object.getOwnPropertyDescriptors(t.prototype),o=/^[a-z]/.test(t.name),a="";t.classAnnations&&t.classAnnations.params&&(a=t.classAnnations.name,r=Object.assign(r,t.classAnnations.params)),o||t.name===a||(Object.keys(n).forEach(function(t){"constructor"!==t&&(n[t].value&&(r[t]=A(n[t].value)),n[t].set&&(r[t]=A(n[t].set)))}),r.constructor=A(t.prototype.constructor)),Reflect.defineMetadata(e.ParamerterName,r,t)}e.getParamMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t,o=Reflect.getMetadata(n+l,e,r);return o=u.isArray(o)?o:[]},e.getOwnParamMetadata=h,e.hasParamMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t;return Reflect.hasMetadata(n+l,e,r)},e.hasOwnParamMetadata=function(t,e,r){var n=u.isFunction(t)?t.toString():t;return Reflect.hasOwnMetadata(n+l,e,r)},e.getParamerterNames=y,e.getOwnParamerterNames=function(t){var r=Reflect.getOwnMetadata(e.ParamerterName,t);return(!r||u.isArray(r)||Object.keys(r).length<0)&&(r=Reflect.getOwnMetadata(e.ParamerterName,t.constructor)),u.isArray(r)?{}:r||{}},e.setParamerterNames=g;var v=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,m=/([^\s,]+)/g;function A(t){if(!u.isFunction(t))return[];var e=t.toString().replace(v,""),r=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(m);return null===r&&(r=[]),r}});n(l);l.ParamerterName,l.createDecorator,l.getTypeMetadata,l.getOwnTypeMetadata,l.hasClassMetadata,l.hasOwnClassMetadata,l.getMethodMetadata,l.getOwnMethodMetadata,l.hasOwnMethodMetadata,l.hasMethodMetadata,l.getPropertyMetadata,l.getOwnPropertyMetadata,l.hasPropertyMetadata,l.getParamMetadata,l.getOwnParamMetadata,l.hasParamMetadata,l.hasOwnParamMetadata,l.getParamerterNames,l.getOwnParamerterNames,l.setParamerterNames;var h=o(function(t,e){e.createClassDecorator=function(t,e,r){var n=l.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return u.isClassMetadata(t)},match:function(t){return t&&(u.isSymbol(t)||u.isString(t)||u.isObject(t)&&t instanceof p.Registration)},setMetadata:function(t,e){t.provide=e}}),t.next({match:function(t){return u.isString(t)},setMetadata:function(t,e){t.alias=e}}),t.next({match:function(t){return u.isBoolean(t)},setMetadata:function(t,e){t.singleton=e}}),t.next({match:function(t){return u.isNumber(t)},setMetadata:function(t,e){t.expires=e}})},r);return n.decoratorType=d.DecoratorType.Class,n}});n(h);h.createClassDecorator;var y=o(function(t,e){e.createMethodDecorator=function(t,e,r){var n=l.createDecorator(t,function(t){e&&e(t),t.next({match:function(t){return u.isArray(t)},setMetadata:function(t,e){t.providers=e}})},r);return n.decoratorType=d.DecoratorType.Method,n}});n(y);y.createMethodDecorator;var g=o(function(t,e){e.createParamDecorator=function(t,e,r){var n=l.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return u.isParamMetadata(t)},match:function(t){return u.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=d.DecoratorType.Parameter,n}});n(g);g.createParamDecorator;var v=o(function(t,e){e.createPropDecorator=function(t,e,r){var n=l.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return u.isPropertyMetadata(t)},match:function(t){return u.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=d.DecoratorType.Property,n}});n(v);v.createPropDecorator;var m=o(function(t,e){e.createParamPropDecorator=function(t,e,r){var n=l.createDecorator(t,function(t){e&&e(t),t.next({isMetadata:function(t){return u.isParamPropMetadata(t)},match:function(t){return u.isToken(t)},setMetadata:function(t,e){t.provider=e}})},r);return n.decoratorType=d.DecoratorType.Property|d.DecoratorType.Parameter,n}});n(m);m.createParamPropDecorator;var A=o(function(t,e){e.createClassMethodDecorator=function(t,e,r){var n=l.createDecorator(t,e,r);return n.decoratorType=d.DecoratorType.Class|d.DecoratorType.Method,n}});n(A);A.createClassMethodDecorator;var M=o(function(t,e){e.createMethodPropDecorator=function(t,e,r){var n=l.createDecorator(t,e,r);return n.decoratorType=d.DecoratorType.Method|d.DecoratorType.Property,n}});n(M);M.createMethodPropDecorator;var P=o(function(t,e){e.createMethodPropParamDecorator=function(t,e,r){var n=l.createDecorator(t,e,r);return n.decoratorType=d.DecoratorType.Method|d.DecoratorType.Property|d.DecoratorType.Parameter,n}});n(P);P.createMethodPropParamDecorator;var C=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(f),r(d),r(l),r(h),r(y),r(g),r(v),r(m),r(A),r(M),r(P)});n(C);var b=o(function(t,e){e.Component=C.createClassDecorator("Component")});n(b);b.Component;var T=o(function(t,e){e.Injectable=C.createClassDecorator("Injectable")});n(T);T.Injectable;var k=o(function(t,e){e.Inject=C.createParamPropDecorator("Inject")});n(k);k.Inject;var w=o(function(t,e){e.AutoWired=C.createParamPropDecorator("AutoWired")});n(w);w.AutoWired;var D=o(function(t,e){e.Param=C.createParamDecorator("Param")});n(D);D.Param;var x=o(function(t,e){e.Method=C.createMethodDecorator("Method")});n(x);x.Method;var S=o(function(t,e){e.Singleton=C.createClassDecorator("Singleton",null,function(t){return t.singleton=!0,t})});n(S);S.Singleton;var I=o(function(t,e){e.Abstract=C.createClassDecorator("Abstract")});n(I);I.Abstract;var O=o(function(t,e){e.Autorun=C.createClassMethodDecorator("Autorun",function(t){t.next({isMetadata:function(t){return u.isClassMetadata(t,["autorun"])},match:function(t){return u.isString(t)},setMetadata:function(t,e){t.autorun=e}})})});n(O);O.Autorun;var N=o(function(t,e){e.IocModule=C.createClassDecorator("IocModule",function(t){t.next({isMetadata:function(t){return u.isClassMetadata(t,["autorun"])},match:function(t){return u.isString(t)},setMetadata:function(t,e){t.autorun=e}})})});n(N);N.IocModule;var R=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(b),r(T),r(k),r(w),r(D),r(x),r(S),r(I),r(O),r(N)});n(R);var E=o(function(t,e){var r=function(){function t(){}return t.prototype.isEmpty=function(){return!0},t.prototype.add=function(t){return this},t.prototype.remove=function(t){return this},t.prototype.find=function(t,r){return e.NullNode},t.prototype.filter=function(t,e){return[]},t.prototype.each=function(t,e){},t.prototype.trans=function(t){},t.prototype.transAfter=function(t){},t.prototype.routeUp=function(t){},t.prototype.equals=function(t){return t===e.NullNode},t.prototype.empty=function(){return e.NullNode},t.classAnnations={name:"NullComponent",params:{isEmpty:[],add:["action"],remove:["action"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],trans:["express"],transAfter:["express"],routeUp:["express"],equals:["node"],empty:[]}},t}();e.NullComponent=r,e.NullNode=new r});n(E);E.NullComponent,E.NullNode;var _=o(function(t,e){var r=function(){function t(t){this.name=t,this.children=[]}return t.prototype.add=function(t){return t.parent=this,this.children.push(t),this},t.prototype.remove=function(t){var e;return(e=u.isString(t)?this.find(function(e){return u.isString(t)?e.name===t:e.equals(t)}):t||this).parent?this.equals(e.parent)?(this.children.splice(this.children.indexOf(e),1),e.parent=null,this):(e.parent.remove(e),this):this},t.prototype.find=function(t,e){var r;return this.each(function(e){return!r&&(!(u.isFunction(t)?t(e):t===e)||(r=e,!1))},e),r||this.empty()},t.prototype.filter=function(t,e){var r=[];return this.each(function(e){t(e)&&r.push(e)},e),r},t.prototype.each=function(t,e){var r;switch(e=e||a.Mode.traverse){case a.Mode.route:r=this.routeUp(t);break;case a.Mode.children:r=this.eachChildren(t);break;case a.Mode.traverse:r=this.trans(t);break;case a.Mode.traverseLast:r=this.transAfter(t);break;default:r=this.trans(t)}return r},t.prototype.eachChildren=function(t){(this.children||[]).forEach(function(e){return t(e)})},t.prototype.routeUp=function(t){return!1!==t(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(t):void 0)},t.prototype.trans=function(t){if(!1===t(this))return!1;for(var e=this.children||[],r=0;r<e.length;r++){var n=e[r].trans(t);if(!1===n)return n}return!0},t.prototype.transAfter=function(t){for(var e=this.children||[],r=0;r<e.length;r++){if(!1===e[r].transAfter(t))return!1}return!1!==t(this)},t.prototype.equals=function(t){return this===t},t.prototype.empty=function(){return E.NullNode},t.prototype.isEmpty=function(){return this.equals(this.empty())},t.classAnnations={name:"Composite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],eachChildren:["express"],routeUp:["express"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},t}();e.Composite=r});n(_);_.Composite;var j=o(function(t,e){var r=function(){function t(t){this.name=t,this.children=[]}return t.prototype.add=function(t){return t.parent=this,this.children.push(t),this},t.prototype.remove=function(t){var e;return(e=u.isString(t)?this.find(function(e){return u.isString(t)?e.name===t:e.equals(t)}):t||this).parent?this.equals(e.parent)?(this.children.splice(this.children.indexOf(e),1),e.parent=null,this):(e.parent.remove(e),null):this},t.prototype.find=function(t,e){var r;return this.each(function(e){return!r&&(!(u.isFunction(t)?t(e):t===e)||(r=e,!1))},e),r||this.empty()},t.prototype.filter=function(t,e){var r=[];return this.each(function(e){t(e)&&r.push(e)},e),r},t.prototype.each=function(t,e){var r;switch(e=e||a.Mode.traverse){case a.Mode.route:r=this.routeUp(t);break;case a.Mode.children:r=this.eachChildren(t);break;case a.Mode.traverse:r=this.trans(t);break;case a.Mode.traverseLast:r=this.transAfter(t);break;default:r=this.trans(t)}return r},t.prototype.eachChildren=function(t){(this.children||[]).forEach(function(e){return t(e)})},t.prototype.routeUp=function(t){return!1!==t(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(t):void 0)},t.prototype.trans=function(t){if(!1===t(this))return!1;for(var e=this.children||[],r=0;r<e.length;r++){var n=e[r].trans(t);if(!1===n)return n}return!0},t.prototype.transAfter=function(t){for(var e=this.children||[],r=0;r<e.length;r++){if(!1===e[r].transAfter(t))return!1}return!1!==t(this)},t.prototype.equals=function(t){return this===t},t.prototype.empty=function(){return E.NullNode},t.prototype.isEmpty=function(){return this.equals(this.empty())},t.classAnnations={name:"GComposite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["iterate","mode"],eachChildren:["iterate"],routeUp:["iterate"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}},t}();e.GComposite=r});n(j);j.GComposite;var L=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(_),r(j),r(E)});n(L);var F=o(function(t,r){var n,o=e&&e.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.insert=function(t,e){return this},e.prototype.execute=function(t,e,r){},e.prototype.empty=function(){return r.NullAction},e.classAnnations={name:"NullActionClass",params:{insert:["action","index"],execute:["container","data","name"],empty:[]}},e}(L.NullComponent);r.NullAction=new a});n(F);F.NullAction;var B=o(function(t,e){var r=function(t){function e(e){var r=t.call(this,e)||this;return r.children=[],r}return __extends(e,t),e.prototype.insert=function(t,e){return t.parent=this,e<0?e=0:e>=this.children.length&&(e=this.children.length-1),this.children.splice(e,0,t),this},e.prototype.execute=function(t,r,n){n?this.find(function(t){return t.name===n}).execute(t,r):this.trans(function(n){n instanceof e&&n.working(t,r)})},e.prototype.empty=function(){return F.NullAction},e.prototype.working=function(t,e){},e.classAnnations={name:"ActionComposite",params:{constructor:["name"],insert:["node","index"],execute:["container","data","name"],empty:[],working:["container","data"]}},e}(L.GComposite);e.ActionComposite=r});n(B);B.ActionComposite;var K=o(function(t,e){var r;(r=e.LifeState||(e.LifeState={})).beforeCreateArgs="beforeCreateArgs",r.beforeConstructor="beforeConstructor",r.afterConstructor="afterConstructor",r.onInit="onInit",r.AfterInit="AfterInit"});n(K);K.LifeState;var U=o(function(t,e){var r;(r=e.CoreActions||(e.CoreActions={})).bindParameterType="bindParameterType",r.bindPropertyType="bindPropertyType",r.injectProperty="injectProperty",r.bindProvider="bindProvider",r.bindParameterProviders="bindParameterProviders",r.cache="cache",r.componentBeforeInit="componentBeforeInit",r.componentInit="componentInit",r.componentAfterInit="componentAfterInit",r.singletion="singletion",r.autorun="autorun"});n(U);U.CoreActions;var q=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.bindProvider)||this}return __extends(e,t),e.prototype.working=function(t,e){e.target;var r=e.targetType,n=(e.propertyKey,[]);t.getLifeScope().getClassDecorators(function(t){return t.actions.includes(U.CoreActions.bindProvider)&&C.hasOwnClassMetadata(t.name,r)}).forEach(function(e){var o=C.getOwnTypeMetadata(e.name,r);if(Array.isArray(o)&&o.length>0){var a=o.find(function(t){return t&&!!t.provide});if(a){var i=t.getTokenKey(a.provide,a.alias);n.push(i),t.bindProvider(i,a.type)}}}),e.execResult=n},e.classAnnations={name:"BindProviderAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.BindProviderAction=r});n(q);q.BindProviderAction;var V=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.bindParameterType)||this}return __extends(e,t),e.prototype.working=function(t,e){var r,n=e.target,o=e.targetType,a=e.propertyKey,i=t.getLifeScope();(r=(r=n&&a?Reflect.getMetadata("design:paramtypes",n,a)||[]:Reflect.getMetadata("design:paramtypes",o)||[]).slice(0)).forEach(function(e){i.isVaildDependence(e)&&(t.has(e)||t.register(e))}),i.getParameterDecorators(function(t){return t.actions.includes(U.CoreActions.bindParameterType)&&(n||"constructor"!==a?C.hasParamMetadata(t.name,n,a):C.hasOwnParamMetadata(t.name,o))}).forEach(function(e){var s=n||"constructor"!==a?C.getParamMetadata(e.name,n,a):C.getOwnParamMetadata(e.name,o);u.isArray(s)&&s.length&&s.forEach(function(e){var n=u.isArray(e)&&e.length>0?e[0]:null;if(n&&n.index>=0){i.isVaildDependence(n.provider)&&(t.has(n.provider,n.alias)||t.register(t.getToken(n.provider,n.alias))),i.isVaildDependence(n.type)&&(t.has(n.type)||t.register(n.type));var o=n.provider?t.getTokenKey(n.provider,n.alias):n.type;o&&(r[n.index]=o)}})}),e.execResult=r},e.classAnnations={name:"BindParameterTypeAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.BindParameterTypeAction=r});n(V);V.BindParameterTypeAction;var z=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.bindPropertyType)||this}return __extends(e,t),e.prototype.working=function(t,e){e.target;var r=e.targetType,n=t.getLifeScope(),o=[];n.getPropertyDecorators(function(t){return t.actions.includes(U.CoreActions.bindPropertyType)&&C.hasPropertyMetadata(t.name,r)}).forEach(function(e){var a=C.getPropertyMetadata(e.name,r);for(var i in a)o=o.concat(a[i]);(o=o.filter(function(t){return!!t})).forEach(function(e){n.isVaildDependence(e.provider)&&(t.has(e.provider,e.alias)||t.register(t.getToken(e.provider,e.alias))),n.isVaildDependence(e.type)&&(t.has(e.type)||t.register(e.type))})}),e.execResult=o},e.classAnnations={name:"BindPropertyTypeAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.BindPropertyTypeAction=r});n(z);z.BindPropertyTypeAction;var G=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.injectProperty)||this}return __extends(e,t),e.prototype.working=function(t,e){e.execResult||this.parent.find(function(t){return t.name===U.CoreActions.bindPropertyType}).execute(t,e),e.target&&e.execResult&&e.execResult.length&&e.execResult.forEach(function(r,n){if(r){var o=r.provider?t.getToken(r.provider,r.alias):r.type;t.has(o)&&(e.target[r.propertyKey]=t.resolve.apply(t,[o].concat(e.providers||[])))}})},e.classAnnations={name:"InjectPropertyAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.InjectPropertyAction=r});n(G);G.InjectPropertyAction;var W=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.bindParameterProviders)||this}return __extends(e,t),e.prototype.working=function(t,e){e.target;var r=e.targetType,n=e.propertyKey,o=[];t.getLifeScope().getMethodDecorators(function(t){return t.actions.includes(U.CoreActions.bindParameterProviders)&&C.hasOwnMethodMetadata(t.name,r)}).forEach(function(t){var e=C.getOwnMethodMetadata(t.name,r)[n];e&&u.isArray(e)&&e.length>0&&e.forEach(function(t){t.providers&&t.providers.length>0&&(o=o.concat(t.providers))})}),e.execResult=o},e.classAnnations={name:"BindParameterProviderAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.BindParameterProviderAction=r});n(W);W.BindParameterProviderAction;var $=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.componentBeforeInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;u.isFunction(r.beforeInit)&&t.syncInvoke(e.targetType,"beforeInit",e.target)}},e.classAnnations={name:"ComponentBeforeInitAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.ComponentBeforeInitAction=r});n($);$.ComponentBeforeInitAction;var Z=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.componentInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;u.isFunction(r.onInit)&&t.syncInvoke(e.targetType,"onInit",e.target)}},e.classAnnations={name:"ComponentInitAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.ComponentInitAction=r});n(Z);Z.ComponentInitAction;var H=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.componentAfterInit)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.targetType&&e.target){var r=e.target;u.isFunction(r.afterInit)&&t.syncInvoke(e.targetType,"afterInit",e.target)}},e.classAnnations={name:"ComponentAfterInitAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.ComponentAfterInitAction=r});n(H);H.ComponentAfterInitAction;var J=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.cache)||this}return __extends(e,t),e.prototype.working=function(t,e){if(e.singleton||!e.targetType||!u.isClass(e.targetType))return e;var r=t.get(u.symbols.ICacheManager);if(e.target){if(!r.hasCache(e.targetType))(n=this.getCacheMetadata(t,e))&&r.cache(e.targetType,e.target,n.expires)}else{var n,o=r.get(e.targetType);if(o)(n=this.getCacheMetadata(t,e))&&(r.cache(e.targetType,o,n.expires),e.execResult=o)}return e},e.prototype.getCacheMetadata=function(t,e){for(var r,n=t.getLifeScope().getClassDecorators(function(t){return C.hasOwnClassMetadata(t.name,e.targetType)}),o=0;o<n.length;o++){var a=n[o],i=C.getOwnTypeMetadata(a.name,e.targetType);if(Array.isArray(i)&&i.length>0&&(r=i.find(function(t){return t&&u.isNumber(t.expires)&&t.expires>0})))break}return r},e.classAnnations={name:"CacheAction",params:{constructor:[],working:["container","data"],getCacheMetadata:["container","data"]}},e}(B.ActionComposite);e.CacheAction=r});n(J);J.CacheAction;var Q=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.singletion)||this}return __extends(e,t),e.prototype.working=function(t,e){e.tokenKey&&e.target&&e.singleton&&t.registerValue(e.tokenKey,e.target)},e.classAnnations={name:"SingletionAction",params:{constructor:[],working:["container","data"]}},e}(B.ActionComposite);e.SingletionAction=r});n(Q);Q.SingletionAction;var X=o(function(t,e){var r=function(t){function e(){return t.call(this,U.CoreActions.autorun)||this}return __extends(e,t),e.prototype.getDecorator=function(){return[R.IocModule,R.Autorun]},e.prototype.working=function(t,e){e.tokenKey&&e.targetType&&this.getDecorator().forEach(function(r){if(C.hasClassMetadata(r,e.targetType)){var n=C.getTypeMetadata(r,e.targetType),o=n.find(function(t){return!!t.autorun});if(!o&&n.length&&(o=n[0]),o){var a=t.get(e.tokenKey);a&&o.autorun&&u.isFunction(a[o.autorun])&&t.syncInvoke(e.tokenKey,o.autorun,a)}}else if(C.hasMethodMetadata(r,e.targetType)){var i,s=C.getMethodMetadata(r,e.targetType);Object.keys(s).forEach(function(t){var e=s[t];e&&!i&&(i=e.find(function(t){return!!t.autorun}))}),i&&i.autorun&&t.syncInvoke(e.tokenKey,i.autorun)}})},e.classAnnations={name:"AutorunAction",params:{constructor:[],getDecorator:[],working:["container","data"]}},e}(B.ActionComposite);e.AutorunAction=r});n(X);X.AutorunAction;var Y=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(B),r(K),r(U),r(F),r(q),r(V),r(z),r(G),r(W),r($),r(Z),r(H),r(J),r(Q),r(X)});n(Y);var tt=o(function(t,e){var r=function(){function t(){}return t.prototype.create=function(t){var e;switch(t){case Y.CoreActions.bindParameterType:e=new Y.BindParameterTypeAction;break;case Y.CoreActions.bindPropertyType:e=new Y.BindPropertyTypeAction;break;case Y.CoreActions.injectProperty:e=new Y.InjectPropertyAction;break;case Y.CoreActions.bindProvider:e=new Y.BindProviderAction;break;case Y.CoreActions.bindParameterProviders:e=new Y.BindParameterProviderAction;break;case Y.CoreActions.componentInit:e=new Y.ComponentInitAction;break;case Y.CoreActions.componentBeforeInit:e=new Y.ComponentBeforeInitAction;break;case Y.CoreActions.componentAfterInit:e=new Y.ComponentAfterInitAction;break;case Y.CoreActions.cache:e=new Y.CacheAction;break;case Y.CoreActions.singletion:e=new Y.SingletionAction;break;case Y.CoreActions.autorun:e=new Y.AutorunAction;break;default:e=new Y.ActionComposite(t)}return e},t.classAnnations={name:"ActionFactory",params:{create:["type"]}},t}();e.ActionFactory=r});n(tt);tt.ActionFactory;var et=o(function(t,e){var r=function(){function t(t){this.container=t,this.decorators=[],this.buildAction()}return t.prototype.addAction=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.action;return e.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.add(t),this},t.prototype.registerDecorator=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getDecoratorType(t);return this.registerCustomDecorator.apply(this,[t,n].concat(e))},t.prototype.registerCustomDecorator=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this.toActionName(e),a=t.toString();return this.decorators.some(function(t){return t.name===a})||this.decorators.push({name:a,types:o,actions:r}),this},t.prototype.execute=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e=e.filter(function(t){return!!t});var n=this.action;e.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.execute(this.container,t)},t.prototype.getClassDecorators=function(t){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Class),t)},t.prototype.getMethodDecorators=function(t){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Method),t)},t.prototype.getPropertyDecorators=function(t){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Property),t)},t.prototype.getParameterDecorators=function(t){return this.getTypeDecorators(this.toActionName(C.DecoratorType.Parameter),t)},t.prototype.getDecoratorType=function(t){return t.decoratorType||C.DecoratorType.All},t.prototype.isVaildDependence=function(t){return!!t&&(!!u.isClass(t)&&(!u.isAbstractDecoratorClass(t)&&this.getClassDecorators().some(function(e){return C.hasOwnClassMetadata(e.name,t)})))},t.prototype.getAtionByName=function(t){return this.action.find(function(e){return e.name===t})},t.prototype.getClassAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Class))},t.prototype.getMethodAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Method))},t.prototype.getPropertyAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Property))},t.prototype.getParameterAction=function(){return this.getAtionByName(this.toActionName(C.DecoratorType.Parameter))},t.prototype.getConstructorParameters=function(t){return this.getParameters(t)},t.prototype.getMethodParameters=function(t,e,r){return this.getParameters(t,e,r)},t.prototype.getParamerterNames=function(t,e){var r=C.getOwnParamerterNames(t),n=[];return r&&r.hasOwnProperty(e)&&(n=r[e]),u.isArray(n)||(n=[]),n},t.prototype.isSingletonType=function(t){return!!C.hasOwnClassMetadata(R.Singleton,t)||this.getClassDecorators().some(function(e){var r=C.getOwnTypeMetadata(e.name,t)||[];return!!u.isArray(r)&&r.some(function(t){return!0===t.singleton})})},t.prototype.getMethodMetadatas=function(t,e){var r=[];return this.getMethodDecorators().forEach(function(n){var o=C.getOwnMethodMetadata(n.name,t);o.hasOwnProperty(e)&&(r=r.concat(o[e]||[]))}),r},t.prototype.filerDecorators=function(t){return this.decorators.filter(t)},t.prototype.getParameters=function(t,e,r){var n={target:e,targetType:t,propertyKey:r=r||"constructor"};this.execute(n,Y.LifeState.onInit,Y.CoreActions.bindParameterType);var o=this.getParamerterNames(t,r);return n.execResult.length?n.execResult.map(function(t,e){return{type:t,name:o[e]}}):o.map(function(t){return{name:t,type:void 0}})},t.prototype.getTypeDecorators=function(t,e){return this.filerDecorators(function(r){var n=(r.types||"").indexOf(t)>=0;return n&&e&&(n=e(r)),n})},t.prototype.buildAction=function(){var t=new tt.ActionFactory,e=t.create("");e.add(t.create(a.IocState.design).add(t.create(Y.CoreActions.bindProvider)).add(t.create(Y.CoreActions.autorun))).add(t.create(a.IocState.runtime).add(t.create(Y.LifeState.beforeCreateArgs)).add(t.create(Y.LifeState.beforeConstructor)).add(t.create(Y.LifeState.afterConstructor)).add(t.create(Y.LifeState.onInit).add(t.create(Y.CoreActions.componentBeforeInit)).add(t.create(this.toActionName(C.DecoratorType.Class))).add(t.create(this.toActionName(C.DecoratorType.Method))).add(t.create(this.toActionName(C.DecoratorType.Property)).add(t.create(Y.CoreActions.bindPropertyType)).add(t.create(Y.CoreActions.injectProperty))).add(t.create(this.toActionName(C.DecoratorType.Parameter)).add(t.create(Y.CoreActions.bindParameterType)).add(t.create(Y.CoreActions.bindParameterProviders))).add(t.create(Y.CoreActions.componentInit))).add(t.create(Y.LifeState.AfterInit).add(t.create(Y.CoreActions.singletion)).add(t.create(Y.CoreActions.componentAfterInit)))).add(t.create(Y.CoreActions.cache)),this.action=e},t.prototype.toActionName=function(t){var e=[];return t&C.DecoratorType.Class&&e.push("ClassDecorator"),t&C.DecoratorType.Method&&e.push("MethodDecorator"),t&C.DecoratorType.Property&&e.push("PropertyDecorator"),t&C.DecoratorType.Parameter&&e.push("ParameterDecorator"),e.join(",")},t.classAnnations={name:"DefaultLifeScope",params:{constructor:["container"],addAction:["action","nodepaths"],registerDecorator:["decorator","actions"],registerCustomDecorator:["decorator","type","actions"],execute:["data","names"],getClassDecorators:["match"],getMethodDecorators:["match"],getPropertyDecorators:["match"],getParameterDecorators:["match"],getDecoratorType:["decirator"],isVaildDependence:["target"],getAtionByName:["name"],getClassAction:[],getMethodAction:[],getPropertyAction:[],getParameterAction:[],getConstructorParameters:["type"],getMethodParameters:["type","instance","propertyKey"],getParamerterNames:["type","propertyKey"],isSingletonType:["type"],getMethodMetadatas:["type","propertyKey"],filerDecorators:["express"],getParameters:["type","instance","propertyKey"],getTypeDecorators:["decType","match"],buildAction:[],toActionName:["type"]}},t}();e.DefaultLifeScope=r});n(et);et.DefaultLifeScope;var rt=o(function(t,r){var n=e&&e.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,s)}c((n=n.apply(t,e||[])).next())})},o=e&&e.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=function(){function t(t){this.container=t}return t.prototype.getMatcher=function(){return this.container.get(u.symbols.IProviderMatcher)},t.prototype.invoke=function(t,e,r){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return n(this,void 0,void 0,function(){var n,i,s,c,p,f;return o(this,function(o){switch(o.label){case 0:if(r||(r=(f=this.container).resolve.apply(f,[t].concat(a))),!(n=this.container.getTokenImpl(t)))throw Error(t.toString()+" is not implements by any class.");return r&&u.isFunction(r[e])?(i={target:r,targetType:n,propertyKey:e},(s=this.container.getLifeScope()).execute(i,Y.LifeState.onInit,Y.CoreActions.bindParameterProviders),a=a.concat(i.execResult),c=s.getMethodParameters(n,r,e),[4,this.createParams.apply(this,[c].concat(a))]):[3,2];case 1:return p=o.sent(),[2,r[e].apply(r,p)];case 2:throw new Error("type: "+n+" has no method "+e+".");case 3:return[2]}})})},t.prototype.syncInvoke=function(t,e,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];r||(r=(a=this.container).resolve.apply(a,[t].concat(n)));var a,i=this.container.getTokenImpl(t);if(!i)throw Error(t.toString()+" is not implements by any class.");if(r&&u.isFunction(r[e])){var s={target:r,targetType:i,propertyKey:e},c=this.container.getLifeScope();c.execute(s,Y.LifeState.onInit,Y.CoreActions.bindParameterProviders),n=n.concat(s.execResult);var p=c.getMethodParameters(i,r,e),f=this.createSyncParams.apply(this,[p].concat(n));return r[e].apply(r,f)}throw new Error("type: "+i+" has no method "+e+".")},t.prototype.createSyncParams=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o,a=(o=this.getMatcher()).matchProviders.apply(o,[t].concat(r));return t.map(function(t,n){return t.name&&a.has(t.name)?a.resolve(t.name):u.isToken(t.type)?(o=e.container).resolve.apply(o,[t.type].concat(r)):void 0;var o})},t.prototype.createParams=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o,a=(o=this.getMatcher()).matchProviders.apply(o,[t].concat(r));return Promise.all(t.map(function(t,n){return t.name&&a.has(t.name)?a.resolve(t.name):u.isToken(t.type)?(o=e.container).resolve.apply(o,[t.type].concat(r)):void 0;var o}))},t.classAnnations={name:"MethodAccessor",params:{constructor:["container"],getMatcher:[],invoke:["token","propertyKey","target","providers"],syncInvoke:["token","propertyKey","target","providers"],createSyncParams:["params","providers"],createParams:["params","providers"]}},t}();r.MethodAccessor=a});n(rt);rt.MethodAccessor;var nt=o(function(t,e){var r=function(){function t(t){this.container=t,this.maps=new u.MapSet}return t.prototype.has=function(t){return this.maps.has(t)},t.prototype.get=function(t){return this.maps.get(t)},t.prototype.add=function(t,e){var r,n=this;return u.isUndefined(t)?this:(r=u.isToken(e)&&this.container.has(e)?function(){for(var t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return(t=n.container).resolve.apply(t,[e].concat(r))}:u.isFunction(e)?function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.apply(void 0,[n.container].concat(t))}:function(){return e},this.maps.set(t,r),this)},t.prototype.remove=function(t){return this.maps.has(t)&&this.maps.delete(t),this},t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.maps.has(t))return!u.isNumber(t)&&this.container.has(t)?(n=this.container).resolve.apply(n,[t].concat(e)):null;var n,o,a=this.maps.get(t);return u.isToken(a)?(o=this.container).resolve.apply(o,[a].concat(e)):a.apply(void 0,e)},t.prototype.forEach=function(t){this.maps.forEach(t)},t.prototype.copy=function(t){var e=this;t&&t.forEach(function(t,r){e.maps.set(r,t)})},t.classAnnations={name:"ProviderMap",params:{constructor:["container"],has:["provide"],get:["provide"],add:["provide","provider"],remove:["provide"],resolve:["provide","providers"],forEach:["express"],copy:["map"]}},t}();e.ProviderMap=r});n(nt);nt.ProviderMap;var ot=o(function(t,e){var r=function(){function t(t,e){this.type=t,this.value=e}return t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return u.isUndefined(this.value)?t.has(this.type)?t.resolve.apply(t,[this.type].concat(e)):null:this.value},t.create=function(e,r){return new t(e,r)},t.createExtends=function(t,e,r){return new i(t,e,r)},t.createCustom=function(t,e,r){return new n(t,e,r)},t.createInvoke=function(t,e,r){return new o(t,e,r)},t.createParam=function(t,e,r,n){return new a(t,e,r,n)},t.createAsyncParam=function(t,e,r,n,o){return new s(t,e,r,n,o)},t.classAnnations={name:"Provider",params:{constructor:["type","value"],resolve:["container","providers"],create:["type","value"],createExtends:["token","value","extendsTarget"],createCustom:["type","toInstance","value"],createInvoke:["token","method","value"],createParam:["token","value","index","method"],createAsyncParam:["files","token","index","method","value"]}},t}();e.Provider=r;var n=function(t){function e(e,r,n){var o=t.call(this,e,n)||this;return o.toInstance=r,o}return __extends(e,t),e.prototype.resolve=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.toInstance?this.toInstance.apply(this,[e].concat(r)):t.prototype.resolve.apply(this,[e].concat(r))},e.classAnnations={name:"CustomProvider",params:{constructor:["type","toInstance","value"],resolve:["container","providers"]}},e}(r);e.CustomProvider=n;var o=function(t){function e(e,r,n){var o=t.call(this,e,n)||this;return o.method=r,o}return __extends(e,t),e.prototype.resolve=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.method?e.syncInvoke.apply(e,[this.type,this.method].concat(r)):t.prototype.resolve.apply(this,[e].concat(r))},e.classAnnations={name:"InvokeProvider",params:{constructor:["type","method","value"],resolve:["container","providers"]}},e}(r);e.InvokeProvider=o;var a=function(t){function e(e,r,n,o){var a=t.call(this,e,o,r)||this;return a.index=n,a}return __extends(e,t),e.prototype.resolve=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return t.prototype.resolve.apply(this,[e].concat(r))},e.classAnnations={name:"ParamProvider",params:{constructor:["token","value","index","method"],resolve:["container","providers"]}},e}(o);e.ParamProvider=a;var i=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.extendsTarget=n,o}return __extends(e,t),e.prototype.resolve=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return t.prototype.resolve.apply(this,[e].concat(r))},e.prototype.extends=function(t){u.isObject(t)&&u.isFunction(this.extendsTarget)&&this.extendsTarget(t,this)},e.classAnnations={name:"ExtendsProvider",params:{constructor:["token","value","extendsTarget"],resolve:["container","providers"],extends:["target"]}},e}(r);e.ExtendsProvider=i;var s=function(t){function e(e,r,n,o,a){var i=t.call(this,r,a,n,o)||this;return i.files=e,i}return __extends(e,t),e.prototype.resolve=function(e){for(var r=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return e.get(u.symbols.IContainerBuilder).loadModule(e,{files:this.files}).then(function(){return t.prototype.resolve.apply(r,[e].concat(n))})},e.classAnnations={name:"AsyncParamProvider",params:{constructor:["files","token","index","method","value"],resolve:["container","providers"]}},e}(a);e.AsyncParamProvider=s});n(ot);ot.Provider,ot.CustomProvider,ot.InvokeProvider,ot.ParamProvider,ot.ExtendsProvider,ot.AsyncParamProvider;var at=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(ot),r(nt),e.isProviderMap=function(t){return!!u.isObject(t)&&t instanceof nt.ProviderMap}});n(at);at.isProviderMap;var it=o(function(t,e){var r=function(){function t(t){this.container=t}return t.prototype.toProviderMap=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(1===e.length&&at.isProviderMap(e[0]))return e[0];var n=this.container.resolve(at.ProviderMap);return e.forEach(function(e,r){u.isUndefined(e)||u.isNull(e)||(at.isProviderMap(e)?n.copy(e):e instanceof at.Provider?e instanceof at.ParamProvider?!e.type&&u.isNumber(e.index)?n.add(e.index,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.resolve.apply(e,[t.container].concat(r))}):n.add(e.type,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.resolve.apply(e,[t.container].concat(r))}):n.add(e.type,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.resolve.apply(e,[t.container].concat(r))}):u.isBaseObject(e)?Object.keys(e).forEach(function(t){u.isUndefined(e[t])||(u.isClass(e[t])?n.add(t,e[t]):u.isFunction(e[t])||u.isString(e[t])?n.add(t,function(){return e[t]}):n.add(t,e[t]))}):u.isFunction(e)?n.add(name,function(){return e}):n.add(r,e))}),n},t.prototype.matchProviders=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.match(t,this.toProviderMap.apply(this,e))},t.prototype.match=function(t,e){var r=this,n=this.container.resolve(at.ProviderMap);return t.length?(t.forEach(function(t,o){t.name&&(e.has(t.name)?n.add(t.name,e.get(t.name)):u.isToken(t.type)?e.has(t.type)?n.add(t.name,e.get(t.type)):r.container.has(t.type)&&n.add(t.name,t.type):e.has(o)&&n.add(t.name,e.get(o)))}),n):n},t.classAnnations={name:"ProviderMatcher",params:{constructor:["container"],toProviderMap:["providers"],matchProviders:["params","providers"],match:["params","providers"]}},t}();e.ProviderMatcher=r});n(it);it.ProviderMatcher;var st=o(function(t,e){var r=function(){function t(t){this.container=t,this.cacheTokens=new u.MapSet}return t.prototype.isChecking=function(){return!!this.timeout},t.prototype.hasCache=function(t){return this.cacheTokens.has(t)},t.prototype.cache=function(t,e,r){var n;this.hasCache(t)?(n=this.cacheTokens.get(t)).expires=Date.now()+r:n={target:e,expires:Date.now()+r},this.cacheTokens.set(t,n),this.isChecking()||this.checkExpires()},t.prototype.get=function(t,e){var r=null;if(!this.cacheTokens.has(t))return null;var n=this.cacheTokens.get(t);return n.expires<=Date.now()?(r=n.target,u.isNumber(e)&&e>0&&(n.expires=Date.now()+e,this.cacheTokens.set(t,n))):this.destroy(t,n.target),r},t.prototype.checkExpires=function(){var t=this;if(this.timeout&&(clearTimeout(this.timeout),this.timeout=0),this.cacheTokens.size>0){var e=[];this.cacheTokens.forEach(function(t,r){t.expires>=Date.now()&&e.push(r)}),e.length&&e.forEach(function(e){t.destroy(e,t.cacheTokens.get(e).target)}),this.timeout=setTimeout(function(){t.checkExpires()},6e4)}},t.prototype.destroy=function(t,e){if(this.hasCache(t)){e||(e=this.cacheTokens.get(t).target);try{var r=e;u.isFunction(r.onDestroy)&&this.container.syncInvoke(t,"onDestroy",e),this.cacheTokens.delete(t)}catch(t){console.error&&console.error(t)}}},t.classAnnations={name:"CacheManager",params:{constructor:["container"],isChecking:[],hasCache:["targetType"],cache:["targetType","target","expires"],get:["targetType","expires"],checkExpires:[],destroy:["targetType","target"]}},t}();e.CacheManager=r});n(st);st.CacheManager;var ct=o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(Y),r(R),r(C),r(at),r(tt),r(et),r(it),r(rt),r(st),e.registerCores=function(t){t.registerSingleton(u.symbols.LifeScope,function(){return new et.DefaultLifeScope(t)}),t.register(at.ProviderMap,function(){return new at.ProviderMap(t)}),t.registerSingleton(u.symbols.ICacheManager,function(){return new st.CacheManager(t)}),t.registerSingleton(u.symbols.IProviderMatcher,function(){return new it.ProviderMatcher(t)}),t.registerSingleton(u.symbols.IMethodAccessor,function(){return new rt.MethodAccessor(t)});var e=t.get(u.symbols.LifeScope);e.registerDecorator(R.Injectable,Y.CoreActions.bindProvider,Y.CoreActions.cache),e.registerDecorator(R.Component,Y.CoreActions.bindProvider,Y.CoreActions.cache,Y.CoreActions.componentBeforeInit,Y.CoreActions.componentInit,Y.CoreActions.componentAfterInit),e.registerDecorator(R.Singleton,Y.CoreActions.bindProvider),e.registerDecorator(R.Abstract,Y.CoreActions.bindProvider,Y.CoreActions.cache),e.registerDecorator(R.AutoWired,Y.CoreActions.bindParameterType,Y.CoreActions.bindPropertyType),e.registerDecorator(R.Inject,Y.CoreActions.bindParameterType,Y.CoreActions.bindPropertyType),e.registerDecorator(R.Param,Y.CoreActions.bindParameterType,Y.CoreActions.bindPropertyType),e.registerDecorator(R.Method,Y.CoreActions.bindParameterProviders),e.registerDecorator(R.Autorun,Y.CoreActions.autorun),e.registerDecorator(R.IocModule,Y.CoreActions.autorun,Y.CoreActions.componentBeforeInit,Y.CoreActions.componentInit,Y.CoreActions.componentAfterInit),t.register(Date,function(){return new Date}),t.register(String,function(){return""}),t.register(Number,function(){return Number.NaN}),t.register(Boolean,function(){})}});n(ct);ct.registerCores;var ut=o(function(t,e){var r=function(){function t(){this.init()}return t.prototype.get=function(t,e){return this.resolve(e?this.getTokenKey(t,e):t)},t.prototype.resolve=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getTokenKey(t);return this.hasRegister(n)?this.factories.get(n).apply(void 0,e):(console.error("have not register",n),null)},t.prototype.clearCache=function(t){this.get(u.symbols.ICacheManager).destroy(t)},t.prototype.getToken=function(t,e){return t instanceof p.Registration?t:e&&u.isFunction(t)?new p.Registration(t,e):t},t.prototype.getTokenKey=function(t,e){return t instanceof p.Registration?t.toString():e?new p.Registration(t,e).toString():t},t.prototype.register=function(t,e){return this.registerFactory(t,e),this},t.prototype.has=function(t,e){var r=this.getTokenKey(t,e);return this.hasRegister(r)},t.prototype.hasRegister=function(t){return this.factories.has(t)},t.prototype.unregister=function(t){var e=this.getTokenKey(t);return this.hasRegister(e)&&this.factories.delete(e),this},t.prototype.registerSingleton=function(t,e){return this.registerFactory(t,e,!0),this},t.prototype.registerValue=function(t,e){var r=this,n=this.getTokenKey(t);return this.singleton.set(n,e),this.factories.has(n)||this.factories.set(n,function(){return r.singleton.get(n)}),this},t.prototype.bindProvider=function(t,e){var r,n=this,o=this.getTokenKey(t);if(r=u.isToken(e)?function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n.resolve.apply(n,[e].concat(t))}:u.isFunction(e)?function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.apply(void 0,[n].concat(t))}:function(){return e},u.isClass(e))this.provideTypes.set(t,e);else if(u.isToken(e))for(var a=e;this.provideTypes.has(a)&&!u.isClass(a);)if(a=this.provideTypes.get(a),u.isClass(a)){this.provideTypes.set(t,a);break}return this.factories.set(o,r),this},t.prototype.getTokenImpl=function(t){return u.isClass(t)?t:this.provideTypes.has(t)?this.provideTypes.get(t):null},t.prototype.getLifeScope=function(){return this.get(u.symbols.LifeScope)},t.prototype.use=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this.get(u.symbols.IContainerBuilder)).syncLoadModule.apply(t,[this].concat(e)),this},t.prototype.invoke=function(t,e,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(u.symbols.IMethodAccessor)).invoke.apply(n,[t,e,r].concat(o))},t.prototype.syncInvoke=function(t,e,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.get(u.symbols.IMethodAccessor)).syncInvoke.apply(n,[t,e,r].concat(o))},t.prototype.createSyncParams=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(e=this.get(u.symbols.IMethodAccessor)).createSyncParams.apply(e,[t].concat(r))},t.prototype.createParams=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(e=this.get(u.symbols.IMethodAccessor)).createParams.apply(e,[t].concat(r))},t.prototype.cacheDecorator=function(t,e){t.has(e.name)||t.set(e.name,e)},t.prototype.init=function(){var t=this;this.factories=new u.MapSet,this.singleton=new u.MapSet,this.provideTypes=new u.MapSet,this.bindProvider(u.symbols.IContainer,function(){return t}),ct.registerCores(this)},t.prototype.registerFactory=function(t,e,r){var n=this.getTokenKey(t);if(!this.factories.has(n)){var o;if(u.isUndefined(e)){if(!u.isString(t)&&!u.isSymbol(t)){var a=t instanceof p.Registration?t.getClass():t;u.isClass(a)&&this.bindTypeFactory(n,a,r)}}else u.isFunction(e)?u.isClass(e)?this.bindTypeFactory(n,e,r):o=this.createCustomFactory(n,e,r):r&&void 0!==e&&(o=this.createCustomFactory(n,function(){return e},r));o&&this.factories.set(n,o)}},t.prototype.createCustomFactory=function(t,e,r){var n=this;return r?function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(n.singleton.has(t))return n.singleton.get(t);var a=e.apply(void 0,[n].concat(r));return n.singleton.set(t,a),a}:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.apply(void 0,[n].concat(t))}},t.prototype.bindTypeFactory=function(t,e,r){var n=this;if(Reflect.isExtensible(e)){var o=this.getLifeScope(),i=o.getConstructorParameters(e);r||(r=o.isSingletonType(e));this.factories.set(t,function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];if(r&&n.singleton.has(t))return n.singleton.get(t);if(s.length<1){var u={tokenKey:t,targetType:e,singleton:r};if(o.execute(u,ct.CoreActions.cache),u.execResult&&u.execResult instanceof e)return u.execResult}o.execute({tokenKey:t,targetType:e,params:i,providers:s,singleton:r},a.IocState.runtime,ct.LifeState.beforeCreateArgs);var p=n.createSyncParams.apply(n,[i].concat(s));o.execute({tokenKey:t,targetType:e,args:p,params:i,providers:s,singleton:r},a.IocState.runtime,ct.LifeState.beforeConstructor);var f=new(e.bind.apply(e,[void 0].concat(p)));return o.execute({tokenKey:t,target:f,targetType:e,args:p,params:i,providers:s,singleton:r},a.IocState.runtime,ct.LifeState.afterConstructor),o.execute({tokenKey:t,target:f,targetType:e,args:p,params:i,providers:s,singleton:r},a.IocState.runtime,ct.LifeState.onInit),o.execute({tokenKey:t,target:f,targetType:e,args:p,params:i,providers:s,singleton:r},a.IocState.runtime,ct.LifeState.AfterInit),o.execute({tokenKey:t,target:f,targetType:e},ct.CoreActions.cache),f}),o.execute({tokenKey:t,targetType:e},a.IocState.design)}},t.classAnnations={name:"Container",params:{constructor:[],get:["token","alias"],resolve:["token","providers"],clearCache:["targetType"],getToken:["token","alias"],getTokenKey:["token","alias"],register:["token","value"],has:["token","alias"],hasRegister:["key"],unregister:["token"],registerSingleton:["token","value"],registerValue:["token","value"],bindProvider:["provide","provider"],getTokenImpl:["token"],getLifeScope:[],use:["modules"],invoke:["token","propertyKey","instance","providers"],syncInvoke:["token","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"],cacheDecorator:["map","action"],init:[],registerFactory:["token","value","singleton"],createCustomFactory:["key","factory","singleton"],bindTypeFactory:["key","ClassT","singleton"]}},t}();e.Container=r});n(ut);ut.Container;var pt=o(function(t,e){var n=function(){function t(){}return t.prototype.getLoader=function(){return this._loader||(this._loader=this.createLoader()),this._loader},t.prototype.load=function(t){var e=this;return t.files?Promise.all(t.files).then(function(t){return t.map(function(t){return e.loadModule(t)})}):Promise.resolve([])},t.prototype.loadModule=function(t){return this.getLoader()(t)},t.prototype.createLoader=function(){if(void 0!==r)return function(t){return new Promise(function(t,e){r()})};throw new Error("has not module loader")},t.classAnnations={name:"DefaultModuleLoader",params:{constructor:[],getLoader:[],load:["options"],loadModule:["file"],createLoader:[]}},t}();e.DefaultModuleLoader=n});n(pt);pt.DefaultModuleLoader;var ft=o(function(t,r){var n=e&&e.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,s)}c((n=n.apply(t,e||[])).next())})},o=e&&e.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=function(){function t(t){this.loader=t,t||(this.loader=new pt.DefaultModuleLoader)}return t.prototype.create=function(){var t=this,e=new ut.Container;return e.bindProvider(u.symbols.IContainerBuilder,function(){return t}),e},t.prototype.build=function(t){return n(this,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return e=this.create(),t?[4,this.loadModule(e,t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2,e]}})})},t.prototype.loadModule=function(t,e){return n(this,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return[4,this.loadTypes(e)];case 1:return r=n.sent(),[2,this.registers(t,r)]}})})},t.prototype.syncBuild=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.create();return t.length&&this.syncLoadModule.apply(this,[r].concat(t)),r},t.prototype.syncLoadModule=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getModules.apply(this,e);return this.registers(t,n)},t.prototype.loadTypes=function(t){return n(this,void 0,void 0,function(){var e,r,n=this;return o(this,function(o){switch(o.label){case 0:return t?[4,this.loader.load(t)]:[3,3];case 1:return e=o.sent(),t.modules&&t.modules.length?[4,Promise.all(t.modules.map(function(t){return u.isString(t)?n.loader.loadModule(t):t}))]:[3,3];case 2:r=o.sent(),e=e.concat(r),o.label=3;case 3:return[2,this.getModules.apply(this,e)]}})})},t.prototype.registers=function(t,e){return(e=e||[]).forEach(function(e){t.register(e)}),e},t.prototype.getModules=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=[];return e.forEach(function(e){var r=t.getTypes(e),o=r.find(function(t){return ct.hasOwnClassMetadata(ct.IocModule,t)});o?n.push(o):n.push.apply(n,r)}),n},t.prototype.getTypes=function(t){var e=[];if(u.isClass(t))e.push(t);else{var r=t.exports?t.exports:t;for(var n in r)u.isClass(r[n])&&e.push(r[n])}return e},t.classAnnations={name:"DefaultContainerBuilder",params:{constructor:["loader"],create:[],build:["options"],loadModule:["container","options"],syncBuild:["modules"],syncLoadModule:["container","modules"],loadTypes:["options"],registers:["container","types"],getModules:["modules"],getTypes:["regModule"]}},t}();r.DefaultContainerBuilder=a});n(ft);ft.DefaultContainerBuilder;return n(o(function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}r(ut),r(a),r(p),r(pt),r(ft),r(u),r(L),r(ct)}))});