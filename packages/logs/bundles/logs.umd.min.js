!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("@ts-ioc/core"),require("@ts-ioc/aop")):"function"==typeof define&&define.amd?define(["@ts-ioc/core","@ts-ioc/aop"],o):(e.logs=e.logs||{},e.logs.umd=e.logs.umd||{},e.logs.umd.js=o(e["@ts-ioc/core"],e["@ts-ioc/aop"]))}(this,function(g,s){"use strict";g=g&&g.hasOwnProperty("default")?g.default:g,s=s&&s.hasOwnProperty("default")?s.default:s;var a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,o){return e(o={exports:{}},o.exports),o.exports}var i=o(function(e,o){Object.defineProperty(o,"__esModule",{value:!0}),o.LogSymbols={LogConfigure:Symbol("LogConfigure"),ILoggerManager:Symbol("ILoggerManager"),IConfigureLoggerManager:Symbol("IConfigureLoggerManager")}});e(i);i.LogSymbols;var r=o(function(e,o){var t=a&&a.__decorate||function(e,o,t,n){var r,a=arguments.length,i=a<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,o,t,n);else for(var g=e.length-1;0<=g;g--)(r=e[g])&&(i=(a<3?r(i):3<a?r(o,t,i):r(o,t))||i);return 3<a&&i&&Object.defineProperty(o,t,i),i},n=a&&a.__metadata||function(e,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,o)},r=function(){function e(e){this.adapter=e||"console"}return e.prototype.format=function(e,o){switch(e.state){case s.JoinpointState.Before:case s.JoinpointState.Pointcut:return'%s invoke method "%s" with args %o.';case s.JoinpointState.After:return'%s invoke method "%s".';case s.JoinpointState.AfterReturning:return'Invoke method "%s" returning value %o.';case s.JoinpointState.AfterThrowing:return'Invoke method "%s" throw error %o.';default:return""}},e.prototype.formatArgs=function(e,o){switch(e.state){case s.JoinpointState.Before:case s.JoinpointState.Pointcut:return[e.state,e.fullName,e.args];case s.JoinpointState.After:return[e.state,e.fullName];case s.JoinpointState.AfterReturning:return[e.fullName,e.returningValue||""];case s.JoinpointState.AfterThrowing:return[e.fullName,e.throwing||""];default:return[]}},e.classAnnations={name:"DefaultLogConfigure",params:{constructor:["adapter"],format:["joinPoint","logger"],formatArgs:["joinPoint","logger"]}},e=t([s.NonePointcut(),g.Singleton(i.LogSymbols.LogConfigure),n("design:paramtypes",[Object])],e)}();o.DefaultLogConfigure=r});e(r);r.DefaultLogConfigure;var n=o(function(e,o){var t=a&&a.__param||function(t,n){return function(e,o){n(e,o,t)}},n=function(){function e(e,o){this.container=e,this.setLogConfigure(o)}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this.container.has(i.LogSymbols.LogConfigure)||this.container.register(r.DefaultLogConfigure),this._config=this.container.resolve(i.LogSymbols.LogConfigure)),this._config},enumerable:!0,configurable:!0}),e.prototype.setLogConfigure=function(e){e&&(g.isClass(e)?this.container.has(i.LogSymbols.LogConfigure)?this.container.has(e)||(this.container.register(e),this._config=this.container.get(e)):(this.container.register(i.LogSymbols.LogConfigure,e),this._config=this.container.get(i.LogSymbols.LogConfigure)):this._config=e,this._logManger=null)},Object.defineProperty(e.prototype,"logManger",{get:function(){if(!this._logManger){var e=this.config||{},o=e.adapter||"console",t=void 0;t=g.isString(o)?new g.Registration(i.LogSymbols.ILoggerManager,o):o,this._logManger=this.container.get(t),e.config&&this._logManger.configure(e.config)}return this._logManger},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){this.logManger.configure(e)},e.prototype.getLogger=function(e){return this.logManger.getLogger(e)},e.classAnnations={name:"ConfigureLoggerManger",params:{constructor:["container","config"],setLogConfigure:["config"],configure:["config"],getLogger:["name"]}},e=__decorate([s.NonePointcut(),g.Injectable(i.LogSymbols.IConfigureLoggerManager),t(0,g.Inject(g.symbols.IContainer)),__metadata("design:paramtypes",[Object,Object])],e)}();o.ConfigureLoggerManger=n});e(n);n.ConfigureLoggerManger;var c=o(function(e,o){var t=function(){function e(){this.logger=new n}return e.prototype.configure=function(e){},e.prototype.getLogger=function(e){return this.logger},e.classAnnations={name:"ConsoleLogManager",params:{constructor:[],configure:["config"],getLogger:["name"]}},e=__decorate([s.NonePointcut(),g.Singleton(),g.Injectable(i.LogSymbols.ILoggerManager,"console"),__metadata("design:paramtypes",[])],e)}();o.ConsoleLogManager=t;var n=function(){function e(){}return e.prototype.log=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];console.log.apply(console,e)},e.prototype.trace=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.trace.apply(console,[e].concat(o))},e.prototype.debug=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.debug.apply(console,[e].concat(o))},e.prototype.info=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.info.apply(console,[e].concat(o))},e.prototype.warn=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.warn.apply(console,[e].concat(o))},e.prototype.error=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.error.apply(console,[e].concat(o))},e.prototype.fatal=function(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];console.error.apply(console,[e].concat(o))},e.classAnnations={name:"ConsoleLog",params:{log:["args"],trace:["message","args"],debug:["message","args"],info:["message","args"],warn:["message","args"],error:["message","args"],fatal:["message","args"]}},e}()});e(c);c.ConsoleLogManager;var u=o(function(e,o){var t=function(){function e(e,o){this.container=e,this.config=o}return Object.defineProperty(e.prototype,"logger",{get:function(){return this._logger||(this._logger=this.logManger.getLogger()),this._logger},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logManger",{get:function(){return this._logManger||(this._logManger=this.container.resolve(i.LogSymbols.IConfigureLoggerManager,{config:this.config})),this._logManger},enumerable:!0,configurable:!0}),e.prototype.processLog=function(t,e){var n=this;e&&e.length?e.forEach(function(e){var o=!1;e.express&&e.express(t)?o=!0:e.express||(o=!0),o&&n.writeLog(e.logname?n.logManger.getLogger(e.logname):n.logger,t,e.message)}):this.writeLog(this.logger,t)},e.prototype.writeLog=function(e,o,t){var n=this.logManger.config,r=g.isFunction(n.customFormat);if(t&&e.info(t),r)n.customFormat(o,e);else if(n.format){var a=g.isFunction(n.format)?n.format(o,e):"";if(!a)return;var i=g.isFunction(n.formatArgs)?n.formatArgs(o,e):[];switch(o.state){case s.JoinpointState.Before:case s.JoinpointState.After:case s.JoinpointState.AfterReturning:e.debug.apply(e,[a].concat(i));break;case s.JoinpointState.Pointcut:e.info.apply(e,[a].concat(i));break;case s.JoinpointState.AfterThrowing:e.error.apply(e,[a].concat(i))}}},e.classAnnations={name:"LoggerAspect",params:{constructor:["container","config"],processLog:["joinPoint","annotation"],writeLog:["logger","joinPoint","message"]}},e}();o.LoggerAspect=t});e(u);u.LoggerAspect;var f=o(function(e,o){var n,t=a&&a.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])},function(e,o){function t(){this.constructor=e}n(e,o),e.prototype=null===o?Object.create(o):(t.prototype=o.prototype,new t)}),r=function(o){function e(e){return o.call(this,e)||this}return t(e,o),e.prototype.logging=function(e,o){this.processLog(e,o)},e.classAnnations={name:"AnnotationLogerAspect",params:{constructor:["container"],logging:["joinPoint","annotation"]}},__decorate([s.Pointcut("@annotation(Logger)","annotation"),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Joinpoint,Array]),__metadata("design:returntype",void 0)],e.prototype,"logging",null),e=__decorate([g.Singleton(),s.Aspect(),__param(0,g.Inject(g.symbols.IContainer)),__metadata("design:paramtypes",[Object])],e)}(u.LoggerAspect);o.AnnotationLogerAspect=r});e(f);f.AnnotationLogerAspect;var l=o(function(e,o){o.Logger=g.createClassMethodDecorator("Logger",function(e){e.next({isMetadata:function(e){return g.isClassMetadata(e,["logname"])},match:function(e){return g.isString(e)},setMetadata:function(e,o){e.logname=o}}),e.next({match:function(e){return g.isFunction(e)},setMetadata:function(e,o){e.express=o}}),e.next({match:function(e){return g.isString(e)},setMetadata:function(e,o){e.message=o}})})});e(l);l.Logger;var p=o(function(e,o){var t=function(){function e(e){this.container=e}return e.prototype.setup=function(){var e=this.container;e.has(s.AopModule)||e.register(s.AopModule),e.get(g.symbols.LifeScope).registerDecorator(l.Logger,g.LifeState.onInit,g.CoreActions.bindParameterProviders),e.register(n.ConfigureLoggerManger),e.register(f.AnnotationLogerAspect),e.register(c.ConsoleLogManager)},e.symbols=i.LogSymbols,e.classAnnations={name:"LogModule",params:{constructor:["container"],setup:[]}},e=__decorate([g.IocModule("setup"),__param(0,g.Inject(g.symbols.IContainer)),__metadata("design:paramtypes",[Object])],e)}();o.LogModule=t});e(p);p.LogModule;return e(o(function(e,t){function o(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}o(i),o(n),o(c),o(r),o(u),o(f),o(l),o(p)}))});