{"version":3,"file":"../bootstrap.umd.js","sources":["decorators/decorators/Annotation.ts","decorators/decorators/DIModule.ts","decorators/decorators/Bootstrap.ts","decorators/decorators/index.ts","boot/boot/AppConfigure.ts","modules/modules/DIModuleValidate.ts","utils/utils/ContainerPool.ts","utils/utils/Events.ts","utils/utils/index.ts","modules/modules/InjectedModule.ts","modules/modules/DIModuleInjector.ts","modules/modules/IModuleBuilder.ts","runnable/runnable/IRunner.ts","runnable/runnable/Service.ts","runnable/runnable/index.ts","annotations/annotations/IAnnotationBuilder.ts","annotations/annotations/AnnotationBuilder.ts","annotations/annotations/index.ts","modules/modules/ModuleBuilder.ts","modules/modules/index.ts","BootModule.ts","boot/boot/ApplicationBuilder.ts","boot/boot/IApplicationBuilder.ts","boot/boot/index.ts","index.ts"],"sourcesContent":["import { ITypeDecorator, Token, MetadataAdapter, MetadataExtends, createClassDecorator } from '@ts-ioc/core';\r\nimport { IAnnotationBuilder } from '../annotations/IAnnotationBuilder';\r\nimport { AnnotationConfigure } from '../annotations/AnnotationConfigure';\r\n\r\nexport interface AnnotationMetadata extends AnnotationConfigure<any> {\r\n\r\n}\r\n\r\n/**\r\n * Annotation decorator, use to define class build way via config.\r\n *\r\n * @export\r\n * @interface IAnnotationDecorator\r\n * @extends {ITypeDecorator<T>}\r\n * @template T\r\n */\r\nexport interface IAnnotationDecorator<T extends AnnotationMetadata> extends ITypeDecorator<T> {\r\n    /**\r\n     * Annotation decorator, use to define class as DI Module.\r\n     *\r\n     * @Build\r\n     *\r\n     * @param {T} [metadata] bootstrap metadate config.\r\n     */\r\n    (metadata: T): ClassDecorator;\r\n}\r\n\r\n/**\r\n * create type builder decorator\r\n *\r\n * @export\r\n * @template T\r\n * @param {string} name\r\n * @param {string} [decorType]\r\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>)} [builder]\r\n * @param {MetadataAdapter} [adapter]\r\n * @param {MetadataExtends<T>} [metadataExtends]\r\n * @returns {IAnnotationDecorator<T>}\r\n */\r\nexport function createAnnotationDecorator<T extends AnnotationMetadata>(\r\n    name: string,\r\n    builder?: Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>,\r\n    adapter?: MetadataAdapter,\r\n    metadataExtends?: MetadataExtends<T>): IAnnotationDecorator<T> {\r\n\r\n    return createClassDecorator<AnnotationMetadata>(name,\r\n        args => {\r\n            if (adapter) {\r\n                adapter(args);\r\n            }\r\n        },\r\n        metadata => {\r\n            if (metadataExtends) {\r\n                metadata = metadataExtends(metadata as T);\r\n            }\r\n\r\n            if (builder && !metadata.annotationBuilder) {\r\n                metadata.annotationBuilder = builder;\r\n            }\r\n            return metadata;\r\n        }) as IAnnotationDecorator<T>;\r\n}\r\n\r\n\r\n/**\r\n * Annotation decorator, use to define class build way via config.\r\n *\r\n * @Annotation\r\n */\r\nexport const Annotation: IAnnotationDecorator<AnnotationMetadata> = createAnnotationDecorator<AnnotationMetadata>('Annotation');\r\n","import { createClassDecorator, Token, MetadataAdapter, MetadataExtends, ITypeDecorator, isClass } from '@ts-ioc/core';\r\nimport { IModuleBuilder } from '../modules/IModuleBuilder';\r\nimport { ModuleConfig } from '../modules/ModuleConfigure';\r\nimport { IAnnotationBuilder } from '../annotations/IAnnotationBuilder';\r\n\r\n/**\r\n * DI module metadata.\r\n *\r\n * @export\r\n * @interface DIModuleMetadata\r\n * @extends {ModuleConfig<any>}\r\n * @extends {ClassMetadata}\r\n */\r\nexport interface DIModuleMetadata extends ModuleConfig<any> {\r\n    /**\r\n     * custom decorator type.\r\n     *\r\n     * @type {string}\r\n     * @memberof DIModuleMetadata\r\n     */\r\n    decorType?: string;\r\n}\r\n\r\n\r\n/**\r\n * DIModule decorator, use to define class as DI Module.\r\n *\r\n * @export\r\n * @interface IDIModuleDecorator\r\n * @extends {ITypeDecorator<T>}\r\n * @template T\r\n */\r\nexport interface IDIModuleDecorator<T extends DIModuleMetadata> extends ITypeDecorator<T> {\r\n    /**\r\n     * DIModule decorator, use to define class as DI Module.\r\n     *\r\n     * @DIModule\r\n     *\r\n     * @param {T} [metadata] bootstrap metadate config.\r\n     */\r\n    (metadata: T): ClassDecorator;\r\n}\r\n\r\n\r\n/**\r\n * create bootstrap decorator.\r\n *\r\n * @export\r\n * @template T\r\n * @param {string} name decorator name.\r\n * @param {(Token<IModuleBuilder> | IModuleBuilder)} [builder]\r\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>)} [annotationBuilder]\r\n * @param {MetadataAdapter} [adapter]\r\n * @param {MetadataExtends<T>} [metadataExtends]\r\n * @returns {IDIModuleDecorator<T>}\r\n */\r\nexport function createDIModuleDecorator<T extends DIModuleMetadata>(\r\n    name: string,\r\n    builder?: Token<IModuleBuilder<any>> | IModuleBuilder<any>,\r\n    annotationBuilder?: Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>,\r\n    adapter?: MetadataAdapter,\r\n    metadataExtends?: MetadataExtends<T>): IDIModuleDecorator<T> {\r\n\r\n    return createClassDecorator<DIModuleMetadata>(name,\r\n        args => {\r\n            if (adapter) {\r\n                adapter(args);\r\n            }\r\n        },\r\n        metadata => {\r\n            if (metadataExtends) {\r\n                metadata = metadataExtends(metadata as T);\r\n            }\r\n\r\n            if (!metadata.name && isClass(metadata.token)) {\r\n                let isuglify = /^[a-z]$/.test(metadata.token.name);\r\n                if (isuglify && metadata.token.classAnnations) {\r\n                    metadata.name = metadata.token.classAnnations.name;\r\n                } else {\r\n                    metadata.name = metadata.token.name;\r\n                }\r\n            }\r\n\r\n            metadata.decorType = name;\r\n            if (builder && !metadata.builder) {\r\n                metadata.builder = builder;\r\n            }\r\n            if (annotationBuilder && !metadata.annotationBuilder) {\r\n                metadata.annotationBuilder = annotationBuilder;\r\n            }\r\n            return metadata;\r\n        }) as IDIModuleDecorator<T>;\r\n}\r\n\r\n/**\r\n * DIModule Decorator, definde class as DI module.\r\n *\r\n * @DIModule\r\n */\r\nexport const DIModule: IDIModuleDecorator<DIModuleMetadata> = createDIModuleDecorator<DIModuleMetadata>('DIModule');\r\n","import {\r\n    Token, MetadataAdapter, MetadataExtends, ITypeDecorator,\r\n    Type, isClass, isFunction, LoadType, isObject\r\n} from '@ts-ioc/core';\r\nimport { AppConfigure } from '../boot/AppConfigure';\r\nimport { IApplicationBuilder } from '../boot/IApplicationBuilder';\r\nimport { IAnnotationBuilder } from '../annotations/IAnnotationBuilder';\r\nimport { createDIModuleDecorator } from './DIModule';\r\n\r\n\r\nexport interface BootstrapMetadata extends AppConfigure {\r\n    builder?: Type<IApplicationBuilder<any>> | IApplicationBuilder<any>;\r\n    globals?: LoadType[];\r\n}\r\n\r\n\r\n/**\r\n * Bootstrap decorator, use to define class is a task element.\r\n *\r\n * @export\r\n * @interface IBootstrapDecorator\r\n * @extends {ITypeDecorator<T>}\r\n * @template T\r\n */\r\nexport interface IBootstrapDecorator<T extends BootstrapMetadata> extends ITypeDecorator<T> {\r\n    /**\r\n     * Bootstrap decorator, use to define class as Application Bootstrap element.\r\n     *\r\n     * @Bootstrap\r\n     *\r\n     * @param {T} metadata bootstrap metadate config.\r\n     */\r\n    (metadata: T): ClassDecorator;\r\n}\r\n\r\n\r\n/**\r\n * create bootstrap decorator.\r\n *\r\n * @export\r\n * @template T\r\n * @param {string} name\r\n * @param {(Token<IApplicationBuilder> | IApplicationBuilder)} [builder] default builder\r\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<Tany>)} [annotationBuilder] default type builder.\r\n * @param {MetadataAdapter} [adapter]\r\n * @param {MetadataExtends<T>} [metadataExtends]\r\n * @returns {IBootstrapDecorator<T>}\r\n */\r\nexport function createBootstrapDecorator<T extends BootstrapMetadata>(\r\n    name: string,\r\n    builder?: Type<IApplicationBuilder<any>> | IApplicationBuilder<any>,\r\n    annotationBuilder?: Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>,\r\n    adapter?: MetadataAdapter,\r\n    metadataExtends?: MetadataExtends<T>): IBootstrapDecorator<T> {\r\n\r\n    return createDIModuleDecorator<BootstrapMetadata>(name, builder, annotationBuilder, adapter, (metadata: T) => {\r\n        if (metadataExtends) {\r\n            metadataExtends(metadata);\r\n        }\r\n        if (metadata.builder) {\r\n            setTimeout(() => {\r\n                let builderType = metadata.builder;\r\n                let builder: IApplicationBuilder<any>;\r\n                if (isClass(builderType)) {\r\n                    builder = isFunction(builderType['create']) ? builderType['create']() : new builderType();\r\n                } else if (isObject(builderType)) {\r\n                    builder = builderType as IApplicationBuilder<any>;\r\n                }\r\n                if (builder) {\r\n                    if (metadata.globals) {\r\n                        builder.use(...metadata.globals);\r\n                    }\r\n                    builder.bootstrap(metadata.type);\r\n                }\r\n            }, 500);\r\n        }\r\n        return metadata;\r\n    }) as IBootstrapDecorator<T>;\r\n}\r\n\r\n/**\r\n * Bootstrap Decorator, definde class as mvc bootstrap module.\r\n *\r\n * @Bootstrap\r\n */\r\nexport const Bootstrap: IBootstrapDecorator<BootstrapMetadata> = createBootstrapDecorator<BootstrapMetadata>('Bootstrap');\r\n","export * from './Annotation';\r\nexport * from './DIModule';\r\nexport * from './Bootstrap';\r\n","import { ObjectMap, InjectToken } from '@ts-ioc/core';\r\nimport { ModuleConfigure } from '../modules';\r\n\r\n\r\n/**\r\n * application configuration token.\r\n */\r\nexport const AppConfigureToken = new InjectToken<AppConfigure>('DI_APP_Configuration');\r\n\r\n/**\r\n * application default configuration token.\r\n */\r\nexport const DefaultConfigureToken = new InjectToken<AppConfigure>('DI_Default_Configuration');\r\n\r\n/**\r\n * app configuration.\r\n *\r\n * @export\r\n * @interface AppConfigure\r\n * @extends {ObjectMap<any>}\r\n */\r\nexport interface AppConfigure extends ModuleConfigure {\r\n    /**\r\n     * application name.\r\n     *\r\n     * @type {string}\r\n     * @memberof AppConfigure\r\n     */\r\n    name?: string;\r\n\r\n    /**\r\n     * app base uri.\r\n     */\r\n    baseURL?: string;\r\n\r\n    /**\r\n     * set enable debug log or not.\r\n     *\r\n     * @type {boolean}\r\n     * @memberof AppConfigure\r\n     */\r\n    debug?: boolean;\r\n\r\n    /**\r\n     * log config.\r\n     *\r\n     * @type {*}\r\n     * @memberof AppConfigure\r\n     */\r\n    logConfig?: any;\r\n\r\n    /**\r\n     * custom config key value setting.\r\n     *\r\n     * @type {IMap<any>}\r\n     * @memberOf AppConfigure\r\n     */\r\n    setting?: ObjectMap<any>;\r\n\r\n    /**\r\n     * custom config connections.\r\n     *\r\n     * @type {ObjectMap<any>}\r\n     * @memberof AppConfigure\r\n     */\r\n    connections?: ObjectMap<any>;\r\n\r\n}\r\n\r\n/**\r\n * app configure loader.\r\n *\r\n * @export\r\n * @interface IAppConfigureLoader\r\n */\r\nexport interface IAppConfigureLoader {\r\n    /**\r\n     * load config.\r\n     *\r\n     * @param {string} [uri]\r\n     * @returns {Promise<AppConfigure>}\r\n     * @memberof AppConfigureLoader\r\n     */\r\n    load(uri?: string): Promise<AppConfigure>;\r\n}\r\n\r\n/**\r\n *  app configure loader token.\r\n */\r\nexport const AppConfigureLoaderToken = new InjectToken<IAppConfigureLoader>('DI_Configure_Loader');\r\n\r\n/**\r\n * configure merger\r\n *\r\n * @export\r\n * @interface IConfigureMerger\r\n */\r\nexport interface IConfigureMerger {\r\n    /**\r\n     * merge configuration.\r\n     *\r\n     * @param {AppConfigure} config\r\n     * @param {ModuleConfigure} moduleMetadata\r\n     * @returns {AppConfigure}\r\n     * @memberof IConfigureMerger\r\n     */\r\n    merge(config: AppConfigure, moduleMetadata: ModuleConfigure): AppConfigure;\r\n}\r\n","import { Singleton, InjectModuleValidateToken, BaseModuelValidate, IModuleValidate } from '@ts-ioc/core';\r\nimport { DIModule } from '../decorators';\r\n\r\n/**\r\n * DIModuel Validate Token\r\n */\r\nexport const DIModuelValidateToken = new InjectModuleValidateToken<IModuleValidate>(DIModule.toString());\r\n\r\n/**\r\n * DIModuel Validate\r\n *\r\n * @export\r\n * @class DIModuelValidate\r\n * @extends {BaseModuelValidate}\r\n */\r\n@Singleton(DIModuelValidateToken)\r\nexport class DIModuelValidate extends BaseModuelValidate {\r\n    getDecorator() {\r\n        return DIModule.toString();\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"DIModuelValidate\",\"params\":{\"getDecorator\":[]}};\n                   }\r\n","import { MapSet, Token, SymbolType, Registration, IContainer, InjectToken, IContainerBuilder } from '@ts-ioc/core';\r\n\r\n/**\r\n * container pool\r\n *\r\n * @export\r\n * @class ContainerPool\r\n */\r\nexport class ContainerPool {\r\n    protected pools: MapSet<Token<any>, IContainer>;\r\n\r\n    constructor(protected containerBuilder: IContainerBuilder) {\r\n        this.pools = new MapSet();\r\n    }\r\n\r\n    protected createContainer(): IContainer {\r\n        return this.containerBuilder.create();\r\n    }\r\n\r\n\r\n    getTokenKey(token: Token<any>): SymbolType<any> {\r\n        if (token instanceof Registration) {\r\n            return token.toString();\r\n        }\r\n        return token;\r\n    }\r\n\r\n    isDefault(container: IContainer): boolean {\r\n        return container === this._default;\r\n    }\r\n    hasDefault(): boolean {\r\n        return !!this._default;\r\n    }\r\n    _default: IContainer;\r\n\r\n    getDefault(): IContainer {\r\n        if (!this._default) {\r\n            this._default = this.createContainer();\r\n        }\r\n        return this._default;\r\n    }\r\n\r\n    set(token: Token<any>, container: IContainer) {\r\n        let key = this.getTokenKey(token);\r\n        if (this.pools.has(token)) {\r\n            console.log(`${token.toString()} module has loaded`);\r\n        }\r\n        this.pools.set(token, container);\r\n    }\r\n\r\n    get(token: Token<any>): IContainer {\r\n        let key = this.getTokenKey(token);\r\n        if (!this.has(key)) {\r\n            return null;\r\n        }\r\n        return this.pools.get(token);\r\n    }\r\n\r\n    has(token: Token<any>): boolean {\r\n        return this.pools.has(this.getTokenKey(token));\r\n    }\r\n\r\n    create(parent?: IContainer): IContainer {\r\n        parent = parent || this.getDefault();\r\n        let container = parent.getBuilder().create();\r\n        this.setParent(container, parent);\r\n        return container;\r\n    }\r\n\r\n    setParent(container: IContainer, parent?: IContainer) {\r\n        if (this.isDefault(container)) {\r\n            return;\r\n        }\r\n        // if (!container.parent) {\r\n        if (parent && parent !== container) {\r\n            container.parent = parent;\r\n        } else {\r\n            container.parent = this.getDefault();\r\n        }\r\n        // }\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"ContainerPool\",\"params\":{\"constructor\":[\"containerBuilder\"],\"createContainer\":[],\"getTokenKey\":[\"token\"],\"isDefault\":[\"container\"],\"hasDefault\":[],\"getDefault\":[],\"set\":[\"token\",\"container\"],\"get\":[\"token\"],\"has\":[\"token\"],\"create\":[\"parent\"],\"setParent\":[\"container\",\"parent\"]}};\n                   }\r\n\r\nexport const ContainerPoolToken = new InjectToken<ContainerPool>('ContainerPool');\r\n\r\n// /**\r\n//  *  global container pools.\r\n//  */\r\n// export const containerPools = new ContainerPool();\r\n","import { ObjectMap, isArray } from '@ts-ioc/core';\r\n\r\n/**\r\n * events\r\n *\r\n * @export\r\n * @interface IEvents\r\n */\r\nexport interface IEvents {\r\n    /**\r\n     * add event.\r\n     *\r\n     * @param {string} name\r\n     * @param {(...args: any[]) => void} event\r\n     * @returns {this}\r\n     * @memberof IEvents\r\n     */\r\n    on(name: string, event: (...args: any[]) => void): this;\r\n    /**\r\n     * remove event.\r\n     *\r\n     * @param {string} name\r\n     * @param {(...args: any[]) => void} [event]\r\n     * @returns {this}\r\n     * @memberof IEvents\r\n     */\r\n    off(name: string, event?: (...args: any[]) => void): this;\r\n    /**\r\n     * emit event.\r\n     *\r\n     * @param {string} name\r\n     * @param {...any[]} args\r\n     * @memberof IEvents\r\n     */\r\n    emit(name: string, ...args: any[]): void;\r\n}\r\n\r\n/**\r\n * custom events.\r\n *\r\n * @export\r\n * @class Events\r\n */\r\nexport class Events implements IEvents {\r\n    eventsMap: ObjectMap<Function[]>;\r\n    constructor() {\r\n        this.eventsMap = {};\r\n    }\r\n\r\n    on(name: string, event: (...args: any[]) => void) {\r\n        this.eventsMap[name] = this.eventsMap[name] || [];\r\n        if (this.eventsMap[name].indexOf(event) < 0) {\r\n            this.eventsMap[name].push(event);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    off(name: string, event?: (...args: any[]) => void) {\r\n        if (this.eventsMap[name]) {\r\n            if (event) {\r\n                this.eventsMap[name].splice(this.eventsMap[name].indexOf(event), 1);\r\n            } else {\r\n                delete this.eventsMap[name];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    emit(name: string, ...args: any[]) {\r\n        let events = this.eventsMap[name];\r\n        if (isArray(events)) {\r\n            events.forEach(ev => {\r\n                ev(...args);\r\n            });\r\n        }\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"Events\",\"params\":{\"constructor\":[],\"on\":[\"name\",\"event\"],\"off\":[\"name\",\"event\"],\"emit\":[\"name\",\"args\"]}};\n                   }\r\n","export * from './ContainerPool';\r\nexport * from './Events';\r\n","import { Token, IContainer, Registration, Type, IExports } from '@ts-ioc/core';\r\nimport { ModuleConfig } from './ModuleConfigure';\r\n\r\n/**\r\n * injected module.\r\n *\r\n * @export\r\n * @class InjectedModule\r\n * @template T\r\n */\r\nexport class InjectedModule<T> implements IExports {\r\n\r\n    constructor(\r\n        public token: Token<T>,\r\n        public config: ModuleConfig<T>,\r\n        public container: IContainer,\r\n        public type?: Type<any>,\r\n        public exports?: Token<any>[],\r\n        public providers?: Token<any>[]\r\n    ) {\r\n\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectedModule\",\"params\":{\"constructor\":[\"token\",\"config\",\"container\",\"type\",\"exports\",\"providers\"]}};\n                   }\r\n\r\n\r\n\r\n/**\r\n * Injected Module Token.\r\n *\r\n * @export\r\n * @class InjectModuleMetaConfigToken\r\n * @extends {Registration<Type<T>>}\r\n * @template T\r\n */\r\nexport class InjectedModuleToken<T> extends Registration<InjectedModule<T>> {\r\n    constructor(type: Type<T>) {\r\n        super(type, 'InjectedModule')\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectedModuleToken\",\"params\":{\"constructor\":[\"type\"]}};\n                   }\r\n","import {\r\n    Type, IContainer, ModuleInjector, InjectModuleInjectorToken, IModuleValidate,\r\n    Inject, Token, isToken, Providers, Injectable, isArray, lang, isUndefined, isClass,\r\n    isFunction, isString, isNull, isProviderMap, Provider, isBaseObject, IModuleInjector, Container\r\n} from '@ts-ioc/core';\r\nimport { DIModuelValidateToken } from './DIModuleValidate';\r\nimport { DIModule } from '../decorators';\r\nimport { ContainerPoolToken } from '../utils';\r\nimport { ModuleConfigure, ModuleConfig } from './ModuleConfigure';\r\nimport { InjectedModuleToken, InjectedModule } from './InjectedModule';\r\n\r\nconst exportsProvidersFiled = '__exportProviders';\r\n\r\n/**\r\n * DIModule injector interface.\r\n *\r\n * @export\r\n * @interface IDIModuleInjector\r\n * @extends {IModuleInjector}\r\n */\r\nexport interface IDIModuleInjector extends IModuleInjector {\r\n    /**\r\n     * import module type.\r\n     *\r\n     * @template T\r\n     * @param {IContainer} container\r\n     * @param {Type<T>} type\r\n     * @returns {Promise<InjectedModule<T>>}\r\n     * @memberof IDIModuleInjector\r\n     */\r\n    import<T>(container: IContainer, type: Type<T>): Promise<InjectedModule<T>>;\r\n\r\n    /**\r\n     * import by config.\r\n     *\r\n     * @template T\r\n     * @param {IContainer} container\r\n     * @param {ModuleConfig<T>} config\r\n     * @returns {Promise<any>>}\r\n     * @memberof IDIModuleInjector\r\n     */\r\n    importByConfig<T>(container: IContainer, config: ModuleConfig<T>): Promise<any>;\r\n}\r\n\r\n/**\r\n * DIModule injector token.\r\n */\r\nexport const DIModuleInjectorToken = new InjectModuleInjectorToken<IDIModuleInjector>(DIModule.toString());\r\n\r\n/**\r\n * DIModule injector.\r\n *\r\n * @export\r\n * @class DIModuleInjector\r\n * @extends {ModuleInjector}\r\n */\r\n@Injectable(DIModuleInjectorToken)\r\nexport class DIModuleInjector extends ModuleInjector implements IDIModuleInjector {\r\n\r\n    constructor(@Inject(DIModuelValidateToken) validate: IModuleValidate) {\r\n        super(validate)\r\n    }\r\n\r\n    protected async setup(container: IContainer, type: Type<any>) {\r\n        await this.importModule(container, type);\r\n    }\r\n\r\n    async import<T>(container: IContainer, type: Type<T>): Promise<InjectedModule<T>> {\r\n        if (this.validate.validate(type)) {\r\n            let injMd = await this.importModule(container, type);\r\n            return injMd;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    async importByConfig<T>(container: IContainer, config: ModuleConfig<T>): Promise<any> {\r\n        await this.registerConfgureDepds(container, config);\r\n        if (isArray(config.providers) && config.providers.length) {\r\n            await this.bindProvider(container, config.providers);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected async importModule(container: IContainer, type: Type<any>): Promise<InjectedModule<any>> {\r\n        let pools = container.get(ContainerPoolToken);\r\n        let newContainer = pools.create(container);\r\n        newContainer.register(type);\r\n        let metaConfig = this.validate.getMetaConfig(type, newContainer) as ModuleConfigure;\r\n        metaConfig = await this.registerConfgureDepds(newContainer, metaConfig);\r\n\r\n        let injMd = new InjectedModule(metaConfig.token || type, metaConfig, newContainer, type, metaConfig.exports || [], metaConfig[exportsProvidersFiled]);\r\n        container.bindProvider(new InjectedModuleToken(type), injMd);\r\n\r\n        await this.importConfigExports(container, newContainer, injMd);\r\n\r\n        return injMd;\r\n    }\r\n\r\n\r\n    protected async registerConfgureDepds(container: IContainer, config: ModuleConfigure): Promise<ModuleConfigure> {\r\n        if (isArray(config.imports) && config.imports.length) {\r\n            await container.loadModule(...config.imports);\r\n        }\r\n\r\n        if (isArray(config.providers) && config.providers.length) {\r\n            config[exportsProvidersFiled] = this.bindProvider(container, config.providers);\r\n        }\r\n        return config;\r\n    }\r\n\r\n    protected async importConfigExports(container: IContainer, providerContainer: IContainer, injMd: InjectedModule<any>) {\r\n        if (container === providerContainer) {\r\n            return container;\r\n        }\r\n        if (injMd) {\r\n            container.resolvers.next(injMd);\r\n            if (injMd.exports && injMd.exports.length) {\r\n                let expchs = providerContainer.resolvers.toArray().filter(r => {\r\n                    if (r instanceof Container) {\r\n                        return false;\r\n                    } else {\r\n                        return injMd.exports.indexOf(r.type) >= 0\r\n                    }\r\n                });\r\n                expchs.forEach(r => {\r\n                    container.resolvers.next(r);\r\n                });\r\n            }\r\n        }\r\n\r\n        return container;\r\n    }\r\n\r\n    protected bindProvider(container: IContainer, providers: Providers[]): Token<any>[] {\r\n        let tokens: Token<any>[] = [];\r\n        providers.forEach((p, index) => {\r\n            if (isUndefined(p) || isNull(p)) {\r\n                return;\r\n            }\r\n            if (isProviderMap(p)) {\r\n                p.forEach((k, f) => {\r\n                    tokens.push(k);\r\n                    container.bindProvider(k, f);\r\n                });\r\n            } else if (p instanceof Provider) {\r\n                tokens.push(p.type);\r\n                container.bindProvider(p.type, (...providers: Providers[]) => p.resolve(container, ...providers));\r\n            } else if (isClass(p)) {\r\n                if (!container.has(p)) {\r\n                    tokens.push(p);\r\n                    container.register(p);\r\n                }\r\n            } else if (isBaseObject(p)) {\r\n                let pr: any = p;\r\n                let isobjMap = false;\r\n                if (isToken(pr.provide)) {\r\n                    if (isArray(pr.deps) && pr.deps.length) {\r\n                        pr.deps.forEach(d => {\r\n                            if (isClass(d) && !container.has(d)) {\r\n                                container.register(d);\r\n                            }\r\n                        });\r\n                    }\r\n                    if (!isUndefined(pr.useValue)) {\r\n                        tokens.push(pr.provide);\r\n                        container.bindProvider(pr.provide, () => pr.useValue);\r\n                    } else if (isClass(pr.useClass)) {\r\n                        if (!container.has(pr.useClass)) {\r\n                            container.register(pr.useClass);\r\n                        }\r\n                        tokens.push(pr.provide);\r\n                        container.bindProvider(pr.provide, pr.useClass);\r\n                    } else if (isFunction(pr.useFactory)) {\r\n                        tokens.push(pr.provide);\r\n                        container.bindProvider(pr.provide, () => {\r\n                            let args = [];\r\n                            if (isArray(pr.deps) && pr.deps.length) {\r\n                                args = pr.deps.map(d => {\r\n                                    if (isClass(d)) {\r\n                                        return container.get(d);\r\n                                    } else {\r\n                                        return d;\r\n                                    }\r\n                                });\r\n                            }\r\n                            return pr.useFactory.apply(pr, args);\r\n                        });\r\n                    } else if (isToken(pr.useExisting)) {\r\n                        if (container.has(pr.useExisting)) {\r\n                            tokens.push(pr.provide);\r\n                            container.bindProvider(pr.provide, pr.useExisting);\r\n                        } else {\r\n                            console.log('has not register:', pr.useExisting);\r\n                        }\r\n                    } else {\r\n                        isobjMap = true;\r\n                    }\r\n                } else {\r\n                    isobjMap = true;\r\n                }\r\n\r\n                if (isobjMap) {\r\n                    lang.forIn<any>(p, (val, name: string) => {\r\n                        if (!isUndefined(val)) {\r\n                            if (isClass(val)) {\r\n                                container.bindProvider(name, val);\r\n                            } else if (isFunction(val) || isString(val)) {\r\n                                container.bindProvider(name, () => val);\r\n                            } else {\r\n                                container.bindProvider(name, val);\r\n                            }\r\n                            tokens.push(name);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (isFunction(p)) {\r\n                tokens.push(name);\r\n                container.bindProvider(name, () => p);\r\n            }\r\n        });\r\n\r\n        return tokens;\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"DIModuleInjector\",\"params\":{\"constructor\":[\"validate\"],\"setup\":[\"container\",\"type\"],\"import\":[\"container\",\"type\"],\"importByConfig\":[\"container\",\"config\"],\"importModule\":[\"container\",\"type\"],\"registerConfgureDepds\":[\"container\",\"config\"],\"importConfigExports\":[\"container\",\"providerContainer\",\"injMd\"],\"bindProvider\":[\"container\",\"providers\"]}};\n                   }\r\n","import { Registration, IContainer, Token } from '@ts-ioc/core';\r\nimport { ModuleConfig } from './ModuleConfigure';\r\nimport { MdInstance } from './ModuleType';\r\nimport { ContainerPool } from '../utils';\r\nimport { Runnable } from '../runnable';\r\nimport { InjectedModule } from './InjectedModule';\r\n\r\nconst moduleBuilderDesc = 'DI_ModuleBuilder';\r\n\r\n/**\r\n * inject module builder token.\r\n *\r\n * @export\r\n * @class InjectModuleBuilder\r\n * @extends {Registration<T>}\r\n * @template T\r\n */\r\nexport class InjectModuleBuilderToken<T> extends Registration<IModuleBuilder<T>> {\r\n    constructor(type: Token<T>) {\r\n        super(type, moduleBuilderDesc);\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectModuleBuilderToken\",\"params\":{\"constructor\":[\"type\"]}};\n                   }\r\n\r\n/**\r\n * load default container or, loaded module.\r\n */\r\nexport type ModuleEnv = IContainer | InjectedModule<any>;\r\n\r\n\r\n/**\r\n * Generics module builder insterface.\r\n *\r\n * @export\r\n * @interface IGModuleBuilder\r\n * @template T\r\n */\r\nexport interface IModuleBuilder<T> {\r\n\r\n    /**\r\n     * get container pool\r\n     *\r\n     * @returns {ContainerPool}\r\n     * @memberof IModuleBuilder\r\n     */\r\n    getPools(): ContainerPool;\r\n\r\n    /**\r\n     * import module.\r\n     *\r\n     * @param {Token<T>} module\r\n     * @param {IContainer} [parent]\r\n     * @returns {Promise<InjectedModule<T>>}\r\n     * @memberof IModuleBuilder\r\n     */\r\n    import(module: Token<T>, parent?: IContainer): Promise<InjectedModule<T>>;\r\n\r\n    /**\r\n     * build module as ioc container.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @param {*} [data] bootstrap data, build data, Runnable data.\r\n     * @returns {Promise<T>}\r\n     * @memberof IModuleBuilder\r\n     */\r\n    build(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv, data?: any): Promise<T>;\r\n\r\n\r\n\r\n    /**\r\n     * bootstrap module's main.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @param {*} [data] bootstrap data, build data, Runnable data.\r\n     * @returns {Promise<MdInstance<T>>}\r\n     * @memberof IGModuleBuilder\r\n     */\r\n    bootstrap(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv, data?: any): Promise<Runnable<T>>;\r\n\r\n}\r\n\r\n/**\r\n * default module builder token.\r\n */\r\nexport const DefaultModuleBuilderToken = new InjectModuleBuilderToken<any>(Object);\r\n\r\n/**\r\n * module builder token.\r\n */\r\nexport const ModuleBuilderToken = new Registration<AnyModuleBuilder>('any', moduleBuilderDesc);\r\n\r\n/**\r\n *  module builder. objected generics to any\r\n *\r\n * @export\r\n * @interface AnyModuleBuilder\r\n * @extends {IModuleBuilder<any>}\r\n */\r\nexport interface AnyModuleBuilder extends IModuleBuilder<any> {\r\n\r\n    /**\r\n     * build module as ioc container.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @param {*} [data]\r\n     * @returns {Promise<T>}\r\n     * @memberof AnyModuleBuilder\r\n     */\r\n    build<T>(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv, data?: any): Promise<MdInstance<T>>;\r\n\r\n}\r\n\r\n","import { Registration, Token } from '@ts-ioc/core';\r\nimport { ModuleConfigure } from '../modules';\r\n\r\n/**\r\n * application runer.\r\n *\r\n * @export\r\n * @interface IRunner\r\n * @template T\r\n */\r\nexport interface IRunner<T> {\r\n\r\n    /**\r\n     * run application via boot instance.\r\n     *\r\n     * @param {*} [data]\r\n     * @returns {Promise<any>}\r\n     * @memberof IRunner\r\n     */\r\n    run(data?: any): Promise<any>;\r\n}\r\n\r\n/**\r\n * boot element.\r\n *\r\n * @export\r\n * @abstract\r\n * @class Boot\r\n * @implements {IBoot}\r\n */\r\nexport abstract class Runner<T> implements IRunner<T> {\r\n\r\n    constructor(protected token?: Token<T>, protected instance?: T, protected config?: ModuleConfigure) {\r\n\r\n    }\r\n\r\n    /**\r\n     * run boot.\r\n     *\r\n     * @abstract\r\n     * @param {*} [data]\r\n     * @returns {Promise<any>}\r\n     * @memberof Runner\r\n     */\r\n    abstract run(data?: any): Promise<any>;\r\n\n                        static classAnnations:any  = {\"name\":\"Runner\",\"params\":{\"constructor\":[\"token\",\"instance\",\"config\"],\"run\":[\"data\"]}};\n                   }\r\n\r\n/**\r\n * boot element\r\n *\r\n * @export\r\n * @class Boot\r\n * @extends {Runner<any>}\r\n */\r\nexport abstract class Boot extends Runner<any> {\r\n    constructor(protected token?: Token<any>, protected instance?: any, protected config?: ModuleConfigure) {\r\n        super(token, instance, config);\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"Boot\",\"params\":{\"constructor\":[\"token\",\"instance\",\"config\"]}};\n                   }\r\n\r\n\r\n/**\r\n * application runner token.\r\n *\r\n * @export\r\n * @class InjectRunnerToken\r\n * @extends {Registration<IRunner<T>>}\r\n * @template T\r\n */\r\nexport class InjectRunnerToken<T> extends Registration<IRunner<T>> {\r\n    constructor(type: Token<T>) {\r\n        super(type, 'boot__runner');\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectRunnerToken\",\"params\":{\"constructor\":[\"type\"]}};\n                   }\r\n\r\n\r\n/**\r\n * default runner token.\r\n */\r\nexport const DefaultRunnerToken = new InjectRunnerToken<any>('default');\r\n","import { Token, Registration } from '@ts-ioc/core';\r\nimport { ModuleConfigure } from '../modules';\r\n\r\n/**\r\n * IService interface\r\n *\r\n * @export\r\n * @interface IService\r\n */\r\nexport interface IService<T> {\r\n\r\n    /**\r\n     * start application service.\r\n     *\r\n     * @returns {Promise<any>}\r\n     * @memberof IService\r\n     */\r\n    start(data?: any): Promise<any>;\r\n    /**\r\n     * stop server.\r\n     *\r\n     * @returns {Promise<any>}\r\n     * @memberof IService\r\n     */\r\n    stop?(): Promise<any>;\r\n}\r\n\r\n/**\r\n * base service.\r\n *\r\n * @export\r\n * @abstract\r\n * @class Service\r\n * @implements {IService}\r\n */\r\nexport abstract class Service<T> implements IService<T> {\r\n\r\n    constructor(protected token?: Token<T>, protected instance?: T, protected config?: ModuleConfigure) {\r\n\r\n    }\r\n    /**\r\n     * start service.\r\n     *\r\n     * @abstract\r\n     * @param {*} [data]\r\n     * @returns {Promise<any>}\r\n     * @memberof Service\r\n     */\r\n    abstract start(data?: any): Promise<any>;\r\n    /**\r\n     * stop service.\r\n     *\r\n     * @abstract\r\n     * @returns {Promise<any>}\r\n     * @memberof Service\r\n     */\r\n    abstract stop(): Promise<any>;\r\n\n                        static classAnnations:any  = {\"name\":\"Service\",\"params\":{\"constructor\":[\"token\",\"instance\",\"config\"],\"start\":[\"data\"],\"stop\":[]}};\n                   }\r\n\r\n\r\n/**\r\n * application service token.\r\n *\r\n * @export\r\n * @class InjectServiceToken\r\n * @extends {Registration<IService<T>>}\r\n * @template T\r\n */\r\nexport class InjectServiceToken<T> extends Registration<IService<T>> {\r\n    constructor(type: Token<T>) {\r\n        super(type, 'boot__service');\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectServiceToken\",\"params\":{\"constructor\":[\"type\"]}};\n                   }\r\n\r\n/**\r\n * default service token.\r\n */\r\nexport const DefaultServiceToken = new InjectServiceToken<any>('default');\r\n","export * from './IRunner';\r\nexport * from './Service';\r\nexport * from './types';\r\n","import { Registration, IContainer, Token } from '@ts-ioc/core';\r\nimport { AnnotationConfigure } from './AnnotationConfigure';\r\n\r\n\r\nconst annoBuilderDesc = 'DI_AnnotationBuilder';\r\n\r\n\r\n/**\r\n * Annotation class builder.\r\n *\r\n * @export\r\n * @interface IBootBuilder\r\n */\r\nexport interface IAnnotationBuilder<T> {\r\n\r\n    /**\r\n     * container.\r\n     *\r\n     * @type {IContainer}\r\n     * @memberof IBootstrapBuilder\r\n     */\r\n    container: IContainer;\r\n\r\n    /**\r\n     * build token type via config.\r\n     *\r\n     * @param {Token<T>} token\r\n     * @param {AnnotationConfigure<T>} [config]\r\n     * @param {*} [data] build data\r\n     * @returns {Promise<T>}\r\n     * @memberof ITypeBuilder\r\n     */\r\n    build(token: Token<T>, config?: AnnotationConfigure<T>, data?: any): Promise<T>;\r\n\r\n    /**\r\n     * build instance via type config.\r\n     *\r\n     * @param {(Token<T> | AnnotationConfigure<T>)} config\r\n     * @param {*} [data] build data\r\n     * @returns {Promise<T>}\r\n     * @memberof IBootBuilder\r\n     */\r\n    buildByConfig(config: Token<T> | AnnotationConfigure<T>, data?: any): Promise<T>;\r\n\r\n    /**\r\n     * get finally builder by token and config.\r\n     *\r\n     * @param {Token<T>} token\r\n     * @param {AnnotationConfigure<T>} [config]\r\n     * @returns {IAnnotationBuilder<T>}\r\n     * @memberof IBootBuilder\r\n     */\r\n    getBuilder(token: Token<T>, config?: AnnotationConfigure<T>): IAnnotationBuilder<T>;\r\n\r\n    /**\r\n     * get annoation type token.\r\n     *\r\n     * @param {AnnotationConfigure<T>} config\r\n     * @returns {Token<T>}\r\n     * @memberof IBootstrapBuilder\r\n     */\r\n    getType(config: AnnotationConfigure<T>): Token<T>;\r\n\r\n    /**\r\n     * create token instance.\r\n     *\r\n     * @param {Token<T>} token\r\n     * @param {AnnotationConfigure<T>} config\r\n     * @param {*} [data] the data to init instance.\r\n     * @returns {Promise<T>}\r\n     * @memberof IBootstrapBuilder\r\n     */\r\n    createInstance(token: Token<T>, config: AnnotationConfigure<T>, data?: any): Promise<T>;\r\n\r\n    /**\r\n     * bundle bootstrap instance via config.\r\n     *\r\n     * @param {T} instance\r\n     * @param {AnnotationConfigure<T>} config\r\n     * @param {IContainer} [container]\r\n     * @returns {Promise<T>}\r\n     * @memberof IBootstrapBuilder\r\n     */\r\n    buildStrategy(instance: T, config: AnnotationConfigure<T>): Promise<T>;\r\n}\r\n\r\n/**\r\n * any class bootstrap builder\r\n *\r\n * @export\r\n * @interface AnyBootstrapBuilder\r\n * @extends {IAnnotationBuilder<any>}\r\n */\r\nexport interface IAnyTypeBuilder extends IAnnotationBuilder<any> {\r\n    /**\r\n     * bootstrap ioc module.\r\n     *\r\n     * @template T\r\n     * @param {Token<T>} token\r\n     * @param {AnnotationConfigure<T>} config\r\n     * @param {*} [data]\r\n     * @returns {Promise<T>}\r\n     * @memberof AnyBootstrapBuilder\r\n     */\r\n    build<T>(token: Token<T>, config: AnnotationConfigure<T>, data?: any): Promise<T>;\r\n}\r\n\r\n/**\r\n * inject Annotation class builder.\r\n *\r\n * @export\r\n * @class InjectBootstrapBuilder\r\n * @extends {Registration<T>}\r\n * @template T\r\n */\r\nexport class InjectAnnotationBuilder<T> extends Registration<IAnnotationBuilder<T>> {\r\n    constructor(type: Token<T>) {\r\n        super(type, annoBuilderDesc);\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectAnnotationBuilder\",\"params\":{\"constructor\":[\"type\"]}};\n                   }\r\n\r\n\r\n/**\r\n * Annotation class builder token.\r\n */\r\nexport const AnnotationBuilderToken = new Registration<IAnyTypeBuilder>(Object, annoBuilderDesc);\r\n\r\n/**\r\n * Default Annotation class builder token.\r\n */\r\nexport const DefaultAnnotationBuilderToken = new InjectAnnotationBuilder<any>('default');\r\n","import { IAnnotationBuilder, AnnotationBuilderToken, InjectAnnotationBuilder } from './IAnnotationBuilder';\r\nimport {\r\n    Token, isToken, IContainer, isClass, Inject, ContainerToken, Type,\r\n    lang, isFunction, Injectable, AnnotationMetaAccessorToken\r\n} from '@ts-ioc/core';\r\nimport { AnnotationConfigure } from './AnnotationConfigure';\r\nimport { Annotation } from '../decorators';\r\nimport { AnnoInstance } from './IAnnotation';\r\n\r\n/**\r\n * Annotation class builder. build class with metadata and config.\r\n *\r\n * @export\r\n * @class AnnotationBuilder\r\n * @implements {implements IAnnotationBuilder<T>}\r\n * @template T\r\n */\r\n@Injectable(AnnotationBuilderToken)\r\nexport class AnnotationBuilder<T> implements IAnnotationBuilder<T> {\r\n    /**\r\n     * ioc container.\r\n     *\r\n     * @type {IContainer}\r\n     * @memberof BootBuilder\r\n     */\r\n    @Inject(ContainerToken)\r\n    public container: IContainer;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    async build(token: Token<T>, config?: AnnotationConfigure<T>, data?: any): Promise<T> {\r\n        if (isClass(token) && !this.container.hasRegister(token)) {\r\n            this.container.register(token);\r\n        }\r\n        config = this.getTokenMetaConfig(token, config);\r\n        let builder = this.getBuilder(token, config);\r\n        if (!this.isEqual(builder)) {\r\n            return builder.build(token, config, data);\r\n        } else {\r\n            await this.registerExts(config);\r\n            let instance = await this.createInstance(token, config, data) as AnnoInstance<T>;\r\n            if (!instance) {\r\n                return null;\r\n            }\r\n            if (isFunction(instance.anBeforeInit)) {\r\n                await Promise.resolve(instance.anBeforeInit(config));\r\n            }\r\n            instance = await this.buildStrategy(instance, config) as AnnoInstance<T>;\r\n            if (isFunction(instance.anAfterInit)) {\r\n                await Promise.resolve(instance.anAfterInit(config));\r\n            }\r\n            return instance;\r\n        }\r\n    }\r\n\r\n    async buildByConfig(config: Token<T> | AnnotationConfigure<T>, data?: any): Promise<any> {\r\n        let token: Token<T>;\r\n        if (isToken(config)) {\r\n            token = config;\r\n            return this.build(token, null, data);\r\n        } else {\r\n            token = this.getType(config);\r\n            return this.build(token, config, data);\r\n        }\r\n    }\r\n\r\n    async createInstance(token: Token<T>, config: AnnotationConfigure<T>, data?: any): Promise<T> {\r\n        if (!token) {\r\n            console.log('can not find annotation token.');\r\n            return null;\r\n        }\r\n\r\n        if (!this.container.has(token)) {\r\n            console.log(`can not find token ${token ? token.toString() : null} in container.`);\r\n            return null;\r\n        }\r\n\r\n\r\n        let instance = this.resolveToken(token, data);\r\n        return instance;\r\n    }\r\n\r\n    getBuilder(token: Token<T>, config?: AnnotationConfigure<T>): IAnnotationBuilder<T> {\r\n        let builder: IAnnotationBuilder<T>;\r\n        if (config && config.annotationBuilder) {\r\n            if (isClass(config.annotationBuilder)) {\r\n                if (!this.container.has(config.annotationBuilder)) {\r\n                    this.container.register(config.annotationBuilder);\r\n                }\r\n            }\r\n            if (isToken(config.annotationBuilder)) {\r\n                builder = this.container.resolve(config.annotationBuilder, { container: this.container });\r\n            } else if (config.annotationBuilder instanceof AnnotationBuilder) {\r\n                builder = config.annotationBuilder;\r\n            }\r\n        }\r\n        if (!builder && token) {\r\n            this.container.getTokenExtendsChain(token).forEach(tk => {\r\n                if (builder) {\r\n                    return false;\r\n                }\r\n                let buildToken = new InjectAnnotationBuilder<T>(tk);\r\n                if (this.container.has(buildToken)) {\r\n                    builder = this.container.resolve(buildToken, { container: this.container });\r\n                }\r\n                return true;\r\n            });\r\n        }\r\n\r\n        if (builder && !builder.container) {\r\n            builder.container = this.container;\r\n        }\r\n        return builder || this;\r\n    }\r\n\r\n    /**\r\n     * bundle instance via config.\r\n     *\r\n     * @param {T} instance\r\n     * @param {AnnotationConfigure} config\r\n     * @param {IContainer} [container]\r\n     * @returns {Promise<T>}\r\n     * @memberof BootBuilder\r\n     */\r\n    async buildStrategy(instance: T, config: AnnotationConfigure<T>): Promise<T> {\r\n        return instance;\r\n    }\r\n\r\n    getType(config: AnnotationConfigure<T>): Token<T> {\r\n        return config.token || config.type;\r\n    }\r\n\r\n    /**\r\n     * register extension before create instance.\r\n     *\r\n     * @protected\r\n     * @param {AnnotationConfigure<T>} [config]\r\n     * @memberof AnnotationBuilder\r\n     */\r\n    protected async registerExts(config?: AnnotationConfigure<T>) {\r\n\r\n    }\r\n\r\n    protected getTokenMetaConfig(token: Token<T>, config?: AnnotationConfigure<T>): AnnotationConfigure<T> {\r\n        let cfg: AnnotationConfigure<T>;\r\n        if (isClass(token)) {\r\n            cfg = this.getMetaConfig(token);\r\n        } else if (isToken(token)) {\r\n            let tokenType = this.container ? this.container.getTokenImpl(token) : token;\r\n            if (isClass(tokenType)) {\r\n                cfg = this.getMetaConfig(tokenType);\r\n            }\r\n        }\r\n        if (cfg) {\r\n            return lang.assign({}, cfg, config || {});\r\n        } else {\r\n            return config || {};\r\n        }\r\n    }\r\n\r\n    getDecorator() {\r\n        return Annotation.toString();\r\n    }\r\n\r\n    protected getMetaConfig(token: Type<any>): AnnotationConfigure<T> {\r\n        let accessor = this.container.resolve(AnnotationMetaAccessorToken, { decorator: this.getDecorator() });\r\n        if (accessor) {\r\n            return accessor.getMetadata(token, this.container);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected isEqual(build: IAnnotationBuilder<T>) {\r\n        if (!build) {\r\n            return false;\r\n        }\r\n        if (build === this) {\r\n            return true;\r\n        }\r\n        if (build.constructor === this.constructor) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected resolveToken(token: Token<T>, data?: any) {\r\n        return this.container.resolve(token);\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"AnnotationBuilder\",\"params\":{\"constructor\":[],\"build\":[\"token\",\"config\",\"data\"],\"buildByConfig\":[\"config\",\"data\"],\"createInstance\":[\"token\",\"config\",\"data\"],\"getBuilder\":[\"token\",\"config\"],\"buildStrategy\":[\"instance\",\"config\"],\"getType\":[\"config\"],\"registerExts\":[\"config\"],\"getTokenMetaConfig\":[\"token\",\"config\"],\"getDecorator\":[],\"getMetaConfig\":[\"token\"],\"isEqual\":[\"build\"],\"resolveToken\":[\"token\",\"data\"]}};\n                   }\r\n","export * from './AnnotationBuilder';\r\nexport * from './AnnotationConfigure';\r\nexport * from './IAnnotation';\r\nexport * from './IAnnotationBuilder';\r\n","import 'reflect-metadata';\r\nimport {\r\n    IContainer, Token, Providers, lang, isFunction, isClass,\r\n    isToken, Singleton, Inject, Registration, Container, AnnotationMetaAccessorToken\r\n} from '@ts-ioc/core';\r\nimport { IModuleBuilder, ModuleBuilderToken, ModuleEnv } from './IModuleBuilder';\r\nimport { ModuleConfigure, ModuleConfig } from './ModuleConfigure';\r\nimport { MdInstance } from './ModuleType';\r\nimport { ContainerPool, ContainerPoolToken } from '../utils';\r\nimport { InjectRunnerToken, IRunner, Boot, DefaultRunnerToken, Service, IService, InjectServiceToken, DefaultServiceToken, Runnable, Runner } from '../runnable';\r\nimport { IAnnotationBuilder, IAnyTypeBuilder, InjectAnnotationBuilder, DefaultAnnotationBuilderToken, AnnotationBuilderToken, AnnotationBuilder } from '../annotations';\r\nimport { InjectedModule, InjectedModuleToken } from './InjectedModule';\r\nimport { DIModuleInjectorToken } from './DIModuleInjector';\r\n\r\n/**\r\n * inject module load token.\r\n *\r\n * @export\r\n * @class InjectModuleLoadToken\r\n * @extends {Registration<T>}\r\n * @template T\r\n */\r\nexport class InjectModuleLoadToken<T> extends Registration<T> {\r\n    constructor(token: Token<T>) {\r\n        super(token, 'module_loader')\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"InjectModuleLoadToken\",\"params\":{\"constructor\":[\"token\"]}};\n                   }\r\n\r\n\r\n/**\r\n * module builder\r\n *\r\n * @export\r\n * @class ModuleBuilder\r\n * @implements {IModuleBuilder}\r\n * @template T\r\n */\r\n@Singleton(ModuleBuilderToken)\r\nexport class ModuleBuilder<T> implements IModuleBuilder<T> {\r\n\r\n    @Inject(ContainerPoolToken)\r\n    protected pools: ContainerPool;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    getPools(): ContainerPool {\r\n        return this.pools;\r\n    }\r\n\r\n    /**\r\n     * build module.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @param {*} [data] bootstrap data, build data, Runnable data.\r\n     * @returns {Promise<T>}\r\n     * @memberof ModuleBuilder\r\n     */\r\n    async build(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv, data?: any): Promise<T> {\r\n        let injmdl = await this.load(token, env);\r\n        let container = injmdl.container;\r\n        let cfg = injmdl.config;\r\n        let annBuilder = this.getAnnoBuilder(container, injmdl.token, cfg.annotationBuilder);\r\n        if (!injmdl.token) {\r\n            let instance = await annBuilder.buildByConfig(cfg, data);\r\n            return instance;\r\n        } else {\r\n            let instance = await annBuilder.build(injmdl.token, cfg, data);\r\n            let mdlInst = instance as MdInstance<T>;\r\n            if (mdlInst && isFunction(mdlInst.mdOnInit)) {\r\n                mdlInst.mdOnInit(injmdl);\r\n            }\r\n            return instance;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * bootstrap module's main.\r\n    *\r\n    * @param {(Token<T> | ModuleConfig<T>)} token\r\n    * @param {ModuleEnv} [env]\r\n    * @param {*} [data] bootstrap data, build data, Runnable data.\r\n    * @returns {Promise<MdInstance<T>>}\r\n    * @memberof ModuleBuilder\r\n    */\r\n    async bootstrap(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv, data?: any): Promise<Runnable<T>> {\r\n        let injmdl = await this.load(token, env);\r\n        let cfg = injmdl.config;\r\n        let container = injmdl.container;\r\n        let md = await this.build(token, injmdl, data) as MdInstance<T>;\r\n        let bootToken = this.getBootType(cfg);\r\n        let anBuilder = this.getAnnoBuilder(container, bootToken, cfg.annotationBuilder);\r\n        let bootInstance = await (bootToken ? anBuilder.build(bootToken, cfg, data) : anBuilder.buildByConfig(cfg, data));\r\n        let runable;\r\n        if (bootInstance) {\r\n            runable = await this.autoRun(container, bootToken ? bootToken : anBuilder.getType(cfg), cfg, bootInstance, data);\r\n            if (md && isFunction(md.mdOnStart)) {\r\n                await Promise.resolve(md.mdOnStart(bootInstance));\r\n            }\r\n        } else {\r\n            runable = await this.autoRun(container, injmdl.token, cfg, md, data);\r\n        }\r\n        return runable;\r\n    }\r\n\r\n    async import(token: Token<T>, parent?: IContainer): Promise<InjectedModule<T>> {\r\n        if (!parent) {\r\n            parent = await this.getParentContainer();\r\n        }\r\n        let type = isClass(token) ? token : parent.getTokenImpl(token);\r\n        if (isClass(type)) {\r\n            let key = new InjectedModuleToken(type);\r\n            if (parent.hasRegister(key.toString())) {\r\n                return parent.get(key)\r\n            } else {\r\n                await parent.loadModule(type);\r\n                if (parent.has(key)) {\r\n                    return parent.get(key);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected async load(token: Token<T> | ModuleConfigure, env?: ModuleEnv): Promise<InjectedModule<T>> {\r\n        if (env instanceof InjectedModule) {\r\n            return env;\r\n        }\r\n        let injmdl: InjectedModule<T> = null;\r\n        let parent = await this.getParentContainer(env);\r\n        if (isToken(token)) {\r\n            injmdl = await this.import(token, parent);\r\n            if (!injmdl) {\r\n                let cfg = parent.get(AnnotationMetaAccessorToken).getMetadata(token, parent);\r\n                injmdl = new InjectedModule(token, cfg, parent);\r\n            }\r\n        } else {\r\n            let mdtype = this.getType(token);\r\n            if (isToken(mdtype)) {\r\n                injmdl = await this.import(mdtype, parent);\r\n                if (injmdl instanceof InjectedModule) {\r\n                    let container = injmdl.container;\r\n                    let injector = container.get(DIModuleInjectorToken);\r\n                    await injector.importByConfig(container, token);\r\n                    injmdl.config = lang.assign(injmdl.config, token);\r\n                }\r\n            } else {\r\n                mdtype = null;\r\n            }\r\n            if (!injmdl) {\r\n                let injector = parent.get(DIModuleInjectorToken);\r\n                await injector.importByConfig(parent, token)\r\n                injmdl = new InjectedModule(mdtype, token, parent);\r\n            }\r\n        }\r\n\r\n        return injmdl;\r\n    }\r\n\r\n\r\n    protected async getParentContainer(env?: ModuleEnv) {\r\n        let parent: IContainer;\r\n        if (env) {\r\n            if (env instanceof Container) {\r\n                parent = env;\r\n            } else if (env instanceof InjectedModule) {\r\n                parent = env.container.parent;\r\n            }\r\n        }\r\n        if (!parent) {\r\n            parent = this.getPools().getDefault();\r\n        }\r\n        return parent;\r\n\r\n    }\r\n\r\n    protected async autoRun(container: IContainer, token: Token<any>, cfg: ModuleConfigure, instance: any, data?: any): Promise<Runnable<T>> {\r\n        if (!instance) {\r\n            return null;\r\n        }\r\n\r\n        if (instance instanceof Runner) {\r\n            await instance.run(data);\r\n            return instance;\r\n        } else if (instance instanceof Service) {\r\n            await instance.start(data);\r\n            return instance;\r\n        } else {\r\n            let runner: IRunner<T>, service: IService<T>;\r\n            let provider = { token: token, instance: instance, config: cfg };\r\n            container.getTokenExtendsChain(token).forEach(tk => {\r\n                if (runner || service) {\r\n                    return false;\r\n                }\r\n                let runnerToken = new InjectRunnerToken<T>(tk);\r\n                if (container.has(runnerToken)) {\r\n                    runner = container.resolve(runnerToken, provider);\r\n                }\r\n                let serviceToken = new InjectServiceToken<T>(tk);\r\n                if (container.has(serviceToken)) {\r\n                    service = container.resolve(serviceToken, provider);\r\n                }\r\n                return true;\r\n            });\r\n            if (!runner) {\r\n                this.getDefaultRunner(container, provider)\r\n            }\r\n            if (!runner && !service) {\r\n                this.getDefaultService(container, provider)\r\n            }\r\n            if (runner) {\r\n                await runner.run(data);\r\n                return runner;\r\n            } else if (service) {\r\n                await service.start(data);\r\n                return service;\r\n            } else if (token && cfg.autorun) {\r\n                await container.invoke(token, cfg.autorun, instance, { data: data });\r\n                return instance;\r\n            } else {\r\n                return instance;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected getDefaultRunner(container: IContainer, ...providers: Providers[]): IRunner<T> {\r\n        if (container.has(DefaultRunnerToken)) {\r\n            return container.resolve(DefaultRunnerToken, ...providers)\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected getDefaultService(container: IContainer, ...providers: Providers[]): IService<T> {\r\n        if (container.has(DefaultServiceToken)) {\r\n            return container.resolve(DefaultServiceToken, ...providers)\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected getAnnoBuilder(container: IContainer, token: Token<any>, annBuilder: Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>): IAnyTypeBuilder {\r\n        let builder: IAnnotationBuilder<any>;\r\n        if (isClass(annBuilder)) {\r\n            if (!container.has(annBuilder)) {\r\n                container.register(annBuilder);\r\n            }\r\n        }\r\n\r\n        if (isToken(annBuilder)) {\r\n            builder = container.resolve(annBuilder);\r\n        } else if (annBuilder instanceof AnnotationBuilder) {\r\n            builder = annBuilder;\r\n        }\r\n        if (!builder && token) {\r\n            container.getTokenExtendsChain(token).forEach(tk => {\r\n                if (builder) {\r\n                    return false;\r\n                }\r\n                let buildToken = new InjectAnnotationBuilder<T>(tk);\r\n                if (container.has(buildToken)) {\r\n                    builder = container.resolve(buildToken);\r\n                }\r\n                return true;\r\n            });\r\n        }\r\n        if (!builder) {\r\n            builder = this.getDefaultAnnBuilder(container);\r\n        }\r\n\r\n        if (builder) {\r\n            builder.container = container\r\n        }\r\n        return builder;\r\n    }\r\n\r\n\r\n    protected getDefaultAnnBuilder(container: IContainer): IAnnotationBuilder<any> {\r\n        if (container.has(DefaultAnnotationBuilderToken)) {\r\n            return container.resolve(DefaultAnnotationBuilderToken);\r\n        }\r\n        return container.resolve(AnnotationBuilderToken);\r\n    }\r\n\r\n    /**\r\n     * get module type\r\n     *\r\n     * @protected\r\n     * @param {ModuleConfigure} cfg\r\n     * @returns {Token<T>}\r\n     * @memberof ModuleBuilder\r\n     */\r\n    protected getType(cfg: ModuleConfigure): Token<T> {\r\n        return cfg.token || cfg.type;\r\n    }\r\n\r\n    /**\r\n     * get boot type.\r\n     *\r\n     * @protected\r\n     * @param {ModuleConfigure} cfg\r\n     * @returns {Token<T>}\r\n     * @memberof ModuleBuilder\r\n     */\r\n    protected getBootType(cfg: ModuleConfigure): Token<T> {\r\n        return cfg.bootstrap;\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"ModuleBuilder\",\"params\":{\"constructor\":[],\"getPools\":[],\"build\":[\"token\",\"env\",\"data\"],\"bootstrap\":[\"token\",\"env\",\"data\"],\"import\":[\"token\",\"parent\"],\"load\":[\"token\",\"env\"],\"getParentContainer\":[\"env\"],\"autoRun\":[\"container\",\"token\",\"cfg\",\"instance\",\"data\"],\"getDefaultRunner\":[\"container\",\"providers\"],\"getDefaultService\":[\"container\",\"providers\"],\"getAnnoBuilder\":[\"container\",\"token\",\"annBuilder\"],\"getDefaultAnnBuilder\":[\"container\"],\"getType\":[\"cfg\"],\"getBootType\":[\"cfg\"]}};\n                   }\r\n","export * from './DIModuleInjector';\r\nexport * from './DIModuleValidate';\r\nexport * from './InjectedModule';\r\nexport * from './IModuleBuilder';\r\nexport * from './ModuleBuilder';\r\nexport * from './ModuleConfigure';\r\nexport * from './ModuleType';\r\n","import { IContainer, Inject, ContainerToken, LifeScopeToken, IocExt, CoreActions } from '@ts-ioc/core';\r\nimport { DIModule, Bootstrap } from './decorators';\r\nimport * as modus from './modules';\r\nimport * as boot from './boot';\r\nimport * as annotations from './annotations';\r\n\r\n\r\n/**\r\n * Bootstrap ext for ioc. auto run setup after registered.\r\n * with @IocExt('setup') decorator.\r\n * @export\r\n * @class BootModule\r\n */\r\n@IocExt('setup')\r\nexport class BootModule {\r\n\r\n    constructor(@Inject(ContainerToken) private container: IContainer) {\r\n\r\n    }\r\n\r\n    /**\r\n     * register aop for container.\r\n     *\r\n     * @memberof AopModule\r\n     */\r\n    setup() {\r\n        let container = this.container;\r\n\r\n        let lifeScope = container.get(LifeScopeToken);\r\n\r\n        lifeScope.registerDecorator(DIModule, CoreActions.bindProvider, CoreActions.cache, CoreActions.componentBeforeInit, CoreActions.componentInit, CoreActions.componentAfterInit);\r\n        lifeScope.registerDecorator(Bootstrap, CoreActions.bindProvider, CoreActions.cache, CoreActions.componentBeforeInit, CoreActions.componentInit, CoreActions.componentAfterInit);\r\n\r\n        container.use(annotations, modus, boot);\r\n    }\r\n\n                        static classAnnations:any  = {\"name\":\"BootModule\",\"params\":{\"constructor\":[\"container\"],\"setup\":[]}};\n                   }\r\n","import { AppConfigure, AppConfigureToken, DefaultConfigureToken, AppConfigureLoaderToken } from './AppConfigure';\r\nimport { IContainer, LoadType, lang, isString, MapSet, Factory, Token, isUndefined, DefaultContainerBuilder, IContainerBuilder, isClass, isToken } from '@ts-ioc/core';\r\nimport { IApplicationBuilder, CustomRegister, AnyApplicationBuilder } from './IApplicationBuilder';\r\nimport { ModuleBuilder, ModuleEnv, DIModuleInjectorToken, InjectedModule, IModuleBuilder, InjectModuleBuilderToken, DefaultModuleBuilderToken, ModuleBuilderToken, ModuleConfig } from '../modules';\r\nimport { ContainerPool, ContainerPoolToken, Events, IEvents } from '../utils';\r\nimport { BootModule } from '../BootModule';\r\nimport { Runnable } from '../runnable';\r\n\r\nexport enum ApplicationEvents {\r\n    onRootContainerCreated = 'onRootContainerCreated',\r\n    onRootContainerInited = 'onRooConatianerInited'\r\n}\r\n\r\n/**\r\n * application builder.\r\n *\r\n * @export\r\n * @class Default ApplicationBuilder\r\n * @extends {ModuleBuilder}\r\n * @template T\r\n */\r\nexport class DefaultApplicationBuilder<T> extends ModuleBuilder<T> implements IApplicationBuilder<T>, IEvents {\r\n\r\n    private globalConfig: AppConfigure;\r\n    protected globalModules: LoadType[];\r\n    protected customRegs: CustomRegister<T>[];\r\n    protected beforeInitPds: MapSet<Token<any>, any>;\r\n    protected afterInitPds: MapSet<Token<any>, any>;\r\n    protected configs: (string | AppConfigure)[];\r\n    inited = false;\r\n\r\n    events: Events;\r\n\r\n    constructor(public baseURL?: string) {\r\n        super();\r\n        this.customRegs = [];\r\n        this.globalModules = [];\r\n        this.configs = [];\r\n        this.beforeInitPds = new MapSet();\r\n        this.afterInitPds = new MapSet();\r\n        this.events = new Events();\r\n        this.initEvents();\r\n    }\r\n\r\n    protected initEvents() {\r\n        this.events.on('onRooConatianerInited', (container) => {\r\n            this.afterInitPds.forEach((val, key) => {\r\n                container.bindProvider(key, val);\r\n            });\r\n        })\r\n    }\r\n\r\n    static create(baseURL?: string): AnyApplicationBuilder {\r\n        return new DefaultApplicationBuilder<any>(baseURL);\r\n    }\r\n\r\n    on(name: string, event: (...args: any[]) => void): this {\r\n        this.events.on(name, event);\r\n        return this;\r\n    }\r\n    off(name: string, event?: (...args: any[]) => void): this {\r\n        this.events.off(name, event);\r\n        return this;\r\n    }\r\n    emit(name: string, ...args: any[]): void {\r\n        this.events.emit(name, ...args);\r\n    }\r\n\r\n    getPools(): ContainerPool {\r\n        if (!this.pools) {\r\n            this.pools = new ContainerPool(this.createContainerBuilder());\r\n            this.createDefaultContainer();\r\n        }\r\n        return this.pools;\r\n    }\r\n\r\n    protected createContainerBuilder(): IContainerBuilder {\r\n        return new DefaultContainerBuilder();\r\n    }\r\n\r\n    /**\r\n     * use configuration.\r\n     *\r\n     * @param {(string | AppConfigure)} [config]\r\n     * @returns {this} global config for this application.\r\n     * @memberof Bootstrap\r\n     */\r\n    useConfiguration(config?: string | AppConfigure): this {\r\n        if (isUndefined(config)) {\r\n            config = '';\r\n        }\r\n        // clean cached config.\r\n        this.globalConfig = null;\r\n        let idx = this.configs.indexOf(config);\r\n        if (idx >= 0) {\r\n            this.configs.splice(idx, 1);\r\n        }\r\n        this.configs.push(config);\r\n\r\n        return this;\r\n    }\r\n\r\n    protected loadConfig(container: IContainer, src: string): Promise<AppConfigure> {\r\n        if (container.has(AppConfigureLoaderToken)) {\r\n            let loader = container.resolve(AppConfigureLoaderToken, { baseURL: this.baseURL, container: container });\r\n            return loader.load(src);\r\n        } else if (src) {\r\n            let builder = container.getBuilder();\r\n            return builder.loader.load([src])\r\n                .then(rs => {\r\n                    return rs.length ? rs[0] as AppConfigure : null;\r\n                })\r\n        } else {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * use module as global Depdences module.\r\n     *\r\n     * @param {...LoadType[]} modules\r\n     * @returns {this}\r\n     * @memberof PlatformServer\r\n     */\r\n    use(...modules: LoadType[]): this {\r\n        this.globalModules = this.globalModules.concat(modules);\r\n        this.inited = false;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * bind provider\r\n     *\r\n     * @template T\r\n     * @param {Token<T>} provide\r\n     * @param {Token<T> | Factory<T>} provider\r\n     * @param {boolean} [beforRootInit]\r\n     * @returns {this}\r\n     * @memberof IContainer\r\n     */\r\n    provider(provide: Token<any>, provider: Token<any> | Factory<any>, beforRootInit?: boolean): this {\r\n        if (beforRootInit) {\r\n            this.beforeInitPds.set(provide, provider);\r\n        } else {\r\n            this.afterInitPds.set(provide, provider);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    protected async load(token: Token<T> | AppConfigure, env?: ModuleEnv): Promise<InjectedModule<T>> {\r\n        await this.initRootContainer();\r\n        return super.load(token, env);\r\n    }\r\n\r\n    async build(token: Token<T> | AppConfigure, env?: ModuleEnv, data?: any): Promise<T> {\r\n        let injmdl = await this.load(token, env);\r\n        let builder = this.getBuilder(injmdl);\r\n        return await builder.build(token, injmdl, data);\r\n    }\r\n\r\n    async bootstrap(token: Token<T> | AppConfigure, env?: ModuleEnv, data?: any): Promise<Runnable<T>> {\r\n        let injmdl = await this.load(token, env);\r\n        let builder = this.getBuilder(injmdl);\r\n        return await builder.bootstrap(token, injmdl, data);\r\n    }\r\n\r\n    /**\r\n     * get module builder\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @returns {IModuleBuilder<T>}\r\n     * @memberof IApplicationBuilder\r\n     */\r\n    async getBuilderByConfig(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv): Promise<IModuleBuilder<T>> {\r\n        let injmdl = await this.load(token, env);\r\n        return this.getBuilder(injmdl)\r\n    }\r\n\r\n    getBuilder(injmdl: InjectedModule<T>): IModuleBuilder<T> {\r\n        let cfg = injmdl.config;\r\n        let container = injmdl.container;\r\n        let builder: IModuleBuilder<T>;\r\n        if (cfg) {\r\n            if (isClass(cfg.builder)) {\r\n                if (!container.has(cfg.builder)) {\r\n                    container.register(cfg.builder);\r\n                }\r\n            }\r\n            if (isToken(cfg.builder)) {\r\n                builder = container.resolve(cfg.builder);\r\n            } else if (cfg.builder instanceof ModuleBuilder) {\r\n                builder = cfg.builder;\r\n            }\r\n        }\r\n\r\n        let tko = injmdl.token;\r\n        if (!builder && tko) {\r\n            container.getTokenExtendsChain(tko).forEach(tk => {\r\n                if (builder) {\r\n                    return false;\r\n                }\r\n                let buildToken = new InjectModuleBuilderToken<T>(tk);\r\n                if (container.has(buildToken)) {\r\n                    builder = container.get(buildToken);\r\n                }\r\n                return true;\r\n            });\r\n        }\r\n        if (!builder) {\r\n            builder = this.getDefaultBuilder(container);\r\n        }\r\n\r\n        return builder || this;\r\n    }\r\n\r\n    protected getDefaultBuilder(container: IContainer): IModuleBuilder<any> {\r\n        if (container.has(DefaultModuleBuilderToken)) {\r\n            return container.resolve(DefaultModuleBuilderToken);\r\n        }\r\n        return container.resolve(ModuleBuilderToken);\r\n    }\r\n\r\n\r\n    protected async getGlobalConfig(container: IContainer): Promise<AppConfigure> {\r\n        if (!this.globalConfig) {\r\n            let globCfg = await this.getDefaultConfig(container);\r\n            if (this.configs.length < 1) {\r\n                this.configs.push(''); // load default loader config.\r\n            }\r\n            let exts = await Promise.all(this.configs.map(cfg => {\r\n                if (isString(cfg)) {\r\n                    return this.loadConfig(container, cfg);\r\n                } else {\r\n                    return cfg;\r\n                }\r\n            }));\r\n            exts.forEach(exCfg => {\r\n                if (exCfg) {\r\n                    lang.assign(globCfg, exCfg);\r\n                }\r\n            });\r\n            this.globalConfig = globCfg;\r\n        }\r\n        return this.globalConfig;\r\n    }\r\n\r\n    protected createDefaultContainer() {\r\n        let container = this.pools.getDefault();\r\n        container.register(BootModule);\r\n\r\n        let chain = container.getBuilder().getInjectorChain(container);\r\n        chain.first(container.resolve(DIModuleInjectorToken));\r\n        container.bindProvider(ContainerPoolToken, () => this.getPools());\r\n\r\n        this.beforeInitPds.forEach((val, key) => {\r\n            container.bindProvider(key, val);\r\n        });\r\n\r\n        this.events.emit(ApplicationEvents.onRootContainerCreated, container);\r\n        return container;\r\n    }\r\n\r\n    protected async initRootContainer(container?: IContainer) {\r\n        if (this.inited) {\r\n            return;\r\n        }\r\n        container = container || this.getPools().getDefault();\r\n        let globCfg = await this.getGlobalConfig(container);\r\n        await this.registerExts(container, globCfg);\r\n        this.bindAppConfig(globCfg);\r\n        container.bindProvider(AppConfigureToken, globCfg);\r\n        this.inited = true;\r\n        this.events.emit(ApplicationEvents.onRootContainerInited, container);\r\n    }\r\n\r\n    /**\r\n     * register ioc exts\r\n     *\r\n     * @protected\r\n     * @param {IContainer} container\r\n     * @param {AppConfigure} config\r\n     * @returns {Promise<IContainer>}\r\n     * @memberof ApplicationBuilder\r\n     */\r\n    protected async registerExts(container: IContainer, config: AppConfigure): Promise<IContainer> {\r\n\r\n        if (this.globalModules.length) {\r\n            let usedModules = this.globalModules;\r\n            await container.loadModule(...usedModules);\r\n        }\r\n\r\n        if (this.customRegs.length) {\r\n            await Promise.all(this.customRegs.map(async cs => {\r\n                let tokens = await cs(container, config, this);\r\n                return tokens;\r\n            }));\r\n        }\r\n\r\n        return container;\r\n    }\r\n\r\n    protected bindAppConfig(config: AppConfigure): AppConfigure {\r\n        if (this.baseURL) {\r\n            config.baseURL = this.baseURL;\r\n        }\r\n        return config;\r\n    }\r\n\r\n    protected async getDefaultConfig(container: IContainer): Promise<AppConfigure> {\r\n        if (container.has(DefaultConfigureToken)) {\r\n            return container.resolve(DefaultConfigureToken);\r\n        } else {\r\n            return {} as AppConfigure;\r\n        }\r\n    }\r\n\r\n\n                        static classAnnations:any  = {\"name\":\"DefaultApplicationBuilder\",\"params\":{\"constructor\":[\"baseURL\"],\"initEvents\":[],\"create\":[\"baseURL\"],\"on\":[\"name\",\"event\"],\"off\":[\"name\",\"event\"],\"emit\":[\"name\",\"args\"],\"getPools\":[],\"createContainerBuilder\":[],\"useConfiguration\":[\"config\"],\"loadConfig\":[\"container\",\"src\"],\"use\":[\"modules\"],\"provider\":[\"provide\",\"provider\",\"beforRootInit\"],\"load\":[\"token\",\"env\"],\"build\":[\"token\",\"env\",\"data\"],\"bootstrap\":[\"token\",\"env\",\"data\"],\"getBuilderByConfig\":[\"token\",\"env\"],\"getBuilder\":[\"injmdl\"],\"getDefaultBuilder\":[\"container\"],\"getGlobalConfig\":[\"container\"],\"createDefaultContainer\":[],\"initRootContainer\":[\"container\"],\"registerExts\":[\"container\",\"config\"],\"bindAppConfig\":[\"config\"],\"getDefaultConfig\":[\"container\"]}};\n                   }\r\n","import { Token, InjectToken, IContainer, LoadType, Factory } from '@ts-ioc/core';\r\nimport { AppConfigure } from './AppConfigure';\r\nimport { IModuleBuilder, MdInstance, ModuleEnv, ModuleConfig, InjectedModule } from '../modules';\r\nimport { Events, IEvents } from '../utils';\r\n\r\n/**\r\n * custom define module.\r\n */\r\nexport type CustomRegister<T> = (container: IContainer, config?: AppConfigure, builder?: IApplicationBuilder<T>) => Token<T>[] | Promise<Token<T>[]>;\r\n\r\n\r\n/**\r\n * use module extends application.\r\n *\r\n * @export\r\n * @interface IApplicationExtends\r\n */\r\nexport interface IApplicationExtends {\r\n    /**\r\n     * use custom configuration.\r\n     *\r\n     * @param {(string | AppConfigure)} [config]\r\n     * @returns {this}\r\n     * @memberof IApplicationBuilder\r\n     */\r\n    useConfiguration(config?: string | AppConfigure): this;\r\n\r\n    /**\r\n     * use module\r\n     *\r\n     * @param {...LoadType[]} modules\r\n     * @returns {this}\r\n     * @memberof IApplicationBuilder\r\n     */\r\n    use(...modules: LoadType[]): this;\r\n\r\n    /**\r\n     * bind provider\r\n     *\r\n     * @param {Token<any>} provide\r\n     * @param {(Token<any> | Factory<any>)} provider\r\n     * @param {boolean} [beforRootInit]\r\n     * @returns {this}\r\n     * @memberof IApplicationExtends\r\n     */\r\n    provider(provide: Token<any>, provider: Token<any> | Factory<any>, beforRootInit?: boolean): this;\r\n\r\n}\r\n\r\n\r\n/**\r\n * application builder.\r\n *\r\n * @export\r\n * @interface IApplicationBuilder\r\n * @extends {IModuleBuilder<T>}\r\n * @template T\r\n */\r\nexport interface IApplicationBuilder<T> extends IModuleBuilder<T>, IApplicationExtends, IEvents {\r\n    /**\r\n     * events mgr.\r\n     *\r\n     * @type {Events}\r\n     * @memberof IApplicationBuilder\r\n     */\r\n    events?: Events;\r\n\r\n    /**\r\n     * get builder by token, config and env.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [env]\r\n     * @returns {Promise<IModuleBuilder<T>>}\r\n     * @memberof IApplicationBuilder\r\n     */\r\n    getBuilderByConfig(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv): Promise<IModuleBuilder<T>>;\r\n\r\n    /**\r\n     * get module builder\r\n     *\r\n     * @param {InjectedModule<T>} injmdl\r\n     * @returns {IModuleBuilder<T>}\r\n     * @memberof IModuleBuilder\r\n     */\r\n    getBuilder(injmdl: InjectedModule<T>): IModuleBuilder<T>;\r\n\r\n}\r\n\r\n\r\n\r\nexport const ApplicationBuilderToken = new InjectToken<AnyApplicationBuilder>('DI_AppBuilder');\r\n\r\n/**\r\n * application builder. objected generics to any\r\n *\r\n * @export\r\n * @interface AnyApplicationBuilder\r\n * @extends {IApplicationBuilder<any>}\r\n * @template T\r\n */\r\nexport interface AnyApplicationBuilder extends IApplicationBuilder<any> {\r\n    /**\r\n     * build module as ioc container.\r\n     *\r\n     * @param {(Token<T> | ModuleConfig<T>)} token\r\n     * @param {ModuleEnv} [defaultContainer]\r\n     * @returns {Promise<MdInstance<T>>}\r\n     * @memberof IModuleBuilder\r\n     */\r\n    build<T>(token: Token<T> | ModuleConfig<T>, env?: ModuleEnv): Promise<MdInstance<T>>;\r\n\r\n}\r\n","export * from './AppConfigure';\r\nexport * from './IApplication';\r\nexport * from './ApplicationBuilder';\r\nexport * from './IApplicationBuilder';\r\n","export * from './decorators';\r\nexport * from './boot';\r\nexport * from './annotations';\r\nexport * from './modules';\r\nexport * from './runnable';\r\nexport * from './utils';\r\nexport * from './BootModule';\r\n\r\n"],"names":["DIModule_1","decorators_1","utils_1","DIModuleValidate_1","IAnnotationBuilder_1","runnable_1","annotations_1","IModuleBuilder_1","modus","AppConfigure_1","modules","modules_1"],"mappings":"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"}