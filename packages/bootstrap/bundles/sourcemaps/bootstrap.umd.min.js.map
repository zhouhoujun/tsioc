{"version":3,"sources":["bootstrap.umd.min.js"],"names":["global","factory","exports","module","require","define","amd","bootstrap","umd","js","tslib_1","core_1","Reflect","this","reflectMetadata","unwrapExports","x","__esModule","Object","prototype","hasOwnProperty","call","createCommonjsModule","fn","Annotation","createAnnotationDecorator","name","builder","adapter","metadataExtends","createClassDecorator","args","metadata","annotationBuilder","defineProperty","value","DIModule","createDIModuleDecorator","isClass","token","test","classAnnations","decorType","Bootstrap","createBootstrapDecorator","setTimeout","builderType","isFunction","isObject","globals","use","apply","type","decorators","__exportStar","AppConfigure","AppConfigureToken","InjectToken","DefaultConfigureToken","AppConfigureLoaderToken","DIModuleValidate","DIModuelValidateToken","InjectModuleValidateToken","toString","DIModuelValidate","_super","arguments","__extends","getDecorator","params","__decorate","Singleton","BaseModuelValidate","ContainerPool_1","ContainerPool","containerBuilder","pools","MapSet","createContainer","create","getTokenKey","Registration","isDefault","container","_default","hasDefault","getDefault","set","has","console","log","get","key","parent","getBuilder","setParent","constructor","ContainerPoolToken","Events_1","Events","eventsMap","on","event","indexOf","push","off","splice","emit","_i","length","events","isArray","forEach","ev","utils","InjectedModule_1","InjectedModule","config","providers","InjectedModuleToken","DIModuleInjector_1","exportsProvidersFiled","DIModuleInjectorToken","InjectModuleInjectorToken","DIModuleInjector","validate","setup","__awaiter","__generator","_a","label","importModule","sent","import","importByConfig","registerConfgureDepds","bindProvider","newContainer","metaConfig","injMd","register","getMetaConfig","importConfigExports","imports","loadModule","providerContainer","resolvers","next","toArray","filter","r","Container","tokens","p","index","isUndefined","isNull","isProviderMap","k","f","Provider","resolve","concat","isBaseObject","pr_1","isobjMap","isToken","provide","deps","d","useValue","useClass","useFactory","map","useExisting","lang","forIn","val","isString","Injectable","__param","Inject","__metadata","ModuleInjector","IModuleBuilder","moduleBuilderDesc","InjectModuleBuilderToken","DefaultModuleBuilderToken","ModuleBuilderToken","IRunner","Runner","instance","run","Boot","_this","InjectRunnerToken","DefaultRunnerToken","Service_1","Service","start","stop","InjectServiceToken","DefaultServiceToken","runnable","IAnnotationBuilder","annoBuilderDesc","InjectAnnotationBuilder","AnnotationBuilderToken","DefaultAnnotationBuilderToken","AnnotationBuilder_1","AnnotationBuilder","build","data","hasRegister","getTokenMetaConfig","isEqual","registerExts","createInstance","anBeforeInit","Promise","buildStrategy","anAfterInit","buildByConfig","getType","resolveToken","provider","ContainerToken","getRefService","cfg","tokenType","getTokenImpl","assign","accessor","AnnotationMetaAccessorToken","decorator","getMetadata","annotations","ModuleBuilder_1","InjectModuleLoadToken","ModuleBuilder","getPools","env","injmdl","annBuilder","mdlInst","load","getAnnoBuilder","mdOnInit","md","bootToken","anBuilder","bootInstance","runable","getBootType","autoRun","mdOnStart","getParentContainer","mdtype","runner","service","getDefaultRunner","getDefaultService","autorun","invoke","getDefaultAnnBuilder","modules","BootModule_1","BootModule","lifeScope","LifeScopeToken","registerDecorator","CoreActions","cache","componentBeforeInit","componentInit","componentAfterInit","boot","IocExt","ApplicationBuilder","ApplicationEvents","DefaultApplicationBuilder","baseURL","inited","customRegs","globalModules","configs","beforeInitPds","afterInitPds","initEvents","createContainerBuilder","createDefaultContainer","DefaultContainerBuilder","useConfiguration","globalConfig","idx","loadConfig","src","loader","then","rs","modules$$1","beforRootInit","initRootContainer","getBuilderByConfig","tko","getDefaultBuilder","getGlobalConfig","globCfg_1","getDefaultConfig","all","exCfg","getInjectorChain","first","onRootContainerCreated","globCfg","bindAppConfig","onRootContainerInited","usedModules","cs","IApplicationBuilder","ApplicationBuilderToken"],"mappings":"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","file":"../bootstrap.umd.min.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('tslib'), require('@ts-ioc/core'), require('reflect-metadata')) :\n\ttypeof define === 'function' && define.amd ? define(['tslib', '@ts-ioc/core', 'reflect-metadata'], factory) :\n\t(global.bootstrap = global.bootstrap || {}, global.bootstrap.umd = global.bootstrap.umd || {}, global.bootstrap.umd.js = factory(global.tslib_1,global.core_1,global.Reflect));\n}(this, (function (tslib_1,core_1,reflectMetadata) { 'use strict';\n\ntslib_1 = tslib_1 && tslib_1.hasOwnProperty('default') ? tslib_1['default'] : tslib_1;\ncore_1 = core_1 && core_1.hasOwnProperty('default') ? core_1['default'] : core_1;\nreflectMetadata = reflectMetadata && reflectMetadata.hasOwnProperty('default') ? reflectMetadata['default'] : reflectMetadata;\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar Annotation = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n/**\n * create type builder decorator\n *\n * @export\n * @template T\n * @param {string} name\n * @param {string} [decorType]\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>)} [builder]\n * @param {MetadataAdapter} [adapter]\n * @param {MetadataExtends<T>} [metadataExtends]\n * @returns {IAnnotationDecorator<T>}\n */\nfunction createAnnotationDecorator(name, builder, adapter, metadataExtends) {\n    return core_1.createClassDecorator(name, function (args) {\n        if (adapter) {\n            adapter(args);\n        }\n    }, function (metadata) {\n        if (metadataExtends) {\n            metadata = metadataExtends(metadata);\n        }\n        if (builder && !metadata.annotationBuilder) {\n            metadata.annotationBuilder = builder;\n        }\n        return metadata;\n    });\n}\nexports.createAnnotationDecorator = createAnnotationDecorator;\n/**\n * Annotation decorator, use to define class build way via config.\n *\n * @Annotation\n */\nexports.Annotation = createAnnotationDecorator('Annotation');\n\n\n\n\n});\n\nunwrapExports(Annotation);\nvar Annotation_1 = Annotation.createAnnotationDecorator;\nvar Annotation_2 = Annotation.Annotation;\n\nvar DIModule = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n/**\n * create bootstrap decorator.\n *\n * @export\n * @template T\n * @param {string} name decorator name.\n * @param {(Token<IModuleBuilder> | IModuleBuilder)} [builder]\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<any>)} [annotationBuilder]\n * @param {MetadataAdapter} [adapter]\n * @param {MetadataExtends<T>} [metadataExtends]\n * @returns {IDIModuleDecorator<T>}\n */\nfunction createDIModuleDecorator(name, builder, annotationBuilder, adapter, metadataExtends) {\n    return core_1.createClassDecorator(name, function (args) {\n        if (adapter) {\n            adapter(args);\n        }\n    }, function (metadata) {\n        if (metadataExtends) {\n            metadata = metadataExtends(metadata);\n        }\n        if (!metadata.name && core_1.isClass(metadata.token)) {\n            var isuglify = /^[a-z]$/.test(metadata.token.name);\n            if (isuglify && metadata.token.classAnnations) {\n                metadata.name = metadata.token.classAnnations.name;\n            }\n            else {\n                metadata.name = metadata.token.name;\n            }\n        }\n        metadata.decorType = name;\n        if (builder && !metadata.builder) {\n            metadata.builder = builder;\n        }\n        if (annotationBuilder && !metadata.annotationBuilder) {\n            metadata.annotationBuilder = annotationBuilder;\n        }\n        return metadata;\n    });\n}\nexports.createDIModuleDecorator = createDIModuleDecorator;\n/**\n * DIModule Decorator, definde class as DI module.\n *\n * @DIModule\n */\nexports.DIModule = createDIModuleDecorator('DIModule');\n\n\n\n\n});\n\nunwrapExports(DIModule);\nvar DIModule_1 = DIModule.createDIModuleDecorator;\nvar DIModule_2 = DIModule.DIModule;\n\nvar Bootstrap = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n/**\n * create bootstrap decorator.\n *\n * @export\n * @template T\n * @param {string} name\n * @param {(Token<IApplicationBuilder> | IApplicationBuilder)} [builder] default builder\n * @param {(Token<IAnnotationBuilder<any>> | IAnnotationBuilder<Tany>)} [annotationBuilder] default type builder.\n * @param {MetadataAdapter} [adapter]\n * @param {MetadataExtends<T>} [metadataExtends]\n * @returns {IBootstrapDecorator<T>}\n */\nfunction createBootstrapDecorator(name, builder, annotationBuilder, adapter, metadataExtends) {\n    return DIModule.createDIModuleDecorator(name, builder, annotationBuilder, adapter, function (metadata) {\n        if (metadataExtends) {\n            metadataExtends(metadata);\n        }\n        if (metadata.builder) {\n            setTimeout(function () {\n                var builderType = metadata.builder;\n                var builder;\n                if (core_1.isClass(builderType)) {\n                    builder = core_1.isFunction(builderType['create']) ? builderType['create']() : new builderType();\n                }\n                else if (core_1.isObject(builderType)) {\n                    builder = builderType;\n                }\n                if (builder) {\n                    if (metadata.globals) {\n                        builder.use.apply(builder, metadata.globals);\n                    }\n                    builder.bootstrap(metadata.type);\n                }\n            }, 500);\n        }\n        return metadata;\n    });\n}\nexports.createBootstrapDecorator = createBootstrapDecorator;\n/**\n * Bootstrap Decorator, definde class as mvc bootstrap module.\n *\n * @Bootstrap\n */\nexports.Bootstrap = createBootstrapDecorator('Bootstrap');\n\n\n\n\n});\n\nunwrapExports(Bootstrap);\nvar Bootstrap_1 = Bootstrap.createBootstrapDecorator;\nvar Bootstrap_2 = Bootstrap.Bootstrap;\n\nvar decorators = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(Annotation, exports);\ntslib_1.__exportStar(DIModule, exports);\ntslib_1.__exportStar(Bootstrap, exports);\n\n\n\n\n});\n\nunwrapExports(decorators);\n\nvar AppConfigure = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n/**\n * application configuration token.\n */\nexports.AppConfigureToken = new core_1.InjectToken('DI_APP_Configuration');\n/**\n * application default configuration token.\n */\nexports.DefaultConfigureToken = new core_1.InjectToken('DI_Default_Configuration');\n/**\n *  app configure loader token.\n */\nexports.AppConfigureLoaderToken = new core_1.InjectToken('DI_Configure_Loader');\n\n\n\n\n});\n\nunwrapExports(AppConfigure);\nvar AppConfigure_1 = AppConfigure.AppConfigureToken;\nvar AppConfigure_2 = AppConfigure.DefaultConfigureToken;\nvar AppConfigure_3 = AppConfigure.AppConfigureLoaderToken;\n\nvar DIModuleValidate = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n/**\n * DIModuel Validate Token\n */\nexports.DIModuelValidateToken = new core_1.InjectModuleValidateToken(decorators.DIModule.toString());\n/**\n * DIModuel Validate\n *\n * @export\n * @class DIModuelValidate\n * @extends {BaseModuelValidate}\n */\nvar DIModuelValidate = /** @class */ (function (_super) {\n    tslib_1.__extends(DIModuelValidate, _super);\n    function DIModuelValidate() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DIModuelValidate.prototype.getDecorator = function () {\n        return decorators.DIModule.toString();\n    };\n    DIModuelValidate.classAnnations = { \"name\": \"DIModuelValidate\", \"params\": { \"getDecorator\": [] } };\n    DIModuelValidate = tslib_1.__decorate([\n        core_1.Singleton(exports.DIModuelValidateToken)\n    ], DIModuelValidate);\n    return DIModuelValidate;\n}(core_1.BaseModuelValidate));\nexports.DIModuelValidate = DIModuelValidate;\n\n\n\n\n});\n\nunwrapExports(DIModuleValidate);\nvar DIModuleValidate_1 = DIModuleValidate.DIModuelValidateToken;\nvar DIModuleValidate_2 = DIModuleValidate.DIModuelValidate;\n\nvar ContainerPool_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n/**\n * container pool\n *\n * @export\n * @class ContainerPool\n */\nvar ContainerPool = /** @class */ (function () {\n    function ContainerPool(containerBuilder) {\n        this.containerBuilder = containerBuilder;\n        this.pools = new core_1.MapSet();\n    }\n    ContainerPool.prototype.createContainer = function () {\n        return this.containerBuilder.create();\n    };\n    ContainerPool.prototype.getTokenKey = function (token) {\n        if (token instanceof core_1.Registration) {\n            return token.toString();\n        }\n        return token;\n    };\n    ContainerPool.prototype.isDefault = function (container) {\n        return container === this._default;\n    };\n    ContainerPool.prototype.hasDefault = function () {\n        return !!this._default;\n    };\n    ContainerPool.prototype.getDefault = function () {\n        if (!this._default) {\n            this._default = this.createContainer();\n        }\n        return this._default;\n    };\n    ContainerPool.prototype.set = function (token, container) {\n        var key = this.getTokenKey(token);\n        if (this.pools.has(token)) {\n            console.log(token.toString() + \" module has loaded\");\n        }\n        this.pools.set(token, container);\n    };\n    ContainerPool.prototype.get = function (token) {\n        var key = this.getTokenKey(token);\n        if (!this.has(key)) {\n            return null;\n        }\n        return this.pools.get(token);\n    };\n    ContainerPool.prototype.has = function (token) {\n        return this.pools.has(this.getTokenKey(token));\n    };\n    ContainerPool.prototype.create = function (parent) {\n        parent = parent || this.getDefault();\n        var container = parent.getBuilder().create();\n        this.setParent(container, parent);\n        return container;\n    };\n    ContainerPool.prototype.setParent = function (container, parent) {\n        if (this.isDefault(container)) {\n            return;\n        }\n        // if (!container.parent) {\n        if (parent && parent !== container) {\n            container.parent = parent;\n        }\n        else {\n            container.parent = this.getDefault();\n        }\n        // }\n    };\n    ContainerPool.classAnnations = { \"name\": \"ContainerPool\", \"params\": { \"constructor\": [\"containerBuilder\"], \"createContainer\": [], \"getTokenKey\": [\"token\"], \"isDefault\": [\"container\"], \"hasDefault\": [], \"getDefault\": [], \"set\": [\"token\", \"container\"], \"get\": [\"token\"], \"has\": [\"token\"], \"create\": [\"parent\"], \"setParent\": [\"container\", \"parent\"] } };\n    return ContainerPool;\n}());\nexports.ContainerPool = ContainerPool;\nexports.ContainerPoolToken = new core_1.InjectToken('ContainerPool');\n// /**\n//  *  global container pools.\n//  */\n// export const containerPools = new ContainerPool();\n\n\n\n\n});\n\nunwrapExports(ContainerPool_1);\nvar ContainerPool_2 = ContainerPool_1.ContainerPool;\nvar ContainerPool_3 = ContainerPool_1.ContainerPoolToken;\n\nvar Events_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n/**\n * custom events.\n *\n * @export\n * @class Events\n */\nvar Events = /** @class */ (function () {\n    function Events() {\n        this.eventsMap = {};\n    }\n    Events.prototype.on = function (name, event) {\n        this.eventsMap[name] = this.eventsMap[name] || [];\n        if (this.eventsMap[name].indexOf(event) < 0) {\n            this.eventsMap[name].push(event);\n        }\n        return this;\n    };\n    Events.prototype.off = function (name, event) {\n        if (this.eventsMap[name]) {\n            if (event) {\n                this.eventsMap[name].splice(this.eventsMap[name].indexOf(event), 1);\n            }\n            else {\n                delete this.eventsMap[name];\n            }\n        }\n        return this;\n    };\n    Events.prototype.emit = function (name) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        var events = this.eventsMap[name];\n        if (core_1.isArray(events)) {\n            events.forEach(function (ev) {\n                ev.apply(void 0, args);\n            });\n        }\n    };\n    Events.classAnnations = { \"name\": \"Events\", \"params\": { \"constructor\": [], \"on\": [\"name\", \"event\"], \"off\": [\"name\", \"event\"], \"emit\": [\"name\", \"args\"] } };\n    return Events;\n}());\nexports.Events = Events;\n\n\n\n\n});\n\nunwrapExports(Events_1);\nvar Events_2 = Events_1.Events;\n\nvar utils = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(ContainerPool_1, exports);\ntslib_1.__exportStar(Events_1, exports);\n\n\n\n\n});\n\nunwrapExports(utils);\n\nvar InjectedModule_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n/**\n * injected module.\n *\n * @export\n * @class InjectedModule\n * @template T\n */\nvar InjectedModule = /** @class */ (function () {\n    function InjectedModule(token, config, container, type, exports, providers) {\n        this.token = token;\n        this.config = config;\n        this.container = container;\n        this.type = type;\n        this.exports = exports;\n        this.providers = providers;\n    }\n    InjectedModule.classAnnations = { \"name\": \"InjectedModule\", \"params\": { \"constructor\": [\"token\", \"config\", \"container\", \"type\", \"exports\", \"providers\"] } };\n    return InjectedModule;\n}());\nexports.InjectedModule = InjectedModule;\n/**\n * Injected Module Token.\n *\n * @export\n * @class InjectModuleMetaConfigToken\n * @extends {Registration<Type<T>>}\n * @template T\n */\nvar InjectedModuleToken = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectedModuleToken, _super);\n    function InjectedModuleToken(type) {\n        return _super.call(this, type, 'InjectedModule') || this;\n    }\n    InjectedModuleToken.classAnnations = { \"name\": \"InjectedModuleToken\", \"params\": { \"constructor\": [\"type\"] } };\n    return InjectedModuleToken;\n}(core_1.Registration));\nexports.InjectedModuleToken = InjectedModuleToken;\n\n\n\n\n});\n\nunwrapExports(InjectedModule_1);\nvar InjectedModule_2 = InjectedModule_1.InjectedModule;\nvar InjectedModule_3 = InjectedModule_1.InjectedModuleToken;\n\nvar DIModuleInjector_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n\n\n\nvar exportsProvidersFiled = '__exportProviders';\n/**\n * DIModule injector token.\n */\nexports.DIModuleInjectorToken = new core_1.InjectModuleInjectorToken(decorators.DIModule.toString());\n/**\n * DIModule injector.\n *\n * @export\n * @class DIModuleInjector\n * @extends {ModuleInjector}\n */\nvar DIModuleInjector = /** @class */ (function (_super) {\n    tslib_1.__extends(DIModuleInjector, _super);\n    function DIModuleInjector(validate) {\n        return _super.call(this, validate) || this;\n    }\n    DIModuleInjector.prototype.setup = function (container, type) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.importModule(container, type)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    DIModuleInjector.prototype.import = function (container, type) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injMd;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.validate.validate(type)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.importModule(container, type)];\n                    case 1:\n                        injMd = _a.sent();\n                        return [2 /*return*/, injMd];\n                    case 2: return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    DIModuleInjector.prototype.importByConfig = function (container, config) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.registerConfgureDepds(container, config)];\n                    case 1:\n                        _a.sent();\n                        if (!(core_1.isArray(config.providers) && config.providers.length)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.bindProvider(container, config.providers)];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3: return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    DIModuleInjector.prototype.importModule = function (container, type) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var pools, newContainer, metaConfig, injMd;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        pools = container.get(utils.ContainerPoolToken);\n                        newContainer = pools.create(container);\n                        newContainer.register(type);\n                        metaConfig = this.validate.getMetaConfig(type, newContainer);\n                        return [4 /*yield*/, this.registerConfgureDepds(newContainer, metaConfig)];\n                    case 1:\n                        metaConfig = _a.sent();\n                        injMd = new InjectedModule_1.InjectedModule(metaConfig.token || type, metaConfig, newContainer, type, metaConfig.exports || [], metaConfig[exportsProvidersFiled]);\n                        container.bindProvider(new InjectedModule_1.InjectedModuleToken(type), injMd);\n                        return [4 /*yield*/, this.importConfigExports(container, newContainer, injMd)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/, injMd];\n                }\n            });\n        });\n    };\n    DIModuleInjector.prototype.registerConfgureDepds = function (container, config) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(core_1.isArray(config.imports) && config.imports.length)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, container.loadModule.apply(container, config.imports)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        if (core_1.isArray(config.providers) && config.providers.length) {\n                            config[exportsProvidersFiled] = this.bindProvider(container, config.providers);\n                        }\n                        return [2 /*return*/, config];\n                }\n            });\n        });\n    };\n    DIModuleInjector.prototype.importConfigExports = function (container, providerContainer, injMd) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var expchs;\n            return tslib_1.__generator(this, function (_a) {\n                if (container === providerContainer) {\n                    return [2 /*return*/, container];\n                }\n                if (injMd) {\n                    container.resolvers.next(injMd);\n                    if (injMd.exports && injMd.exports.length) {\n                        expchs = providerContainer.resolvers.toArray().filter(function (r) {\n                            if (r instanceof core_1.Container) {\n                                return false;\n                            }\n                            else {\n                                return injMd.exports.indexOf(r.type) >= 0;\n                            }\n                        });\n                        expchs.forEach(function (r) {\n                            container.resolvers.next(r);\n                        });\n                    }\n                }\n                return [2 /*return*/, container];\n            });\n        });\n    };\n    DIModuleInjector.prototype.bindProvider = function (container, providers) {\n        var tokens = [];\n        providers.forEach(function (p, index) {\n            if (core_1.isUndefined(p) || core_1.isNull(p)) {\n                return;\n            }\n            if (core_1.isProviderMap(p)) {\n                p.forEach(function (k, f) {\n                    tokens.push(k);\n                    container.bindProvider(k, f);\n                });\n            }\n            else if (p instanceof core_1.Provider) {\n                tokens.push(p.type);\n                container.bindProvider(p.type, function () {\n                    var providers = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        providers[_i] = arguments[_i];\n                    }\n                    return p.resolve.apply(p, [container].concat(providers));\n                });\n            }\n            else if (core_1.isClass(p)) {\n                if (!container.has(p)) {\n                    tokens.push(p);\n                    container.register(p);\n                }\n            }\n            else if (core_1.isBaseObject(p)) {\n                var pr_1 = p;\n                var isobjMap = false;\n                if (core_1.isToken(pr_1.provide)) {\n                    if (core_1.isArray(pr_1.deps) && pr_1.deps.length) {\n                        pr_1.deps.forEach(function (d) {\n                            if (core_1.isClass(d) && !container.has(d)) {\n                                container.register(d);\n                            }\n                        });\n                    }\n                    if (!core_1.isUndefined(pr_1.useValue)) {\n                        tokens.push(pr_1.provide);\n                        container.bindProvider(pr_1.provide, function () { return pr_1.useValue; });\n                    }\n                    else if (core_1.isClass(pr_1.useClass)) {\n                        if (!container.has(pr_1.useClass)) {\n                            container.register(pr_1.useClass);\n                        }\n                        tokens.push(pr_1.provide);\n                        container.bindProvider(pr_1.provide, pr_1.useClass);\n                    }\n                    else if (core_1.isFunction(pr_1.useFactory)) {\n                        tokens.push(pr_1.provide);\n                        container.bindProvider(pr_1.provide, function () {\n                            var args = [];\n                            if (core_1.isArray(pr_1.deps) && pr_1.deps.length) {\n                                args = pr_1.deps.map(function (d) {\n                                    if (core_1.isClass(d)) {\n                                        return container.get(d);\n                                    }\n                                    else {\n                                        return d;\n                                    }\n                                });\n                            }\n                            return pr_1.useFactory.apply(pr_1, args);\n                        });\n                    }\n                    else if (core_1.isToken(pr_1.useExisting)) {\n                        if (container.has(pr_1.useExisting)) {\n                            tokens.push(pr_1.provide);\n                            container.bindProvider(pr_1.provide, pr_1.useExisting);\n                        }\n                        else {\n                            console.log('has not register:', pr_1.useExisting);\n                        }\n                    }\n                    else {\n                        isobjMap = true;\n                    }\n                }\n                else {\n                    isobjMap = true;\n                }\n                if (isobjMap) {\n                    core_1.lang.forIn(p, function (val, name) {\n                        if (!core_1.isUndefined(val)) {\n                            if (core_1.isClass(val)) {\n                                container.bindProvider(name, val);\n                            }\n                            else if (core_1.isFunction(val) || core_1.isString(val)) {\n                                container.bindProvider(name, function () { return val; });\n                            }\n                            else {\n                                container.bindProvider(name, val);\n                            }\n                            tokens.push(name);\n                        }\n                    });\n                }\n            }\n            else if (core_1.isFunction(p)) {\n                tokens.push(name);\n                container.bindProvider(name, function () { return p; });\n            }\n        });\n        return tokens;\n    };\n    DIModuleInjector.classAnnations = { \"name\": \"DIModuleInjector\", \"params\": { \"constructor\": [\"validate\"], \"setup\": [\"container\", \"type\"], \"import\": [\"container\", \"type\"], \"importByConfig\": [\"container\", \"config\"], \"importModule\": [\"container\", \"type\"], \"registerConfgureDepds\": [\"container\", \"config\"], \"importConfigExports\": [\"container\", \"providerContainer\", \"injMd\"], \"bindProvider\": [\"container\", \"providers\"] } };\n    DIModuleInjector = tslib_1.__decorate([\n        core_1.Injectable(exports.DIModuleInjectorToken),\n        tslib_1.__param(0, core_1.Inject(DIModuleValidate.DIModuelValidateToken)),\n        tslib_1.__metadata(\"design:paramtypes\", [Object])\n    ], DIModuleInjector);\n    return DIModuleInjector;\n}(core_1.ModuleInjector));\nexports.DIModuleInjector = DIModuleInjector;\n\n\n\n\n});\n\nunwrapExports(DIModuleInjector_1);\nvar DIModuleInjector_2 = DIModuleInjector_1.DIModuleInjectorToken;\nvar DIModuleInjector_3 = DIModuleInjector_1.DIModuleInjector;\n\nvar IModuleBuilder = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\nvar moduleBuilderDesc = 'DI_ModuleBuilder';\n/**\n * inject module builder token.\n *\n * @export\n * @class InjectModuleBuilder\n * @extends {Registration<T>}\n * @template T\n */\nvar InjectModuleBuilderToken = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectModuleBuilderToken, _super);\n    function InjectModuleBuilderToken(type) {\n        return _super.call(this, type, moduleBuilderDesc) || this;\n    }\n    InjectModuleBuilderToken.classAnnations = { \"name\": \"InjectModuleBuilderToken\", \"params\": { \"constructor\": [\"type\"] } };\n    return InjectModuleBuilderToken;\n}(core_1.Registration));\nexports.InjectModuleBuilderToken = InjectModuleBuilderToken;\n/**\n * default module builder token.\n */\nexports.DefaultModuleBuilderToken = new InjectModuleBuilderToken(Object);\n/**\n * module builder token.\n */\nexports.ModuleBuilderToken = new core_1.Registration('any', moduleBuilderDesc);\n\n\n\n\n});\n\nunwrapExports(IModuleBuilder);\nvar IModuleBuilder_1 = IModuleBuilder.InjectModuleBuilderToken;\nvar IModuleBuilder_2 = IModuleBuilder.DefaultModuleBuilderToken;\nvar IModuleBuilder_3 = IModuleBuilder.ModuleBuilderToken;\n\nvar IRunner = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n/**\n * boot element.\n *\n * @export\n * @abstract\n * @class Boot\n * @implements {IBoot}\n */\nvar Runner = /** @class */ (function () {\n    function Runner(token, instance, config) {\n        this.token = token;\n        this.instance = instance;\n        this.config = config;\n    }\n    Runner.classAnnations = { \"name\": \"Runner\", \"params\": { \"constructor\": [\"token\", \"instance\", \"config\"], \"run\": [\"data\"] } };\n    return Runner;\n}());\nexports.Runner = Runner;\n/**\n * boot element\n *\n * @export\n * @class Boot\n * @extends {Runner<any>}\n */\nvar Boot = /** @class */ (function (_super) {\n    tslib_1.__extends(Boot, _super);\n    function Boot(token, instance, config) {\n        var _this = _super.call(this, token, instance, config) || this;\n        _this.token = token;\n        _this.instance = instance;\n        _this.config = config;\n        return _this;\n    }\n    Boot.classAnnations = { \"name\": \"Boot\", \"params\": { \"constructor\": [\"token\", \"instance\", \"config\"] } };\n    return Boot;\n}(Runner));\nexports.Boot = Boot;\n/**\n * application runner token.\n *\n * @export\n * @class InjectRunnerToken\n * @extends {Registration<IRunner<T>>}\n * @template T\n */\nvar InjectRunnerToken = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectRunnerToken, _super);\n    function InjectRunnerToken(type) {\n        return _super.call(this, type, 'boot__runner') || this;\n    }\n    InjectRunnerToken.classAnnations = { \"name\": \"InjectRunnerToken\", \"params\": { \"constructor\": [\"type\"] } };\n    return InjectRunnerToken;\n}(core_1.Registration));\nexports.InjectRunnerToken = InjectRunnerToken;\n/**\n * default runner token.\n */\nexports.DefaultRunnerToken = new InjectRunnerToken('default');\n\n\n\n\n});\n\nunwrapExports(IRunner);\nvar IRunner_1 = IRunner.Runner;\nvar IRunner_2 = IRunner.Boot;\nvar IRunner_3 = IRunner.InjectRunnerToken;\nvar IRunner_4 = IRunner.DefaultRunnerToken;\n\nvar Service_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n/**\n * base service.\n *\n * @export\n * @abstract\n * @class Service\n * @implements {IService}\n */\nvar Service = /** @class */ (function () {\n    function Service(token, instance, config) {\n        this.token = token;\n        this.instance = instance;\n        this.config = config;\n    }\n    Service.classAnnations = { \"name\": \"Service\", \"params\": { \"constructor\": [\"token\", \"instance\", \"config\"], \"start\": [\"data\"], \"stop\": [] } };\n    return Service;\n}());\nexports.Service = Service;\n/**\n * application service token.\n *\n * @export\n * @class InjectServiceToken\n * @extends {Registration<IService<T>>}\n * @template T\n */\nvar InjectServiceToken = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectServiceToken, _super);\n    function InjectServiceToken(type) {\n        return _super.call(this, type, 'boot__service') || this;\n    }\n    InjectServiceToken.classAnnations = { \"name\": \"InjectServiceToken\", \"params\": { \"constructor\": [\"type\"] } };\n    return InjectServiceToken;\n}(core_1.Registration));\nexports.InjectServiceToken = InjectServiceToken;\n/**\n * default service token.\n */\nexports.DefaultServiceToken = new InjectServiceToken('default');\n\n\n\n\n});\n\nunwrapExports(Service_1);\nvar Service_2 = Service_1.Service;\nvar Service_3 = Service_1.InjectServiceToken;\nvar Service_4 = Service_1.DefaultServiceToken;\n\nvar runnable = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(IRunner, exports);\ntslib_1.__exportStar(Service_1, exports);\n\n\n\n\n});\n\nunwrapExports(runnable);\n\nvar IAnnotationBuilder = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\nvar annoBuilderDesc = 'DI_AnnotationBuilder';\n/**\n * inject Annotation class builder.\n *\n * @export\n * @class InjectBootstrapBuilder\n * @extends {Registration<T>}\n * @template T\n */\nvar InjectAnnotationBuilder = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectAnnotationBuilder, _super);\n    function InjectAnnotationBuilder(type) {\n        return _super.call(this, type, annoBuilderDesc) || this;\n    }\n    InjectAnnotationBuilder.classAnnations = { \"name\": \"InjectAnnotationBuilder\", \"params\": { \"constructor\": [\"type\"] } };\n    return InjectAnnotationBuilder;\n}(core_1.Registration));\nexports.InjectAnnotationBuilder = InjectAnnotationBuilder;\n/**\n * Annotation class builder token.\n */\nexports.AnnotationBuilderToken = new core_1.Registration(Object, annoBuilderDesc);\n/**\n * Default Annotation class builder token.\n */\nexports.DefaultAnnotationBuilderToken = new InjectAnnotationBuilder('default');\n\n\n\n\n});\n\nunwrapExports(IAnnotationBuilder);\nvar IAnnotationBuilder_1 = IAnnotationBuilder.InjectAnnotationBuilder;\nvar IAnnotationBuilder_2 = IAnnotationBuilder.AnnotationBuilderToken;\nvar IAnnotationBuilder_3 = IAnnotationBuilder.DefaultAnnotationBuilderToken;\n\nvar AnnotationBuilder_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n\n/**\n * Annotation class builder. build class with metadata and config.\n *\n * @export\n * @class AnnotationBuilder\n * @implements {implements IAnnotationBuilder<T>}\n * @template T\n */\nvar AnnotationBuilder = /** @class */ (function () {\n    function AnnotationBuilder() {\n    }\n    AnnotationBuilder_1 = AnnotationBuilder;\n    AnnotationBuilder.prototype.build = function (token, config, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var builder, instance;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (core_1.isClass(token) && !this.container.hasRegister(token)) {\n                            this.container.register(token);\n                        }\n                        config = this.getTokenMetaConfig(token, config);\n                        builder = this.getBuilder(token, config);\n                        if (!!this.isEqual(builder)) return [3 /*break*/, 1];\n                        return [2 /*return*/, builder.build(token, config, data)];\n                    case 1: return [4 /*yield*/, this.registerExts(config)];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, this.createInstance(token, config, data)];\n                    case 3:\n                        instance = _a.sent();\n                        if (!instance) {\n                            return [2 /*return*/, null];\n                        }\n                        if (!core_1.isFunction(instance.anBeforeInit)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, Promise.resolve(instance.anBeforeInit(config))];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5: return [4 /*yield*/, this.buildStrategy(instance, config, data)];\n                    case 6:\n                        instance = (_a.sent());\n                        if (!core_1.isFunction(instance.anAfterInit)) return [3 /*break*/, 8];\n                        return [4 /*yield*/, Promise.resolve(instance.anAfterInit(config))];\n                    case 7:\n                        _a.sent();\n                        _a.label = 8;\n                    case 8: return [2 /*return*/, instance];\n                }\n            });\n        });\n    };\n    AnnotationBuilder.prototype.buildByConfig = function (config, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var token;\n            return tslib_1.__generator(this, function (_a) {\n                if (core_1.isToken(config)) {\n                    token = config;\n                    return [2 /*return*/, this.build(token, null, data)];\n                }\n                else {\n                    token = this.getType(config);\n                    return [2 /*return*/, this.build(token, config, data)];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    AnnotationBuilder.prototype.createInstance = function (token, config, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var instance;\n            return tslib_1.__generator(this, function (_a) {\n                if (!token) {\n                    console.log('can not find annotation token.');\n                    return [2 /*return*/, null];\n                }\n                if (!this.container.has(token)) {\n                    console.log(\"can not find token \" + (token ? token.toString() : null) + \" in container.\");\n                    return [2 /*return*/, null];\n                }\n                instance = this.resolveToken(token, data);\n                return [2 /*return*/, instance];\n            });\n        });\n    };\n    AnnotationBuilder.prototype.getBuilder = function (token, config) {\n        var builder;\n        var provider = { provide: core_1.ContainerToken, useValue: this.container };\n        if (config && config.annotationBuilder) {\n            if (core_1.isClass(config.annotationBuilder)) {\n                if (!this.container.has(config.annotationBuilder)) {\n                    this.container.register(config.annotationBuilder);\n                }\n            }\n            if (core_1.isToken(config.annotationBuilder)) {\n                builder = this.container.resolve(config.annotationBuilder, provider);\n            }\n            else if (config.annotationBuilder instanceof AnnotationBuilder_1) {\n                builder = config.annotationBuilder;\n            }\n        }\n        if (!builder && token) {\n            builder = this.container.getRefService(IAnnotationBuilder.InjectAnnotationBuilder, token, null, provider);\n        }\n        if (builder && !builder.container) {\n            builder.container = this.container;\n        }\n        return builder || this;\n    };\n    /**\n     * bundle instance via config.\n     *\n     * @param {T} instance\n     * @param {AnnotationConfigure} config\n     * @param {IContainer} [container]\n     * @returns {Promise<T>}\n     * @memberof BootBuilder\n     */\n    AnnotationBuilder.prototype.buildStrategy = function (instance, config, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, instance];\n            });\n        });\n    };\n    AnnotationBuilder.prototype.getType = function (config) {\n        return config.token || config.type;\n    };\n    /**\n     * register extension before create instance.\n     *\n     * @protected\n     * @param {AnnotationConfigure<T>} [config]\n     * @memberof AnnotationBuilder\n     */\n    AnnotationBuilder.prototype.registerExts = function (config) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    };\n    AnnotationBuilder.prototype.getTokenMetaConfig = function (token, config) {\n        var cfg;\n        if (core_1.isClass(token)) {\n            cfg = this.getMetaConfig(token);\n        }\n        else if (core_1.isToken(token)) {\n            var tokenType = this.container ? this.container.getTokenImpl(token) : token;\n            if (core_1.isClass(tokenType)) {\n                cfg = this.getMetaConfig(tokenType);\n            }\n        }\n        if (cfg) {\n            return core_1.lang.assign({}, cfg, config || {});\n        }\n        else {\n            return config || {};\n        }\n    };\n    AnnotationBuilder.prototype.getDecorator = function () {\n        return decorators.Annotation.toString();\n    };\n    AnnotationBuilder.prototype.getMetaConfig = function (token) {\n        var accessor = this.container.resolve(core_1.AnnotationMetaAccessorToken, { decorator: this.getDecorator() });\n        if (accessor) {\n            return accessor.getMetadata(token, this.container);\n        }\n        return null;\n    };\n    AnnotationBuilder.prototype.isEqual = function (build) {\n        if (!build) {\n            return false;\n        }\n        if (build === this) {\n            return true;\n        }\n        if (build.constructor === this.constructor) {\n            return true;\n        }\n        return false;\n    };\n    AnnotationBuilder.prototype.resolveToken = function (token, data) {\n        return this.container.resolve(token);\n    };\n    var AnnotationBuilder_1;\n    AnnotationBuilder.classAnnations = { \"name\": \"AnnotationBuilder\", \"params\": { \"constructor\": [], \"build\": [\"token\", \"config\", \"data\"], \"buildByConfig\": [\"config\", \"data\"], \"createInstance\": [\"token\", \"config\", \"data\"], \"getBuilder\": [\"token\", \"config\"], \"buildStrategy\": [\"instance\", \"config\", \"data\"], \"getType\": [\"config\"], \"registerExts\": [\"config\"], \"getTokenMetaConfig\": [\"token\", \"config\"], \"getDecorator\": [], \"getMetaConfig\": [\"token\"], \"isEqual\": [\"build\"], \"resolveToken\": [\"token\", \"data\"] } };\n    tslib_1.__decorate([\n        core_1.Inject(core_1.ContainerToken),\n        tslib_1.__metadata(\"design:type\", Object)\n    ], AnnotationBuilder.prototype, \"container\", void 0);\n    AnnotationBuilder = AnnotationBuilder_1 = tslib_1.__decorate([\n        core_1.Injectable(IAnnotationBuilder.AnnotationBuilderToken),\n        tslib_1.__metadata(\"design:paramtypes\", [])\n    ], AnnotationBuilder);\n    return AnnotationBuilder;\n}());\nexports.AnnotationBuilder = AnnotationBuilder;\n\n\n\n\n});\n\nunwrapExports(AnnotationBuilder_1);\nvar AnnotationBuilder_2 = AnnotationBuilder_1.AnnotationBuilder;\n\nvar annotations = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(AnnotationBuilder_1, exports);\ntslib_1.__exportStar(IAnnotationBuilder, exports);\n\n\n\n\n});\n\nunwrapExports(annotations);\n\nvar ModuleBuilder_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n\n\n\n\n\n\n/**\n * inject module load token.\n *\n * @export\n * @class InjectModuleLoadToken\n * @extends {Registration<T>}\n * @template T\n */\nvar InjectModuleLoadToken = /** @class */ (function (_super) {\n    tslib_1.__extends(InjectModuleLoadToken, _super);\n    function InjectModuleLoadToken(token) {\n        return _super.call(this, token, 'module_loader') || this;\n    }\n    InjectModuleLoadToken.classAnnations = { \"name\": \"InjectModuleLoadToken\", \"params\": { \"constructor\": [\"token\"] } };\n    return InjectModuleLoadToken;\n}(core_1.Registration));\nexports.InjectModuleLoadToken = InjectModuleLoadToken;\n/**\n * module builder\n *\n * @export\n * @class ModuleBuilder\n * @implements {IModuleBuilder}\n * @template T\n */\nvar ModuleBuilder = /** @class */ (function () {\n    function ModuleBuilder() {\n    }\n    ModuleBuilder.prototype.getPools = function () {\n        return this.pools;\n    };\n    /**\n     * build module.\n     *\n     * @param {(Token<T> | ModuleConfig<T>)} token\n     * @param {ModuleEnv} [env]\n     * @param {*} [data] bootstrap data, build data, Runnable data.\n     * @returns {Promise<T>}\n     * @memberof ModuleBuilder\n     */\n    ModuleBuilder.prototype.build = function (token, env, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl, container, cfg, annBuilder, instance, instance, mdlInst;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.load(token, env)];\n                    case 1:\n                        injmdl = _a.sent();\n                        container = injmdl.container;\n                        cfg = injmdl.config;\n                        annBuilder = this.getAnnoBuilder(container, injmdl.token, cfg.annotationBuilder);\n                        if (!!injmdl.token) return [3 /*break*/, 3];\n                        return [4 /*yield*/, annBuilder.buildByConfig(cfg, data)];\n                    case 2:\n                        instance = _a.sent();\n                        return [2 /*return*/, instance];\n                    case 3: return [4 /*yield*/, annBuilder.build(injmdl.token, cfg, data)];\n                    case 4:\n                        instance = _a.sent();\n                        mdlInst = instance;\n                        if (mdlInst && core_1.isFunction(mdlInst.mdOnInit)) {\n                            mdlInst.mdOnInit(injmdl);\n                        }\n                        return [2 /*return*/, instance];\n                }\n            });\n        });\n    };\n    /**\n    * bootstrap module's main.\n    *\n    * @param {(Token<T> | ModuleConfig<T>)} token\n    * @param {ModuleEnv} [env]\n    * @param {*} [data] bootstrap data, build data, Runnable data.\n    * @returns {Promise<MdInstance<T>>}\n    * @memberof ModuleBuilder\n    */\n    ModuleBuilder.prototype.bootstrap = function (token, env, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl, cfg, container, md, bootToken, anBuilder, bootInstance, runable;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.load(token, env)];\n                    case 1:\n                        injmdl = _a.sent();\n                        cfg = injmdl.config;\n                        container = injmdl.container;\n                        return [4 /*yield*/, this.build(token, injmdl, data)];\n                    case 2:\n                        md = _a.sent();\n                        bootToken = this.getBootType(cfg);\n                        anBuilder = this.getAnnoBuilder(container, bootToken, cfg.annotationBuilder);\n                        return [4 /*yield*/, (bootToken ? anBuilder.build(bootToken, cfg, data) : anBuilder.buildByConfig(cfg, data))];\n                    case 3:\n                        bootInstance = _a.sent();\n                        if (!bootInstance) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this.autoRun(container, bootToken ? bootToken : anBuilder.getType(cfg), cfg, bootInstance, data)];\n                    case 4:\n                        runable = _a.sent();\n                        if (!(md && core_1.isFunction(md.mdOnStart))) return [3 /*break*/, 6];\n                        return [4 /*yield*/, Promise.resolve(md.mdOnStart(bootInstance))];\n                    case 5:\n                        _a.sent();\n                        _a.label = 6;\n                    case 6: return [3 /*break*/, 9];\n                    case 7: return [4 /*yield*/, this.autoRun(container, injmdl.token, cfg, md, data)];\n                    case 8:\n                        runable = _a.sent();\n                        _a.label = 9;\n                    case 9: return [2 /*return*/, runable];\n                }\n            });\n        });\n    };\n    ModuleBuilder.prototype.import = function (token, parent) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var type, key;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!parent) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.getParentContainer()];\n                    case 1:\n                        parent = _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        type = core_1.isClass(token) ? token : parent.getTokenImpl(token);\n                        if (!core_1.isClass(type)) return [3 /*break*/, 5];\n                        key = new InjectedModule_1.InjectedModuleToken(type);\n                        if (!parent.hasRegister(key.toString())) return [3 /*break*/, 3];\n                        return [2 /*return*/, parent.get(key)];\n                    case 3: return [4 /*yield*/, parent.loadModule(type)];\n                    case 4:\n                        _a.sent();\n                        if (parent.has(key)) {\n                            return [2 /*return*/, parent.get(key)];\n                        }\n                        _a.label = 5;\n                    case 5: return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    ModuleBuilder.prototype.load = function (token, env) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl, parent, cfg, mdtype, container, injector, injector;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (env instanceof InjectedModule_1.InjectedModule) {\n                            return [2 /*return*/, env];\n                        }\n                        injmdl = null;\n                        return [4 /*yield*/, this.getParentContainer(env)];\n                    case 1:\n                        parent = _a.sent();\n                        if (!core_1.isToken(token)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.import(token, parent)];\n                    case 2:\n                        injmdl = _a.sent();\n                        if (!injmdl) {\n                            cfg = parent.get(core_1.AnnotationMetaAccessorToken).getMetadata(token, parent);\n                            injmdl = new InjectedModule_1.InjectedModule(token, cfg, parent);\n                        }\n                        return [3 /*break*/, 10];\n                    case 3:\n                        mdtype = this.getType(token);\n                        if (!core_1.isToken(mdtype)) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this.import(mdtype, parent)];\n                    case 4:\n                        injmdl = _a.sent();\n                        if (!(injmdl instanceof InjectedModule_1.InjectedModule)) return [3 /*break*/, 6];\n                        container = injmdl.container;\n                        injector = container.get(DIModuleInjector_1.DIModuleInjectorToken);\n                        return [4 /*yield*/, injector.importByConfig(container, token)];\n                    case 5:\n                        _a.sent();\n                        injmdl.config = core_1.lang.assign(injmdl.config, token);\n                        _a.label = 6;\n                    case 6: return [3 /*break*/, 8];\n                    case 7:\n                        mdtype = null;\n                        _a.label = 8;\n                    case 8:\n                        if (!!injmdl) return [3 /*break*/, 10];\n                        injector = parent.get(DIModuleInjector_1.DIModuleInjectorToken);\n                        return [4 /*yield*/, injector.importByConfig(parent, token)];\n                    case 9:\n                        _a.sent();\n                        injmdl = new InjectedModule_1.InjectedModule(mdtype, token, parent);\n                        _a.label = 10;\n                    case 10: return [2 /*return*/, injmdl];\n                }\n            });\n        });\n    };\n    ModuleBuilder.prototype.getParentContainer = function (env) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var parent;\n            return tslib_1.__generator(this, function (_a) {\n                if (env) {\n                    if (env instanceof core_1.Container) {\n                        parent = env;\n                    }\n                    else if (env instanceof InjectedModule_1.InjectedModule) {\n                        parent = env.container.parent;\n                    }\n                }\n                if (!parent) {\n                    parent = this.getPools().getDefault();\n                }\n                return [2 /*return*/, parent];\n            });\n        });\n    };\n    ModuleBuilder.prototype.autoRun = function (container, token, cfg, instance, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var provider, runner, service;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!instance) {\n                            return [2 /*return*/, null];\n                        }\n                        if (!(instance instanceof runnable.Runner)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, instance.run(data)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, instance];\n                    case 2:\n                        if (!(instance instanceof runnable.Service)) return [3 /*break*/, 4];\n                        return [4 /*yield*/, instance.start(data)];\n                    case 3:\n                        _a.sent();\n                        return [2 /*return*/, instance];\n                    case 4:\n                        provider = { token: token, instance: instance, config: cfg };\n                        runner = container.getRefService(runnable.InjectRunnerToken, token, runnable.DefaultRunnerToken, provider);\n                        service = void 0;\n                        if (!runner) {\n                            service = container.getRefService(runnable.InjectServiceToken, token, runnable.DefaultServiceToken, provider);\n                            if (!service) {\n                                runner = this.getDefaultRunner(container, provider);\n                            }\n                        }\n                        if (!runner && !service) {\n                            this.getDefaultService(container, provider);\n                        }\n                        if (!runner) return [3 /*break*/, 6];\n                        return [4 /*yield*/, runner.run(data)];\n                    case 5:\n                        _a.sent();\n                        return [2 /*return*/, runner];\n                    case 6:\n                        if (!service) return [3 /*break*/, 8];\n                        return [4 /*yield*/, service.start(data)];\n                    case 7:\n                        _a.sent();\n                        return [2 /*return*/, service];\n                    case 8:\n                        if (!(token && cfg.autorun)) return [3 /*break*/, 10];\n                        return [4 /*yield*/, container.invoke(token, cfg.autorun, instance, { data: data })];\n                    case 9:\n                        _a.sent();\n                        return [2 /*return*/, instance];\n                    case 10: return [2 /*return*/, instance];\n                }\n            });\n        });\n    };\n    ModuleBuilder.prototype.getDefaultRunner = function (container) {\n        var providers = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            providers[_i - 1] = arguments[_i];\n        }\n        return null;\n    };\n    ModuleBuilder.prototype.getDefaultService = function (container) {\n        var providers = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            providers[_i - 1] = arguments[_i];\n        }\n        return null;\n    };\n    ModuleBuilder.prototype.getAnnoBuilder = function (container, token, annBuilder) {\n        var builder;\n        if (core_1.isClass(annBuilder)) {\n            if (!container.has(annBuilder)) {\n                container.register(annBuilder);\n            }\n        }\n        if (core_1.isToken(annBuilder)) {\n            builder = container.resolve(annBuilder);\n        }\n        else if (annBuilder instanceof annotations.AnnotationBuilder) {\n            builder = annBuilder;\n        }\n        if (!builder && token) {\n            builder = container.getRefService(annotations.InjectAnnotationBuilder, token, annotations.DefaultAnnotationBuilderToken);\n        }\n        if (!builder) {\n            builder = this.getDefaultAnnBuilder(container);\n        }\n        if (builder) {\n            builder.container = container;\n        }\n        return builder;\n    };\n    ModuleBuilder.prototype.getDefaultAnnBuilder = function (container) {\n        return container.resolve(annotations.AnnotationBuilderToken);\n    };\n    /**\n     * get module type\n     *\n     * @protected\n     * @param {ModuleConfigure} cfg\n     * @returns {Token<T>}\n     * @memberof ModuleBuilder\n     */\n    ModuleBuilder.prototype.getType = function (cfg) {\n        return cfg.token || cfg.type;\n    };\n    /**\n     * get boot type.\n     *\n     * @protected\n     * @param {ModuleConfigure} cfg\n     * @returns {Token<T>}\n     * @memberof ModuleBuilder\n     */\n    ModuleBuilder.prototype.getBootType = function (cfg) {\n        return cfg.bootstrap;\n    };\n    ModuleBuilder.classAnnations = { \"name\": \"ModuleBuilder\", \"params\": { \"constructor\": [], \"getPools\": [], \"build\": [\"token\", \"env\", \"data\"], \"bootstrap\": [\"token\", \"env\", \"data\"], \"import\": [\"token\", \"parent\"], \"load\": [\"token\", \"env\"], \"getParentContainer\": [\"env\"], \"autoRun\": [\"container\", \"token\", \"cfg\", \"instance\", \"data\"], \"getDefaultRunner\": [\"container\", \"providers\"], \"getDefaultService\": [\"container\", \"providers\"], \"getAnnoBuilder\": [\"container\", \"token\", \"annBuilder\"], \"getDefaultAnnBuilder\": [\"container\"], \"getType\": [\"cfg\"], \"getBootType\": [\"cfg\"] } };\n    tslib_1.__decorate([\n        core_1.Inject(utils.ContainerPoolToken),\n        tslib_1.__metadata(\"design:type\", utils.ContainerPool)\n    ], ModuleBuilder.prototype, \"pools\", void 0);\n    ModuleBuilder = tslib_1.__decorate([\n        core_1.Singleton(IModuleBuilder.ModuleBuilderToken),\n        tslib_1.__metadata(\"design:paramtypes\", [])\n    ], ModuleBuilder);\n    return ModuleBuilder;\n}());\nexports.ModuleBuilder = ModuleBuilder;\n\n\n\n\n});\n\nunwrapExports(ModuleBuilder_1);\nvar ModuleBuilder_2 = ModuleBuilder_1.InjectModuleLoadToken;\nvar ModuleBuilder_3 = ModuleBuilder_1.ModuleBuilder;\n\nvar modules = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(DIModuleInjector_1, exports);\ntslib_1.__exportStar(DIModuleValidate, exports);\ntslib_1.__exportStar(InjectedModule_1, exports);\ntslib_1.__exportStar(IModuleBuilder, exports);\ntslib_1.__exportStar(ModuleBuilder_1, exports);\n\n\n\n\n});\n\nunwrapExports(modules);\n\nvar BootModule_1 = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n\n\n\n/**\n * Bootstrap ext for ioc. auto run setup after registered.\n * with @IocExt('setup') decorator.\n * @export\n * @class BootModule\n */\nvar BootModule = /** @class */ (function () {\n    function BootModule(container) {\n        this.container = container;\n    }\n    /**\n     * register aop for container.\n     *\n     * @memberof AopModule\n     */\n    BootModule.prototype.setup = function () {\n        var container = this.container;\n        var lifeScope = container.get(core_1.LifeScopeToken);\n        lifeScope.registerDecorator(decorators.DIModule, core_1.CoreActions.bindProvider, core_1.CoreActions.cache, core_1.CoreActions.componentBeforeInit, core_1.CoreActions.componentInit, core_1.CoreActions.componentAfterInit);\n        lifeScope.registerDecorator(decorators.Bootstrap, core_1.CoreActions.bindProvider, core_1.CoreActions.cache, core_1.CoreActions.componentBeforeInit, core_1.CoreActions.componentInit, core_1.CoreActions.componentAfterInit);\n        container.use(annotations, modules, boot);\n    };\n    BootModule.classAnnations = { \"name\": \"BootModule\", \"params\": { \"constructor\": [\"container\"], \"setup\": [] } };\n    BootModule = tslib_1.__decorate([\n        core_1.IocExt('setup'),\n        tslib_1.__param(0, core_1.Inject(core_1.ContainerToken)),\n        tslib_1.__metadata(\"design:paramtypes\", [Object])\n    ], BootModule);\n    return BootModule;\n}());\nexports.BootModule = BootModule;\n\n\n\n\n});\n\nunwrapExports(BootModule_1);\nvar BootModule_2 = BootModule_1.BootModule;\n\nvar ApplicationBuilder = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\n\n\n\n\n\nvar ApplicationEvents;\n(function (ApplicationEvents) {\n    ApplicationEvents[\"onRootContainerCreated\"] = \"onRootContainerCreated\";\n    ApplicationEvents[\"onRootContainerInited\"] = \"onRooConatianerInited\";\n})(ApplicationEvents = exports.ApplicationEvents || (exports.ApplicationEvents = {}));\n/**\n * application builder.\n *\n * @export\n * @class Default ApplicationBuilder\n * @extends {ModuleBuilder}\n * @template T\n */\nvar DefaultApplicationBuilder = /** @class */ (function (_super) {\n    tslib_1.__extends(DefaultApplicationBuilder, _super);\n    function DefaultApplicationBuilder(baseURL) {\n        var _this = _super.call(this) || this;\n        _this.baseURL = baseURL;\n        _this.inited = false;\n        _this.customRegs = [];\n        _this.globalModules = [];\n        _this.configs = [];\n        _this.beforeInitPds = new core_1.MapSet();\n        _this.afterInitPds = new core_1.MapSet();\n        _this.events = new utils.Events();\n        _this.initEvents();\n        return _this;\n    }\n    DefaultApplicationBuilder.prototype.initEvents = function () {\n        var _this = this;\n        this.events.on('onRooConatianerInited', function (container) {\n            _this.afterInitPds.forEach(function (val, key) {\n                container.bindProvider(key, val);\n            });\n        });\n    };\n    DefaultApplicationBuilder.create = function (baseURL) {\n        return new DefaultApplicationBuilder(baseURL);\n    };\n    DefaultApplicationBuilder.prototype.on = function (name, event) {\n        this.events.on(name, event);\n        return this;\n    };\n    DefaultApplicationBuilder.prototype.off = function (name, event) {\n        this.events.off(name, event);\n        return this;\n    };\n    DefaultApplicationBuilder.prototype.emit = function (name) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        var _a;\n        (_a = this.events).emit.apply(_a, [name].concat(args));\n    };\n    DefaultApplicationBuilder.prototype.getPools = function () {\n        if (!this.pools) {\n            this.pools = new utils.ContainerPool(this.createContainerBuilder());\n            this.createDefaultContainer();\n        }\n        return this.pools;\n    };\n    DefaultApplicationBuilder.prototype.createContainerBuilder = function () {\n        return new core_1.DefaultContainerBuilder();\n    };\n    /**\n     * use configuration.\n     *\n     * @param {(string | AppConfigure)} [config]\n     * @returns {this} global config for this application.\n     * @memberof Bootstrap\n     */\n    DefaultApplicationBuilder.prototype.useConfiguration = function (config) {\n        if (core_1.isUndefined(config)) {\n            config = '';\n        }\n        // clean cached config.\n        this.globalConfig = null;\n        var idx = this.configs.indexOf(config);\n        if (idx >= 0) {\n            this.configs.splice(idx, 1);\n        }\n        this.configs.push(config);\n        return this;\n    };\n    DefaultApplicationBuilder.prototype.loadConfig = function (container, src) {\n        if (container.has(AppConfigure.AppConfigureLoaderToken)) {\n            var loader = container.resolve(AppConfigure.AppConfigureLoaderToken, { baseURL: this.baseURL, container: container });\n            return loader.load(src);\n        }\n        else if (src) {\n            var builder = container.getBuilder();\n            return builder.loader.load([src])\n                .then(function (rs) {\n                return rs.length ? rs[0] : null;\n            });\n        }\n        else {\n            return Promise.resolve(null);\n        }\n    };\n    /**\n     * use module as global Depdences module.\n     *\n     * @param {...LoadType[]} modules\n     * @returns {this}\n     * @memberof PlatformServer\n     */\n    DefaultApplicationBuilder.prototype.use = function () {\n        var modules$$1 = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules$$1[_i] = arguments[_i];\n        }\n        this.globalModules = this.globalModules.concat(modules$$1);\n        this.inited = false;\n        return this;\n    };\n    /**\n     * bind provider\n     *\n     * @template T\n     * @param {Token<T>} provide\n     * @param {Token<T> | Factory<T>} provider\n     * @param {boolean} [beforRootInit]\n     * @returns {this}\n     * @memberof IContainer\n     */\n    DefaultApplicationBuilder.prototype.provider = function (provide, provider, beforRootInit) {\n        if (beforRootInit) {\n            this.beforeInitPds.set(provide, provider);\n        }\n        else {\n            this.afterInitPds.set(provide, provider);\n        }\n        return this;\n    };\n    DefaultApplicationBuilder.prototype.load = function (token, env) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.initRootContainer()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, _super.prototype.load.call(this, token, env)];\n                }\n            });\n        });\n    };\n    DefaultApplicationBuilder.prototype.build = function (token, env, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl, builder;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.load(token, env)];\n                    case 1:\n                        injmdl = _a.sent();\n                        builder = this.getBuilder(injmdl);\n                        return [4 /*yield*/, builder.build(token, injmdl, data)];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    DefaultApplicationBuilder.prototype.bootstrap = function (token, env, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl, builder;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.load(token, env)];\n                    case 1:\n                        injmdl = _a.sent();\n                        builder = this.getBuilder(injmdl);\n                        return [4 /*yield*/, builder.bootstrap(token, injmdl, data)];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    /**\n     * get module builder\n     *\n     * @param {(Token<T> | ModuleConfig<T>)} token\n     * @param {ModuleEnv} [env]\n     * @returns {IModuleBuilder<T>}\n     * @memberof IApplicationBuilder\n     */\n    DefaultApplicationBuilder.prototype.getBuilderByConfig = function (token, env) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var injmdl;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.load(token, env)];\n                    case 1:\n                        injmdl = _a.sent();\n                        return [2 /*return*/, this.getBuilder(injmdl)];\n                }\n            });\n        });\n    };\n    DefaultApplicationBuilder.prototype.getBuilder = function (injmdl) {\n        var cfg = injmdl.config;\n        var container = injmdl.container;\n        var builder;\n        if (cfg) {\n            if (core_1.isClass(cfg.builder)) {\n                if (!container.has(cfg.builder)) {\n                    container.register(cfg.builder);\n                }\n            }\n            if (core_1.isToken(cfg.builder)) {\n                builder = container.resolve(cfg.builder);\n            }\n            else if (cfg.builder instanceof modules.ModuleBuilder) {\n                builder = cfg.builder;\n            }\n        }\n        var tko = injmdl.token;\n        if (!builder && tko) {\n            builder = container.getRefService(modules.InjectModuleBuilderToken, tko, modules.DefaultModuleBuilderToken);\n        }\n        if (!builder) {\n            builder = this.getDefaultBuilder(container);\n        }\n        return builder || this;\n    };\n    DefaultApplicationBuilder.prototype.getDefaultBuilder = function (container) {\n        return container.resolve(modules.ModuleBuilderToken);\n    };\n    DefaultApplicationBuilder.prototype.getGlobalConfig = function (container) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var globCfg_1, exts;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!this.globalConfig) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.getDefaultConfig(container)];\n                    case 1:\n                        globCfg_1 = _a.sent();\n                        if (this.configs.length < 1) {\n                            this.configs.push(''); // load default loader config.\n                        }\n                        return [4 /*yield*/, Promise.all(this.configs.map(function (cfg) {\n                                if (core_1.isString(cfg)) {\n                                    return _this.loadConfig(container, cfg);\n                                }\n                                else {\n                                    return cfg;\n                                }\n                            }))];\n                    case 2:\n                        exts = _a.sent();\n                        exts.forEach(function (exCfg) {\n                            if (exCfg) {\n                                core_1.lang.assign(globCfg_1, exCfg);\n                            }\n                        });\n                        this.globalConfig = globCfg_1;\n                        _a.label = 3;\n                    case 3: return [2 /*return*/, this.globalConfig];\n                }\n            });\n        });\n    };\n    DefaultApplicationBuilder.prototype.createDefaultContainer = function () {\n        var _this = this;\n        var container = this.pools.getDefault();\n        container.register(BootModule_1.BootModule);\n        var chain = container.getBuilder().getInjectorChain(container);\n        chain.first(container.resolve(modules.DIModuleInjectorToken));\n        container.bindProvider(utils.ContainerPoolToken, function () { return _this.getPools(); });\n        this.beforeInitPds.forEach(function (val, key) {\n            container.bindProvider(key, val);\n        });\n        this.events.emit(ApplicationEvents.onRootContainerCreated, container);\n        return container;\n    };\n    DefaultApplicationBuilder.prototype.initRootContainer = function (container) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var globCfg;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.inited) {\n                            return [2 /*return*/];\n                        }\n                        container = container || this.getPools().getDefault();\n                        return [4 /*yield*/, this.getGlobalConfig(container)];\n                    case 1:\n                        globCfg = _a.sent();\n                        return [4 /*yield*/, this.registerExts(container, globCfg)];\n                    case 2:\n                        _a.sent();\n                        this.bindAppConfig(globCfg);\n                        container.bindProvider(AppConfigure.AppConfigureToken, globCfg);\n                        this.inited = true;\n                        this.events.emit(ApplicationEvents.onRootContainerInited, container);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * register ioc exts\n     *\n     * @protected\n     * @param {IContainer} container\n     * @param {AppConfigure} config\n     * @returns {Promise<IContainer>}\n     * @memberof ApplicationBuilder\n     */\n    DefaultApplicationBuilder.prototype.registerExts = function (container, config) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var usedModules;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.globalModules.length) return [3 /*break*/, 2];\n                        usedModules = this.globalModules;\n                        return [4 /*yield*/, container.loadModule.apply(container, usedModules)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        if (!this.customRegs.length) return [3 /*break*/, 4];\n                        return [4 /*yield*/, Promise.all(this.customRegs.map(function (cs) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                                var tokens;\n                                return tslib_1.__generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, cs(container, config, this)];\n                                        case 1:\n                                            tokens = _a.sent();\n                                            return [2 /*return*/, tokens];\n                                    }\n                                });\n                            }); }))];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4: return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    DefaultApplicationBuilder.prototype.bindAppConfig = function (config) {\n        if (this.baseURL) {\n            config.baseURL = this.baseURL;\n        }\n        return config;\n    };\n    DefaultApplicationBuilder.prototype.getDefaultConfig = function (container) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                if (container.has(AppConfigure.DefaultConfigureToken)) {\n                    return [2 /*return*/, container.resolve(AppConfigure.DefaultConfigureToken)];\n                }\n                else {\n                    return [2 /*return*/, {}];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    DefaultApplicationBuilder.classAnnations = { \"name\": \"DefaultApplicationBuilder\", \"params\": { \"constructor\": [\"baseURL\"], \"initEvents\": [], \"create\": [\"baseURL\"], \"on\": [\"name\", \"event\"], \"off\": [\"name\", \"event\"], \"emit\": [\"name\", \"args\"], \"getPools\": [], \"createContainerBuilder\": [], \"useConfiguration\": [\"config\"], \"loadConfig\": [\"container\", \"src\"], \"use\": [\"modules\"], \"provider\": [\"provide\", \"provider\", \"beforRootInit\"], \"load\": [\"token\", \"env\"], \"build\": [\"token\", \"env\", \"data\"], \"bootstrap\": [\"token\", \"env\", \"data\"], \"getBuilderByConfig\": [\"token\", \"env\"], \"getBuilder\": [\"injmdl\"], \"getDefaultBuilder\": [\"container\"], \"getGlobalConfig\": [\"container\"], \"createDefaultContainer\": [], \"initRootContainer\": [\"container\"], \"registerExts\": [\"container\", \"config\"], \"bindAppConfig\": [\"config\"], \"getDefaultConfig\": [\"container\"] } };\n    return DefaultApplicationBuilder;\n}(modules.ModuleBuilder));\nexports.DefaultApplicationBuilder = DefaultApplicationBuilder;\n\n\n\n\n});\n\nunwrapExports(ApplicationBuilder);\nvar ApplicationBuilder_1 = ApplicationBuilder.ApplicationEvents;\nvar ApplicationBuilder_2 = ApplicationBuilder.DefaultApplicationBuilder;\n\nvar IApplicationBuilder = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nexports.ApplicationBuilderToken = new core_1.InjectToken('DI_AppBuilder');\n\n\n\n\n});\n\nunwrapExports(IApplicationBuilder);\nvar IApplicationBuilder_1 = IApplicationBuilder.ApplicationBuilderToken;\n\nvar boot = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(AppConfigure, exports);\ntslib_1.__exportStar(ApplicationBuilder, exports);\ntslib_1.__exportStar(IApplicationBuilder, exports);\n\n\n\n\n});\n\nunwrapExports(boot);\n\nvar D__workspace_github_tsioc_packages_bootstrap_lib = createCommonjsModule(function (module, exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\ntslib_1.__exportStar(decorators, exports);\ntslib_1.__exportStar(boot, exports);\ntslib_1.__exportStar(annotations, exports);\ntslib_1.__exportStar(modules, exports);\ntslib_1.__exportStar(runnable, exports);\ntslib_1.__exportStar(utils, exports);\ntslib_1.__exportStar(BootModule_1, exports);\n\n\n\n\n});\n\nvar index$6 = unwrapExports(D__workspace_github_tsioc_packages_bootstrap_lib);\n\nreturn index$6;\n\n})));\n\n//# sourceMappingURL=sourcemaps/bootstrap.umd.js.map\n\n//# sourceMappingURL=sourcemaps/bootstrap.umd.js.map\n"]}